2023-01-27 16:31:50,640 | DEBUG | Reading directory path
2023-01-27 16:31:50,953 | DEBUG | {'general_set_up': {'dataset_filename': '20230112_Dataset_W_Batch1.xlsx', 'input_dir_name': 'input', 'output_dir_name': 'output', 'dataset_dir_name': 'dataset', 'logs_dir_name': 'logs', 'models_dir_name': 'models'}, 'dataset': {'index_columns_dataset': 0, 'list_columns_names': ['id_document', 'id_annotation', 'start', 'span', 'role', 'trauma', 'court', 'Comments1', 'Comments2'], 'col_of_interest_binary_classif': 'trauma', 'col_of_interest_multi_label_classif': 'role', 'col_of_reference_binary_classif': 'span', 'col_of_reference_multi_label_classif': 'span'}, 'models': {'bert': ['bert-base-uncased', 'nlpaueb/legal-bert-base-uncased'], 'other': ['snowood1/ConfliBERT-scr-uncased', 'GroNLP/hateBERT']}, 'training_model': {'model_name': 'GroNLP/hateBERT', 'epochs': 3, 'batch_size': 8, 'embedding_size': 512, 'return_attention_mask': True, 'cross_validation': False, 'save_model': False, 'store_statistics': True, 'test_model': True, 'add_special_tokes': True, 'max_length': 512, 'pad_to_max_length': True, 'run_in_gpu': True, 'classification_task': 'binary'}, 'active_training': {'size_splits_dataset': 10, 'classification_task': 'binary'}}
2023-01-27 16:31:51,748 | DEBUG | Col of interest <<trauma>>
2023-01-27 16:31:51,749 | DEBUG | classes_dataset <<[0, 1]>>
2023-01-27 16:31:51,749 | DEBUG | Num of different classes in the dataset is 2 which are:
2023-01-27 16:31:51,750 | DEBUG | 	 1 - 0.0
2023-01-27 16:31:51,750 | DEBUG | 	 2 - 1.0
2023-01-27 16:31:52,346 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-01-27 16:31:52,347 | INFO | 	 1 - Tesla T4
2023-01-27 16:31:52,347 | DEBUG | 

==> Selected device is 'cuda' <==
2023-01-27 16:31:52,347 | DEBUG | Loading tokenizer... [ID:other];[Name:GroNLP/hateBERT]
2023-01-27 16:31:52,753 | INFO | other tokenizer was loaded successfully (GroNLP/hateBERT)
	do_lower_case=True
2023-01-27 16:31:53,304 | INFO | Max sentence length: 298 found at index 4683. Sentence is:


A. <There was a> committee of monks at the level of the province which <the chief> was in charge. I was in charge of the New People, their living conditions, their health; I was in charge of meetings and the kitchens. <So many people were sick. So, I prepared food for them. One person was> very hungry; <so he ate> so <much food> that <he> fainted. He did not die, but nearly died. We divided our roles. As regards the monks, what I can tell you is that they were <defrocked> but I do not know why. <But, my> idea at the time was that they should be kept, they shouldn't be <defrocked since they were already old> but <we should not allow more people to be ordained. I said that, but I did not dare to say it loud enough to be heard. I talked and walked the talk at the same time, but for fear, I did not dare to talk loudly. The state of life was like that.> I was at the pagoda. <I looked after it>. I <used the wooden boards to tightly close the> doors and the <walls> in order to protect the statue of the Buddha <from being taken away>. After the war <ended>, the statue was there. It was Ang Montreay (phonetic) pagoda in Kus <commune>.



2023-01-27 16:31:54,633 | INFO | 
CORPUS TRAINING AND VALIDATION: 
            
	 Length labels 4534
            
	 Length input_ids 4534
            
	 Length attention_masks 4534
            

2023-01-27 16:31:54,633 | INFO | 
	CORPUS TRAINING:  
            
		 Length labels 4080
            
		 Length input_ids 4080
            
		 Length attention_masks 4080
2023-01-27 16:31:54,633 | INFO | 
	CORPUS VALIDATION: 
            
		 Length labels 454
            
		 Length input_ids 454
            
		 Length attention_masks 454
2023-01-27 16:31:54,633 | INFO | 
2023-01-27 16:31:54,633 | INFO | 
CORPUS TEST: 
            
	 Length labels 239
            
	 Length input_ids 239
            
	 Length attention_masks 239
            

2023-01-27 16:31:58,119 | DEBUG | 
2023-01-27 16:31:58,119 | INFO | ======== Epoch 1 / 3 ========
2023-01-27 16:31:58,120 | INFO | Training...
2023-01-27 16:33:05,759 | DEBUG |   Batch   100  of    510.    Elapsed: 0:01:08.
2023-01-27 16:34:14,711 | DEBUG |   Batch   200  of    510.    Elapsed: 0:02:17.
2023-01-27 16:35:25,065 | DEBUG |   Batch   300  of    510.    Elapsed: 0:03:27.
2023-01-27 16:36:36,261 | DEBUG |   Batch   400  of    510.    Elapsed: 0:04:38.
2023-01-27 16:37:47,478 | DEBUG |   Batch   500  of    510.    Elapsed: 0:05:49.
2023-01-27 16:37:54,612 | INFO | Epoch 1 : 
            Train_acc : 0.9063967726374079
            Train_precision (macro, micro): [0.74679491 0.90639677]
            Train_recall  (macro, micro): [0.61254805 0.90639677]
            Train_F1 : [0.64105067 0.90639677]
2023-01-27 16:37:54,612 | DEBUG | 
2023-01-27 16:37:54,612 | INFO |   Average training loss: 0.22
2023-01-27 16:37:54,613 | INFO |   Training epoch took: 0:05:56
2023-01-27 16:37:54,619 | INFO | Classification report. TRAINING at epoch 1 
               precision    recall  f1-score   support

           0       0.94      0.98      0.96      3671
           1       0.73      0.44      0.55       409

    accuracy                           0.93      4080
   macro avg       0.84      0.71      0.75      4080
weighted avg       0.92      0.93      0.92      4080

2023-01-27 16:37:54,619 | DEBUG | 
2023-01-27 16:37:54,619 | INFO | Running Validation...
2023-01-27 16:38:08,487 | INFO | Epoch 1 : 
                Valid_acc : 0.9402346839584013
                Valid_precision (macro, micro): [0.80749157 0.94023468]
                Valid_recall (macro, micro): [0.81424129 0.94023468]
                Valid_F1 (macro, micro): [0.80381595 0.94023468]
2023-01-27 16:38:08,487 | INFO |   Accuracy: 0.95
2023-01-27 16:38:08,488 | INFO |   Validation Loss: 0.13
2023-01-27 16:38:08,488 | INFO |   Validation took: 0:00:14
2023-01-27 16:38:08,491 | INFO | Classification report. VALIDATION at epoch 1 
               precision    recall  f1-score   support

           0       0.97      0.98      0.97       409
           1       0.80      0.71      0.75        45

    accuracy                           0.95       454
   macro avg       0.88      0.85      0.86       454
weighted avg       0.95      0.95      0.95       454

2023-01-27 16:38:08,491 | DEBUG | 
2023-01-27 16:38:08,492 | INFO | ======== Epoch 2 / 3 ========
2023-01-27 16:38:08,492 | INFO | Training...
2023-01-27 16:39:19,552 | DEBUG |   Batch   100  of    510.    Elapsed: 0:01:11.
2023-01-27 16:40:30,734 | DEBUG |   Batch   200  of    510.    Elapsed: 0:02:22.
2023-01-27 16:41:41,870 | DEBUG |   Batch   300  of    510.    Elapsed: 0:03:33.
2023-01-27 16:42:52,891 | DEBUG |   Batch   400  of    510.    Elapsed: 0:04:44.
2023-01-27 16:44:04,149 | DEBUG |   Batch   500  of    510.    Elapsed: 0:05:56.
2023-01-27 16:44:11,284 | INFO | Epoch 2 : 
            Train_acc : 0.9733436372729485
            Train_precision (macro, micro): [0.93139018 0.97334364]
            Train_recall  (macro, micro): [0.91259409 0.97334364]
            Train_F1 : [0.92072013 0.97334364]
2023-01-27 16:44:11,285 | DEBUG | 
2023-01-27 16:44:11,285 | INFO |   Average training loss: 0.11
2023-01-27 16:44:11,285 | INFO |   Training epoch took: 0:06:03
2023-01-27 16:44:11,292 | INFO | Classification report. TRAINING at epoch 2 
               precision    recall  f1-score   support

           0       0.98      0.99      0.98      3671
           1       0.89      0.82      0.85       409

    accuracy                           0.97      4080
   macro avg       0.93      0.91      0.92      4080
weighted avg       0.97      0.97      0.97      4080

2023-01-27 16:44:11,292 | DEBUG | 
2023-01-27 16:44:11,292 | INFO | Running Validation...
2023-01-27 16:44:25,235 | INFO | Epoch 2 : 
                Valid_acc : 0.9734721195718721
                Valid_precision (macro, micro): [0.92325993 0.97347212]
                Valid_recall (macro, micro): [0.92642314 0.97347212]
                Valid_F1 (macro, micro): [0.92472618 0.97347212]
2023-01-27 16:44:25,236 | INFO |   Accuracy: 0.96
2023-01-27 16:44:25,236 | INFO |   Validation Loss: 0.17
2023-01-27 16:44:25,236 | INFO |   Validation took: 0:00:14
2023-01-27 16:44:25,239 | INFO | Classification report. VALIDATION at epoch 2 
               precision    recall  f1-score   support

           0       0.98      0.98      0.98       409
           1       0.78      0.80      0.79        45

    accuracy                           0.96       454
   macro avg       0.88      0.89      0.88       454
weighted avg       0.96      0.96      0.96       454

2023-01-27 16:44:25,240 | DEBUG | 
2023-01-27 16:44:25,240 | INFO | ======== Epoch 3 / 3 ========
2023-01-27 16:44:25,240 | INFO | Training...
2023-01-27 16:45:36,279 | DEBUG |   Batch   100  of    510.    Elapsed: 0:01:11.
2023-01-27 16:46:47,466 | DEBUG |   Batch   200  of    510.    Elapsed: 0:02:22.
2023-01-27 16:47:58,599 | DEBUG |   Batch   300  of    510.    Elapsed: 0:03:33.
2023-01-27 16:49:09,700 | DEBUG |   Batch   400  of    510.    Elapsed: 0:04:44.
2023-01-27 16:50:20,914 | DEBUG |   Batch   500  of    510.    Elapsed: 0:05:56.
2023-01-27 16:50:28,020 | INFO | Epoch 3 : 
            Train_acc : 0.9862486687778167
            Train_precision (macro, micro): [0.95832506 0.98624867]
            Train_recall  (macro, micro): [0.96802628 0.98624867]
            Train_F1 : [0.9630327  0.98624867]
2023-01-27 16:50:28,020 | DEBUG | 
2023-01-27 16:50:28,020 | INFO |   Average training loss: 0.06
2023-01-27 16:50:28,021 | INFO |   Training epoch took: 0:06:03
2023-01-27 16:50:28,027 | INFO | Classification report. TRAINING at epoch 3 
               precision    recall  f1-score   support

           0       0.99      0.99      0.99      3671
           1       0.93      0.92      0.92       409

    accuracy                           0.99      4080
   macro avg       0.96      0.96      0.96      4080
weighted avg       0.98      0.99      0.99      4080

2023-01-27 16:50:28,028 | DEBUG | 
2023-01-27 16:50:28,028 | INFO | Running Validation...
2023-01-27 16:50:41,921 | INFO | Epoch 3 : 
                Valid_acc : 0.9367528294178411
                Valid_precision (macro, micro): [0.84799475 0.93675283]
                Valid_recall (macro, micro): [0.79168373 0.93675283]
                Valid_F1 (macro, micro): [0.81517865 0.93675283]
2023-01-27 16:50:41,921 | INFO |   Accuracy: 0.94
2023-01-27 16:50:41,922 | INFO |   Validation Loss: 0.28
2023-01-27 16:50:41,922 | INFO |   Validation took: 0:00:14
2023-01-27 16:50:41,925 | INFO | Classification report. VALIDATION at epoch 3 
               precision    recall  f1-score   support

           0       0.96      0.98      0.97       409
           1       0.74      0.64      0.69        45

    accuracy                           0.94       454
   macro avg       0.85      0.81      0.83       454
weighted avg       0.94      0.94      0.94       454

2023-01-27 16:50:41,925 | DEBUG | 
2023-01-27 16:50:41,925 | INFO | Training complete!
2023-01-27 16:50:41,925 | INFO | Total training took 0:18:44 (h:mm:ss)
2023-01-27 16:50:41,935 | INFO | To execute testing of the model on test_data
2023-01-27 16:50:41,936 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-01-27 16:50:41,936 | INFO | 	 1 - Tesla T4
2023-01-27 16:50:41,936 | DEBUG | Running Testing...
2023-01-27 16:50:49,286 | INFO | 
        Valid_acc : 0.9274647090197418
        Valid_precision (macro, micro): [0.84320677 0.92746471]
        Valid_recall (macro, micro): [0.76453823 0.92746471]
        Valid_F1 (macro, micro): [0.79380623 0.92746471]
2023-01-27 16:50:49,287 | INFO |   Accuracy: 0.94
2023-01-27 16:50:49,287 | INFO |   Test Loss: 0.39
2023-01-27 16:50:49,287 | INFO |   Test took: 0:00:07
2023-01-27 16:50:49,290 | INFO | Classification report. TEST 
               precision    recall  f1-score   support

           0       0.95      0.99      0.97       215
           1       0.81      0.54      0.65        24

    accuracy                           0.94       239
   macro avg       0.88      0.76      0.81       239
weighted avg       0.94      0.94      0.94       239

2023-01-27 16:50:49,290 | INFO | From binary classification we present the following statistics: [{'epoch': 1, 'Training Loss': 0.21915960021125264, 'Training Accur.': 0.9063967726374079, 'Training Precision (macro)': 0.7467949057306082, 'Training Precision (micro)': 0.9063967726374079, 'Training Recall (macro)': 0.6125480535261005, 'Training Recall (micro)': 0.9063967726374079, 'Training F1 (macro)': 0.6410506677518344, 'Training F1 (micro)': 0.906396772637408, 'Valid. Loss': 0.12544773239948737, 'Valid. Accur.': 0.9539473684210527, 'Valid. Precision (macro)': 0.8074915701233851, 'Valid. Precision (micro)': 0.9402346839584013, 'Valid. Recall (macro)': 0.8142412929223167, 'Valid. Recall (micro)': 0.9402346839584013, 'Valid. F1 (macro)': 0.8038159462665789, 'Valid. F1 (micro)': 0.9402346839584013, 'Training Time': '0:05:56', 'Validation Time': '0:00:14'}, {'epoch': 2, 'Training Loss': 0.10864359321541783, 'Training Accur.': 0.9733436372729485, 'Training Precision (macro)': 0.9313901788095372, 'Training Precision (micro)': 0.9733436372729485, 'Training Recall (macro)': 0.9125940901765773, 'Training Recall (micro)': 0.9733436372729485, 'Training F1 (macro)': 0.9207201276708978, 'Training F1 (micro)': 0.9733436372729485, 'Valid. Loss': 0.16941480103087725, 'Valid. Accur.': 0.9576023391812866, 'Valid. Precision (macro)': 0.9232599340991781, 'Valid. Precision (micro)': 0.9734721195718721, 'Valid. Recall (macro)': 0.9264231433833006, 'Valid. Recall (micro)': 0.9734721195718721, 'Valid. F1 (macro)': 0.9247261758635505, 'Valid. F1 (micro)': 0.9734721195718721, 'Training Time': '0:06:03', 'Validation Time': '0:00:14'}, {'epoch': 3, 'Training Loss': 0.06329730957522235, 'Training Accur.': 0.9862486687778167, 'Training Precision (macro)': 0.9583250567703371, 'Training Precision (micro)': 0.9862486687778167, 'Training Recall (macro)': 0.9680262829472928, 'Training Recall (micro)': 0.9862486687778167, 'Training F1 (macro)': 0.9630326999646814, 'Training F1 (micro)': 0.9862486687778167, 'Valid. Loss': 0.2798885394657095, 'Valid. Accur.': 0.9429824561403509, 'Valid. Precision (macro)': 0.847994746653517, 'Valid. Precision (micro)': 0.9367528294178411, 'Valid. Recall (macro)': 0.7916837250879109, 'Valid. Recall (micro)': 0.9367528294178411, 'Valid. F1 (macro)': 0.8151786468271487, 'Valid. F1 (micro)': 0.9367528294178411, 'Training Time': '0:06:03', 'Validation Time': '0:00:14'}]
