2023-01-27 16:10:49,777 | DEBUG | Reading directory path
2023-01-27 16:10:50,116 | DEBUG | {'general_set_up': {'dataset_filename': '20230112_Dataset_W_Batch1.xlsx', 'input_dir_name': 'input', 'output_dir_name': 'output', 'dataset_dir_name': 'dataset', 'logs_dir_name': 'logs', 'models_dir_name': 'models'}, 'dataset': {'index_columns_dataset': 0, 'list_columns_names': ['id_document', 'id_annotation', 'start', 'span', 'role', 'trauma', 'court', 'Comments1', 'Comments2'], 'col_of_interest_binary_classif': 'trauma', 'col_of_interest_multi_label_classif': 'role', 'col_of_reference_binary_classif': 'span', 'col_of_reference_multi_label_classif': 'span'}, 'models': {'bert': ['bert-base-uncased', 'nlpaueb/legal-bert-base-uncased'], 'other': ['snowood1/ConfliBERT-scr-uncased', 'GroNLP/hateBERT']}, 'training_model': {'model_name': 'bert-base-uncased', 'epochs': 3, 'batch_size': 16, 'embedding_size': 512, 'return_attention_mask': True, 'cross_validation': False, 'save_model': False, 'store_statistics': True, 'test_model': True, 'add_special_tokes': True, 'max_length': 512, 'pad_to_max_length': True, 'run_in_gpu': True, 'classification_task': 'binary'}, 'active_training': {'size_splits_dataset': 10, 'classification_task': 'binary'}}
2023-01-27 16:10:50,887 | DEBUG | Col of interest <<trauma>>
2023-01-27 16:10:50,887 | DEBUG | classes_dataset <<[0, 1]>>
2023-01-27 16:10:50,888 | DEBUG | Num of different classes in the dataset is 2 which are:
2023-01-27 16:10:50,888 | DEBUG | 	 1 - 0.0
2023-01-27 16:10:50,888 | DEBUG | 	 2 - 1.0
2023-01-27 16:10:51,478 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-01-27 16:10:51,479 | INFO | 	 1 - Tesla T4
2023-01-27 16:10:51,479 | DEBUG | 

==> Selected device is 'cuda' <==
2023-01-27 16:10:51,479 | DEBUG | Loading tokenizer... [ID:bert];[Name:bert-base-uncased]
2023-01-27 16:10:51,870 | INFO | bert tokenizer was loaded successfully (bert-base-uncased)
	do_lower_case=True
2023-01-27 16:10:54,838 | INFO | Max sentence length: 298 found at index 4683. Sentence is:


A. <There was a> committee of monks at the level of the province which <the chief> was in charge. I was in charge of the New People, their living conditions, their health; I was in charge of meetings and the kitchens. <So many people were sick. So, I prepared food for them. One person was> very hungry; <so he ate> so <much food> that <he> fainted. He did not die, but nearly died. We divided our roles. As regards the monks, what I can tell you is that they were <defrocked> but I do not know why. <But, my> idea at the time was that they should be kept, they shouldn't be <defrocked since they were already old> but <we should not allow more people to be ordained. I said that, but I did not dare to say it loud enough to be heard. I talked and walked the talk at the same time, but for fear, I did not dare to talk loudly. The state of life was like that.> I was at the pagoda. <I looked after it>. I <used the wooden boards to tightly close the> doors and the <walls> in order to protect the statue of the Buddha <from being taken away>. After the war <ended>, the statue was there. It was Ang Montreay (phonetic) pagoda in Kus <commune>.



2023-01-27 16:10:58,507 | INFO | 
CORPUS TRAINING AND VALIDATION: 
            
	 Length labels 4534
            
	 Length input_ids 4534
            
	 Length attention_masks 4534
            

2023-01-27 16:10:58,508 | INFO | 
	CORPUS TRAINING:  
            
		 Length labels 4080
            
		 Length input_ids 4080
            
		 Length attention_masks 4080
2023-01-27 16:10:58,508 | INFO | 
	CORPUS VALIDATION: 
            
		 Length labels 454
            
		 Length input_ids 454
            
		 Length attention_masks 454
2023-01-27 16:10:58,508 | INFO | 
2023-01-27 16:10:58,508 | INFO | 
CORPUS TEST: 
            
	 Length labels 239
            
	 Length input_ids 239
            
	 Length attention_masks 239
            

2023-01-27 16:11:02,141 | DEBUG | 
2023-01-27 16:11:02,142 | INFO | ======== Epoch 1 / 3 ========
2023-01-27 16:11:02,142 | INFO | Training...
2023-01-27 16:13:14,360 | DEBUG |   Batch   100  of    255.    Elapsed: 0:02:12.
2023-01-27 16:15:31,732 | DEBUG |   Batch   200  of    255.    Elapsed: 0:04:30.
2023-01-27 16:16:47,911 | INFO | Epoch 1 : 
            Train_acc : 0.8968770627420262
            Train_precision (macro, micro): [0.71756119 0.89687706]
            Train_recall  (macro, micro): [0.60967143 0.89687706]
            Train_F1 : [0.63281979 0.89687706]
2023-01-27 16:16:47,911 | DEBUG | 
2023-01-27 16:16:47,911 | INFO |   Average training loss: 0.21
2023-01-27 16:16:47,911 | INFO |   Training epoch took: 0:05:46
2023-01-27 16:16:47,918 | INFO | Classification report. TRAINING at epoch 1 
               precision    recall  f1-score   support

           0       0.94      0.98      0.96      3671
           1       0.67      0.40      0.50       409

    accuracy                           0.92      4080
   macro avg       0.81      0.69      0.73      4080
weighted avg       0.91      0.92      0.91      4080

2023-01-27 16:16:47,918 | DEBUG | 
2023-01-27 16:16:47,918 | INFO | Running Validation...
2023-01-27 16:17:02,519 | INFO | Epoch 1 : 
                Valid_acc : 0.9347679073150024
                Valid_precision (macro, micro): [0.7773357  0.93476791]
                Valid_recall (macro, micro): [0.93666517 0.93476791]
                Valid_F1 (macro, micro): [0.82851753 0.93476791]
2023-01-27 16:17:02,519 | INFO |   Accuracy: 0.92
2023-01-27 16:17:02,519 | INFO |   Validation Loss: 0.17
2023-01-27 16:17:02,519 | INFO |   Validation took: 0:00:15
2023-01-27 16:17:02,523 | INFO | Classification report. VALIDATION at epoch 1 
               precision    recall  f1-score   support

           0       0.98      0.93      0.96       409
           1       0.58      0.84      0.68        45

    accuracy                           0.92       454
   macro avg       0.78      0.89      0.82       454
weighted avg       0.94      0.92      0.93       454

2023-01-27 16:17:02,523 | DEBUG | 
2023-01-27 16:17:02,524 | INFO | ======== Epoch 2 / 3 ========
2023-01-27 16:17:02,524 | INFO | Training...
2023-01-27 16:19:20,860 | DEBUG |   Batch   100  of    255.    Elapsed: 0:02:18.
2023-01-27 16:21:39,498 | DEBUG |   Batch   200  of    255.    Elapsed: 0:04:37.
2023-01-27 16:22:55,751 | INFO | Epoch 2 : 
            Train_acc : 0.9604135396685555
            Train_precision (macro, micro): [0.8903268  0.96041354]
            Train_recall  (macro, micro): [0.86915937 0.96041354]
            Train_F1 : [0.87897645 0.96041354]
2023-01-27 16:22:55,752 | DEBUG | 
2023-01-27 16:22:55,752 | INFO |   Average training loss: 0.11
2023-01-27 16:22:55,752 | INFO |   Training epoch took: 0:05:53
2023-01-27 16:22:55,759 | INFO | Classification report. TRAINING at epoch 2 
               precision    recall  f1-score   support

           0       0.98      0.98      0.98      3671
           1       0.82      0.78      0.80       409

    accuracy                           0.96      4080
   macro avg       0.90      0.88      0.89      4080
weighted avg       0.96      0.96      0.96      4080

2023-01-27 16:22:55,759 | DEBUG | 
2023-01-27 16:22:55,759 | INFO | Running Validation...
2023-01-27 16:23:10,264 | INFO | Epoch 2 : 
                Valid_acc : 0.9403388681179811
                Valid_precision (macro, micro): [0.8277067  0.94033887]
                Valid_recall (macro, micro): [0.79272352 0.94033887]
                Valid_F1 (macro, micro): [0.80839939 0.94033887]
2023-01-27 16:23:10,265 | INFO |   Accuracy: 0.94
2023-01-27 16:23:10,265 | INFO |   Validation Loss: 0.21
2023-01-27 16:23:10,265 | INFO |   Validation took: 0:00:15
2023-01-27 16:23:10,268 | INFO | Classification report. VALIDATION at epoch 2 
               precision    recall  f1-score   support

           0       0.96      0.98      0.97       409
           1       0.76      0.64      0.70        45

    accuracy                           0.94       454
   macro avg       0.86      0.81      0.83       454
weighted avg       0.94      0.94      0.94       454

2023-01-27 16:23:10,269 | DEBUG | 
2023-01-27 16:23:10,269 | INFO | ======== Epoch 3 / 3 ========
2023-01-27 16:23:10,269 | INFO | Training...
2023-01-27 16:25:28,704 | DEBUG |   Batch   100  of    255.    Elapsed: 0:02:18.
2023-01-27 16:27:47,328 | DEBUG |   Batch   200  of    255.    Elapsed: 0:04:37.
2023-01-27 16:29:03,576 | INFO | Epoch 3 : 
            Train_acc : 0.9854944558200701
            Train_precision (macro, micro): [0.95319739 0.98549446]
            Train_recall  (macro, micro): [0.96057176 0.98549446]
            Train_F1 : [0.95674171 0.98549446]
2023-01-27 16:29:03,576 | DEBUG | 
2023-01-27 16:29:03,577 | INFO |   Average training loss: 0.05
2023-01-27 16:29:03,577 | INFO |   Training epoch took: 0:05:53
2023-01-27 16:29:03,583 | INFO | Classification report. TRAINING at epoch 3 
               precision    recall  f1-score   support

           0       0.99      0.99      0.99      3671
           1       0.92      0.93      0.93       409

    accuracy                           0.99      4080
   macro avg       0.96      0.96      0.96      4080
weighted avg       0.99      0.99      0.99      4080

2023-01-27 16:29:03,584 | DEBUG | 
2023-01-27 16:29:03,584 | INFO | Running Validation...
2023-01-27 16:29:18,153 | INFO | Epoch 3 : 
                Valid_acc : 0.9295824630613094
                Valid_precision (macro, micro): [0.76473504 0.92958246]
                Valid_recall (macro, micro): [0.84298853 0.92958246]
                Valid_F1 (macro, micro): [0.79605754 0.92958246]
2023-01-27 16:29:18,154 | INFO |   Accuracy: 0.92
2023-01-27 16:29:18,154 | INFO |   Validation Loss: 0.27
2023-01-27 16:29:18,154 | INFO |   Validation took: 0:00:15
2023-01-27 16:29:18,157 | INFO | Classification report. VALIDATION at epoch 3 
               precision    recall  f1-score   support

           0       0.98      0.94      0.96       409
           1       0.59      0.80      0.68        45

    accuracy                           0.93       454
   macro avg       0.78      0.87      0.82       454
weighted avg       0.94      0.93      0.93       454

2023-01-27 16:29:18,158 | DEBUG | 
2023-01-27 16:29:18,158 | INFO | Training complete!
2023-01-27 16:29:18,158 | INFO | Total training took 0:18:16 (h:mm:ss)
2023-01-27 16:29:18,166 | INFO | To execute testing of the model on test_data
2023-01-27 16:29:18,166 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-01-27 16:29:18,167 | INFO | 	 1 - Tesla T4
2023-01-27 16:29:18,167 | DEBUG | Running Testing...
2023-01-27 16:29:25,811 | INFO | 
        Valid_acc : 0.9229972187660473
        Valid_precision (macro, micro): [0.73838346 0.92299722]
        Valid_recall (macro, micro): [0.89995646 0.92299722]
        Valid_F1 (macro, micro): [0.78490101 0.92299722]
2023-01-27 16:29:25,811 | INFO |   Accuracy: 0.93
2023-01-27 16:29:25,812 | INFO |   Test Loss: 0.24
2023-01-27 16:29:25,812 | INFO |   Test took: 0:00:08
2023-01-27 16:29:25,814 | INFO | Classification report. TEST 
               precision    recall  f1-score   support

           0       0.98      0.93      0.96       215
           1       0.59      0.83      0.69        24

    accuracy                           0.92       239
   macro avg       0.78      0.88      0.82       239
weighted avg       0.94      0.92      0.93       239

2023-01-27 16:29:25,815 | INFO | From binary classification we present the following statistics: [{'epoch': 1, 'Training Loss': 0.21389514953080638, 'Training Accur.': 0.8968770627420262, 'Training Precision (macro)': 0.7175611883661381, 'Training Precision (micro)': 0.8968770627420262, 'Training Recall (macro)': 0.6096714309262578, 'Training Recall (micro)': 0.8968770627420262, 'Training F1 (macro)': 0.6328197857666391, 'Training F1 (micro)': 0.8968770627420262, 'Valid. Loss': 0.1700560699762969, 'Valid. Accur.': 0.9209770114942528, 'Valid. Precision (macro)': 0.7773357048810164, 'Valid. Precision (micro)': 0.9347679073150024, 'Valid. Recall (macro)': 0.9366651734506012, 'Valid. Recall (micro)': 0.9347679073150024, 'Valid. F1 (macro)': 0.8285175321101479, 'Valid. F1 (micro)': 0.9347679073150024, 'Training Time': '0:05:46', 'Validation Time': '0:00:15'}, {'epoch': 2, 'Training Loss': 0.10851975964546642, 'Training Accur.': 0.9604135396685555, 'Training Precision (macro)': 0.8903268031894579, 'Training Precision (micro)': 0.9604135396685555, 'Training Recall (macro)': 0.869159366261007, 'Training Recall (micro)': 0.9604135396685555, 'Training F1 (macro)': 0.8789764470023924, 'Training F1 (micro)': 0.9604135396685555, 'Valid. Loss': 0.20928392243764266, 'Valid. Accur.': 0.9425287356321839, 'Valid. Precision (macro)': 0.8277066970646891, 'Valid. Precision (micro)': 0.9403388681179811, 'Valid. Recall (macro)': 0.792723522906242, 'Valid. Recall (micro)': 0.9403388681179811, 'Valid. F1 (macro)': 0.8083993937319082, 'Valid. F1 (micro)': 0.9403388681179811, 'Training Time': '0:05:53', 'Validation Time': '0:00:15'}, {'epoch': 3, 'Training Loss': 0.05335094580887908, 'Training Accur.': 0.9854944558200701, 'Training Precision (macro)': 0.9531973939905442, 'Training Precision (micro)': 0.9854944558200701, 'Training Recall (macro)': 0.9605717614133507, 'Training Recall (micro)': 0.9854944558200701, 'Training F1 (macro)': 0.9567417090855201, 'Training F1 (micro)': 0.9854944558200701, 'Valid. Loss': 0.2680603883285397, 'Valid. Accur.': 0.923132183908046, 'Valid. Precision (macro)': 0.7647350441475496, 'Valid. Precision (micro)': 0.9295824630613094, 'Valid. Recall (macro)': 0.8429885256450149, 'Valid. Recall (micro)': 0.9295824630613094, 'Valid. F1 (macro)': 0.7960575397465608, 'Valid. F1 (micro)': 0.9295824630613094, 'Training Time': '0:05:53', 'Validation Time': '0:00:15'}]
