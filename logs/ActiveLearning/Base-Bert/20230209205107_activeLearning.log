2023-02-09 20:51:07,952 | DEBUG | Reading directory path
2023-02-09 20:51:07,958 | DEBUG | {'general_set_up': {'dataset_filename': '20230207_Dataset_GTC_FINAL_Witnesses.xlsx', 'input_dir_name': 'input', 'output_dir_name': 'output', 'dataset_dir_name': 'dataset', 'logs_dir_name': 'logs', 'models_dir_name': 'models', 'plots_dir_name': 'plots'}, 'dataset': {'index_columns_dataset': 1, 'list_columns_names': ['tribunal', 'id_transcript', 'case', 'accused', 'date', 'text', 'trauma', 'role', 'witnesses', 'n_witnesses', 'start', 'id_annotation', 'id_document'], 'col_of_interest_binary_classif': 'trauma', 'col_of_interest_multi_label_classif': 'role', 'col_of_reference_binary_classif': 'text', 'col_of_reference_multi_label_classif': 'text'}, 'models': {'bert': ['bert-base-uncased', 'nlpaueb/legal-bert-base-uncased'], 'other': ['snowood1/ConfliBERT-scr-uncased', 'GroNLP/hateBERT']}, 'training_model': {'model_name': 'bert-base-uncased', 'epochs': 4, 'batch_size': 32, 'embedding_size': 512, 'return_attention_mask': True, 'cross_validation': False, 'save_model': True, 'store_statistics': True, 'test_model': True, 'add_special_tokes': True, 'max_length': 512, 'pad_to_max_length': True, 'run_in_gpu': True, 'classification_task': 'binary', 'learning_rate': '1e-6', 'epsilon_optimizer': '1e-8', 'weight_decay': 0}, 'active_training': {'size_splits_dataset': 8, 'classification_task': 'binary'}}
2023-02-09 20:51:13,050 | DEBUG | Col of interest trauma
2023-02-09 20:51:13,051 | DEBUG | classes_dataset [0, 1]
2023-02-09 20:51:13,128 | DEBUG | {'general_set_up': {'dataset_filename': '20230207_Dataset_GTC_FINAL_Witnesses.xlsx', 'input_dir_name': 'input', 'output_dir_name': 'output', 'dataset_dir_name': 'dataset', 'logs_dir_name': 'logs', 'models_dir_name': 'models', 'plots_dir_name': 'plots'}, 'dataset': {'index_columns_dataset': 1, 'list_columns_names': ['tribunal', 'id_transcript', 'case', 'accused', 'date', 'text', 'trauma', 'role', 'witnesses', 'n_witnesses', 'start', 'id_annotation', 'id_document'], 'col_of_interest_binary_classif': 'trauma', 'col_of_interest_multi_label_classif': 'role', 'col_of_reference_binary_classif': 'text', 'col_of_reference_multi_label_classif': 'text'}, 'models': {'bert': ['bert-base-uncased', 'nlpaueb/legal-bert-base-uncased'], 'other': ['snowood1/ConfliBERT-scr-uncased', 'GroNLP/hateBERT']}, 'training_model': {'model_name': 'bert-base-uncased', 'epochs': 4, 'batch_size': 32, 'embedding_size': 512, 'return_attention_mask': True, 'cross_validation': False, 'save_model': True, 'store_statistics': True, 'test_model': True, 'add_special_tokes': True, 'max_length': 512, 'pad_to_max_length': True, 'run_in_gpu': True, 'classification_task': 'binary', 'learning_rate': '1e-6', 'epsilon_optimizer': '1e-8', 'weight_decay': 0}, 'active_training': {'size_splits_dataset': 8, 'classification_task': 'binary'}}
2023-02-09 20:51:13,129 | DEBUG | Num of different classes in the dataset is 2 which are:
2023-02-09 20:51:13,129 | DEBUG | 	 1 - 0
2023-02-09 20:51:13,129 | DEBUG | 	 2 - 1
2023-02-09 20:51:13,130 | WARNING | 0    2067
1     321
Name: trauma, dtype: int64
2023-02-09 20:51:13,905 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-02-09 20:51:13,907 | INFO | 	 1 - NVIDIA A100-SXM4-40GB
2023-02-09 20:51:13,907 | DEBUG | 

==> Selected device is 'cuda' <==
2023-02-09 20:51:13,907 | DEBUG | Loading tokenizer... [ID:bert];[Name:bert-base-uncased]
2023-02-09 20:51:14,100 | INFO | bert tokenizer was loaded successfully (bert-base-uncased)
	do_lower_case=True
2023-02-09 20:51:15,599 | INFO | Max sentence length: 345 found at index 1891. Sentence is:


A.   Perica Markovic and all these other names and surnames gravitate towards Visegrad territory, Andric Vidoje, Tasic Zeljko was my colleague, was never a policeman.  The next one was liquidated a year ago perhaps.  He was killed after testifying in .  Spasoje Vidakovic, active-duty policeman, he used to be in working as an active-duty policeman, and he had not come to the police station when I was there.  I checked his records when he went to the police academy.  Novica Savic, the Savic family is dispersed.  They live in two or three different places.  I can't recognise that.  Mladen Andric, I don't know.  Nedeljko Gogic, I don't know him personally. Joksimovic, I can't make out the first name, Timotije.  I know Joksimovic Timotije was in Kragujevac.  I know only one Joksimovic.  I'm not sure about the first name.  Mirko Lakic, I've explained already.  Goran Zecevic was never on the police force during my time.  He was working in .  Sladjan Simic, I know there was one Simic in Koritnik, but whether this is the same person, I'm not sure.  Miodrag Bozic, the Bozics live in one part of Visegrad in the Lijesak [phoen] and some others live in the Visegrad-Zupa.  Mile Lakic, I've already explained.  Anything else you want to know?



2023-02-09 20:51:17,542 | INFO | 
CORPUS TRAINING AND VALIDATION: 
            
	 Length labels 2268
            
	 Length input_ids 2268
            
	 Length attention_masks 2268
            

2023-02-09 20:51:17,543 | INFO | 
	CORPUS TRAINING:  
            
		 Length labels 2041
            
		 Length input_ids 2041
            
		 Length attention_masks 2041
2023-02-09 20:51:17,543 | INFO | 
	CORPUS VALIDATION: 
            
		 Length labels 227
            
		 Length input_ids 227
            
		 Length attention_masks 227
2023-02-09 20:51:17,543 | INFO | 
2023-02-09 20:51:17,543 | INFO | 
CORPUS TEST: 
            
	 Length labels 120
            
	 Length input_ids 120
            
	 Length attention_masks 120
            

2023-02-09 20:51:21,448 | DEBUG | Optimizer
2023-02-09 20:51:21,449 | DEBUG | AdamW (
Parameter Group 0
    betas: (0.9, 0.999)
    correct_bias: True
    eps: 1e-08
    lr: 1e-06
    weight_decay: 0.0
)
2023-02-09 20:51:21,450 | DEBUG | 
2023-02-09 20:51:21,450 | INFO | ======== Epoch 1 / 4 ========
2023-02-09 20:51:21,450 | INFO | Training...
2023-02-09 20:52:07,533 | INFO | Epoch 1 : 
            Train_acc : 0.8392569375204724
            Train_precision (macro, micro): [0.57200099 0.83925694]
            Train_recall  (macro, micro): [0.53932118 0.83925694]
            Train_F1 : [0.53928234 0.83925694]
2023-02-09 20:52:07,534 | DEBUG | 
2023-02-09 20:52:07,534 | INFO |   Average training loss: 0.51
2023-02-09 20:52:07,535 | INFO |   Training epoch took: 0:00:46
2023-02-09 20:52:07,540 | INFO | Classification report. TRAINING at epoch 1 
               precision    recall  f1-score   support

           0       0.87      0.98      0.92      1767
           1       0.27      0.05      0.09       274

    accuracy                           0.85      2041
   macro avg       0.57      0.52      0.51      2041
weighted avg       0.79      0.85      0.81      2041

2023-02-09 20:52:07,540 | DEBUG | 
2023-02-09 20:52:07,541 | INFO | Running Validation...
2023-02-09 20:52:09,119 | INFO | Epoch 1 : 
                Valid_acc : 0.8524514648232642
                Valid_precision (macro, micro): [0.42622573 0.85245146]
                Valid_recall (macro, micro): [0.5        0.85245146]
                Valid_F1 (macro, micro): [0.46012269 0.85245146]
2023-02-09 20:52:09,120 | INFO |   Accuracy: 0.84
2023-02-09 20:52:09,120 | INFO |   Validation Loss: 0.43
2023-02-09 20:52:09,120 | INFO |   Validation took: 0:00:02
2023-02-09 20:52:09,123 | INFO | Classification report. VALIDATION at epoch 1 
               precision    recall  f1-score   support

           0       0.86      1.00      0.93       196
           1       0.00      0.00      0.00        31

    accuracy                           0.86       227
   macro avg       0.43      0.50      0.46       227
weighted avg       0.75      0.86      0.80       227

2023-02-09 20:52:09,124 | DEBUG | 
2023-02-09 20:52:09,124 | INFO | ======== Epoch 2 / 4 ========
2023-02-09 20:52:09,124 | INFO | Training...
2023-02-09 20:52:54,091 | INFO | Epoch 2 : 
            Train_acc : 0.8673149133548451
            Train_precision (macro, micro): [0.43365746 0.86731491]
            Train_recall  (macro, micro): [0.5        0.86731491]
            Train_F1 : [0.46444825 0.86731491]
2023-02-09 20:52:54,091 | DEBUG | 
2023-02-09 20:52:54,092 | INFO |   Average training loss: 0.42
2023-02-09 20:52:54,092 | INFO |   Training epoch took: 0:00:45
2023-02-09 20:52:54,097 | INFO | Classification report. TRAINING at epoch 2 
               precision    recall  f1-score   support

           0       0.87      1.00      0.93      1767
           1       0.00      0.00      0.00       274

    accuracy                           0.87      2041
   macro avg       0.43      0.50      0.46      2041
weighted avg       0.75      0.87      0.80      2041

2023-02-09 20:52:54,097 | DEBUG | 
2023-02-09 20:52:54,098 | INFO | Running Validation...
2023-02-09 20:52:55,677 | INFO | Epoch 2 : 
                Valid_acc : 0.8758238606565976
                Valid_precision (macro, micro): [0.43791193 0.87582386]
                Valid_recall (macro, micro): [0.5        0.87582386]
                Valid_F1 (macro, micro): [0.46686666 0.87582386]
2023-02-09 20:52:55,677 | INFO |   Accuracy: 0.84
2023-02-09 20:52:55,678 | INFO |   Validation Loss: 0.35
2023-02-09 20:52:55,678 | INFO |   Validation took: 0:00:02
2023-02-09 20:52:55,681 | INFO | Classification report. VALIDATION at epoch 2 
               precision    recall  f1-score   support

           0       0.86      1.00      0.93       196
           1       0.00      0.00      0.00        31

    accuracy                           0.86       227
   macro avg       0.43      0.50      0.46       227
weighted avg       0.75      0.86      0.80       227

2023-02-09 20:52:55,681 | DEBUG | 
2023-02-09 20:52:55,681 | INFO | ======== Epoch 3 / 4 ========
2023-02-09 20:52:55,682 | INFO | Training...
2023-02-09 20:53:40,610 | INFO | Epoch 3 : 
            Train_acc : 0.8819200986048602
            Train_precision (macro, micro): [0.8648017 0.8819201]
            Train_recall  (macro, micro): [0.56537494 0.8819201 ]
            Train_F1 : [0.57786778 0.8819201 ]
2023-02-09 20:53:40,611 | DEBUG | 
2023-02-09 20:53:40,611 | INFO |   Average training loss: 0.36
2023-02-09 20:53:40,611 | INFO |   Training epoch took: 0:00:45
2023-02-09 20:53:40,617 | INFO | Classification report. TRAINING at epoch 3 
               precision    recall  f1-score   support

           0       0.90      0.99      0.94      1767
           1       0.79      0.28      0.42       274

    accuracy                           0.89      2041
   macro avg       0.84      0.64      0.68      2041
weighted avg       0.88      0.89      0.87      2041

2023-02-09 20:53:40,617 | DEBUG | 
2023-02-09 20:53:40,617 | INFO | Running Validation...
2023-02-09 20:53:42,197 | INFO | Epoch 3 : 
                Valid_acc : 0.878761250852213
                Valid_precision (macro, micro): [0.75949365 0.87876125]
                Valid_recall (macro, micro): [0.65725593 0.87876125]
                Valid_F1 (macro, micro): [0.68762222 0.87876125]
2023-02-09 20:53:42,197 | INFO |   Accuracy: 0.86
2023-02-09 20:53:42,198 | INFO |   Validation Loss: 0.33
2023-02-09 20:53:42,198 | INFO |   Validation took: 0:00:02
2023-02-09 20:53:42,201 | INFO | Classification report. VALIDATION at epoch 3 
               precision    recall  f1-score   support

           0       0.90      0.96      0.93       196
           1       0.61      0.35      0.45        31

    accuracy                           0.88       227
   macro avg       0.76      0.66      0.69       227
weighted avg       0.86      0.88      0.87       227

2023-02-09 20:53:42,201 | DEBUG | 
2023-02-09 20:53:42,202 | INFO | ======== Epoch 4 / 4 ========
2023-02-09 20:53:42,202 | INFO | Training...
2023-02-09 20:54:27,158 | INFO | Epoch 4 : 
            Train_acc : 0.926657138589215
            Train_precision (macro, micro): [0.89474727 0.92665714]
            Train_recall  (macro, micro): [0.73519554 0.92665714]
            Train_F1 : [0.78568966 0.92665714]
2023-02-09 20:54:27,159 | DEBUG | 
2023-02-09 20:54:27,159 | INFO |   Average training loss: 0.31
2023-02-09 20:54:27,159 | INFO |   Training epoch took: 0:00:45
2023-02-09 20:54:27,165 | INFO | Classification report. TRAINING at epoch 4 
               precision    recall  f1-score   support

           0       0.94      0.98      0.96      1767
           1       0.84      0.58      0.68       274

    accuracy                           0.93      2041
   macro avg       0.89      0.78      0.82      2041
weighted avg       0.92      0.93      0.92      2041

2023-02-09 20:54:27,165 | DEBUG | 
2023-02-09 20:54:27,165 | INFO | Running Validation...
2023-02-09 20:54:28,744 | INFO | Epoch 4 : 
                Valid_acc : 0.8811271256162156
                Valid_precision (macro, micro): [0.74076556 0.88112713]
                Valid_recall (macro, micro): [0.81971681 0.88112713]
                Valid_F1 (macro, micro): [0.76984966 0.88112713]
2023-02-09 20:54:28,745 | INFO |   Accuracy: 0.88
2023-02-09 20:54:28,745 | INFO |   Validation Loss: 0.28
2023-02-09 20:54:28,745 | INFO |   Validation took: 0:00:02
2023-02-09 20:54:28,748 | INFO | Classification report. VALIDATION at epoch 4 
               precision    recall  f1-score   support

           0       0.95      0.89      0.92       196
           1       0.51      0.71      0.59        31

    accuracy                           0.87       227
   macro avg       0.73      0.80      0.76       227
weighted avg       0.89      0.87      0.88       227

2023-02-09 20:54:28,749 | DEBUG | 
2023-02-09 20:54:28,749 | INFO | Training complete!
2023-02-09 20:54:28,749 | INFO | Total training took 0:03:07 (h:mm:ss)
2023-02-09 20:54:28,758 | DEBUG | ====================================================================================================
2023-02-09 20:54:28,758 | DEBUG | ********************************************************************************
2023-02-09 20:54:28,758 | DEBUG | Iteration: 1/8
2023-02-09 20:54:28,758 | INFO | [{'epoch': 1, 'Training Loss': 0.5102967349812388, 'Training Accur.': 0.8392569375204724, 'Training Precision (macro)': 0.5720009886329922, 'Training Precision (micro)': 0.8392569375204724, 'Training Recall (macro)': 0.5393211818984476, 'Training Recall (micro)': 0.8392569375204724, 'Training F1 (macro)': 0.5392823419175791, 'Training F1 (micro)': 0.8392569375204724, 'Valid. Loss': 0.43012048304080963, 'Valid. Accur.': 0.8411458333333334, 'Valid. Precision (macro)': 0.4262257324116321, 'Valid. Precision (micro)': 0.8524514648232642, 'Valid. Recall (macro)': 0.5, 'Valid. Recall (micro)': 0.8524514648232642, 'Valid. F1 (macro)': 0.4601226899177798, 'Valid. F1 (micro)': 0.8524514648232642, 'Training Time': '0:00:46', 'Validation Time': '0:00:02'}, {'epoch': 2, 'Training Loss': 0.4218094367533922, 'Training Accur.': 0.8673149133548451, 'Training Precision (macro)': 0.43365745667742256, 'Training Precision (micro)': 0.8673149133548451, 'Training Recall (macro)': 0.5, 'Training Recall (micro)': 0.8673149133548451, 'Training F1 (macro)': 0.4644482475294517, 'Training F1 (micro)': 0.8673149133548451, 'Valid. Loss': 0.3488333821296692, 'Valid. Accur.': 0.8411458333333334, 'Valid. Precision (macro)': 0.4379119303282988, 'Valid. Precision (micro)': 0.8758238606565976, 'Valid. Recall (macro)': 0.5, 'Valid. Recall (micro)': 0.8758238606565976, 'Valid. F1 (macro)': 0.4668666565527795, 'Valid. F1 (micro)': 0.8758238606565973, 'Training Time': '0:00:45', 'Validation Time': '0:00:02'}, {'epoch': 3, 'Training Loss': 0.3605360209476203, 'Training Accur.': 0.8819200986048602, 'Training Precision (macro)': 0.8648017030617027, 'Training Precision (micro)': 0.8819200986048602, 'Training Recall (macro)': 0.5653749380527758, 'Training Recall (micro)': 0.8819200986048602, 'Training F1 (macro)': 0.5778677804448643, 'Training F1 (micro)': 0.8819200986048602, 'Valid. Loss': 0.3342968784272671, 'Valid. Accur.': 0.8567708333333334, 'Valid. Precision (macro)': 0.7594936498250305, 'Valid. Precision (micro)': 0.878761250852213, 'Valid. Recall (macro)': 0.6572559341244919, 'Valid. Recall (micro)': 0.878761250852213, 'Valid. F1 (macro)': 0.6876222199585993, 'Valid. F1 (micro)': 0.878761250852213, 'Training Time': '0:00:45', 'Validation Time': '0:00:02'}, {'epoch': 4, 'Training Loss': 0.31391313252970576, 'Training Accur.': 0.926657138589215, 'Training Precision (macro)': 0.8947472687959431, 'Training Precision (micro)': 0.926657138589215, 'Training Recall (macro)': 0.7351955441840297, 'Training Recall (micro)': 0.926657138589215, 'Training F1 (macro)': 0.7856896633408301, 'Training F1 (micro)': 0.926657138589215, 'Valid. Loss': 0.2779522445052862, 'Valid. Accur.': 0.8828125, 'Valid. Precision (macro)': 0.7407655629187366, 'Valid. Precision (micro)': 0.8811271256162156, 'Valid. Recall (macro)': 0.8197168116844571, 'Valid. Recall (micro)': 0.8811271256162156, 'Valid. F1 (macro)': 0.7698496557021733, 'Valid. F1 (micro)': 0.8811271256162156, 'Training Time': '0:00:45', 'Validation Time': '0:00:02'}]
2023-02-09 20:54:28,759 | DEBUG | ********************************************************************************
2023-02-09 20:54:28,759 | DEBUG | ====================================================================================================
2023-02-09 20:54:28,759 | INFO | To execute testing of the model on test_data
2023-02-09 20:54:28,759 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-02-09 20:54:28,760 | INFO | 	 1 - NVIDIA A100-SXM4-40GB
2023-02-09 20:54:28,760 | DEBUG | Running Testing...
2023-02-09 20:54:29,588 | INFO | 
        Test_acc : 0.8635416666666667
        Test_precision (macro, micro): [0.73257472 0.86354167]
        Test_recall (macro, micro): [0.8062252  0.86354167]
        Test_F1 (macro, micro): [0.75941215 0.86354167]
2023-02-09 20:54:29,589 | INFO |   Accuracy: 0.85
2023-02-09 20:54:29,589 | INFO |   Test Loss: 0.28
2023-02-09 20:54:29,589 | INFO |   Test took: 0:00:01
2023-02-09 20:54:29,592 | INFO | Classification report. TEST 
               precision    recall  f1-score   support

           0       0.95      0.88      0.91       104
           1       0.46      0.69      0.55        16

    accuracy                           0.85       120
   macro avg       0.70      0.78      0.73       120
weighted avg       0.88      0.85      0.86       120

2023-02-09 20:54:29,601 | DEBUG | {'general_set_up': {'dataset_filename': '20230207_Dataset_GTC_FINAL_Witnesses.xlsx', 'input_dir_name': 'input', 'output_dir_name': 'output', 'dataset_dir_name': 'dataset', 'logs_dir_name': 'logs', 'models_dir_name': 'models', 'plots_dir_name': 'plots'}, 'dataset': {'index_columns_dataset': 1, 'list_columns_names': ['tribunal', 'id_transcript', 'case', 'accused', 'date', 'text', 'trauma', 'role', 'witnesses', 'n_witnesses', 'start', 'id_annotation', 'id_document'], 'col_of_interest_binary_classif': 'trauma', 'col_of_interest_multi_label_classif': 'role', 'col_of_reference_binary_classif': 'text', 'col_of_reference_multi_label_classif': 'text'}, 'models': {'bert': ['bert-base-uncased', 'nlpaueb/legal-bert-base-uncased'], 'other': ['snowood1/ConfliBERT-scr-uncased', 'GroNLP/hateBERT']}, 'training_model': {'model_name': 'bert-base-uncased', 'epochs': 4, 'batch_size': 32, 'embedding_size': 512, 'return_attention_mask': True, 'cross_validation': False, 'save_model': True, 'store_statistics': True, 'test_model': True, 'add_special_tokes': True, 'max_length': 512, 'pad_to_max_length': True, 'run_in_gpu': True, 'classification_task': 'binary', 'learning_rate': '1e-6', 'epsilon_optimizer': '1e-8', 'weight_decay': 0}, 'active_training': {'size_splits_dataset': 8, 'classification_task': 'binary'}}
2023-02-09 20:54:29,602 | DEBUG | Num of different classes in the dataset is 2 which are:
2023-02-09 20:54:29,602 | DEBUG | 	 1 - 0
2023-02-09 20:54:29,602 | DEBUG | 	 2 - 1
2023-02-09 20:54:29,603 | WARNING | 0    4134
1     642
Name: trauma, dtype: int64
2023-02-09 20:54:29,604 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-02-09 20:54:29,604 | INFO | 	 1 - NVIDIA A100-SXM4-40GB
2023-02-09 20:54:29,604 | DEBUG | 

==> Selected device is 'cuda' <==
2023-02-09 20:54:29,604 | DEBUG | Loading tokenizer... [ID:bert];[Name:bert-base-uncased]
2023-02-09 20:54:29,791 | INFO | bert tokenizer was loaded successfully (bert-base-uncased)
	do_lower_case=True
2023-02-09 20:54:32,963 | INFO | Max sentence length: 347 found at index 3164. Sentence is:


A.   It wasn't a short -- it was a short journey, two and a half kilometres approximately.  We climbed a hill.  We heard bursts of gunfire. When we reached the place where there was gunfire, the buses stopped and as soon as they stopped, the doors would open.  Serbian soldiers gathered round the buses.  Said -- and they were cursing our mothers and us, and Haris Silajdzic's mother as well.  They said, "They don't want you.  Get out of the bus."  And then death -- you could see death in their eyes. Until that point, you feel you never knew what was going, because they would say one thing, do another, and they started -- people started emerging from the buses and after the buses were half empty, they would stop people from disembarking. I was still on the bus and was looking at what was going on.  They took the people down a path in the field, there are dead people, bursts of gunfire would cut people down.  People fell dead to the ground.  When this was finished, they would come back.  I emerged from the bus.  There were cursing, "Fuck your mother and Alija and Haris."  "They don't want you."  "Get out of the bus." "Come here."  And you reckon there are still a couple of seconds of life left.  When everybody disembarked from the buses with their hands tied, including me, we formed a column and there were dead people in the column, there were dead people on the path, you could see them lying on the ground.  They didn't even reach the execution site.



2023-02-09 20:54:37,037 | INFO | 
CORPUS TRAINING AND VALIDATION: 
            
	 Length labels 4537
            
	 Length input_ids 4537
            
	 Length attention_masks 4537
            

2023-02-09 20:54:37,038 | INFO | 
	CORPUS TRAINING:  
            
		 Length labels 4083
            
		 Length input_ids 4083
            
		 Length attention_masks 4083
2023-02-09 20:54:37,038 | INFO | 
	CORPUS VALIDATION: 
            
		 Length labels 454
            
		 Length input_ids 454
            
		 Length attention_masks 454
2023-02-09 20:54:37,038 | INFO | 
2023-02-09 20:54:37,038 | INFO | 
CORPUS TEST: 
            
	 Length labels 239
            
	 Length input_ids 239
            
	 Length attention_masks 239
            

2023-02-09 20:54:38,676 | DEBUG | Optimizer
2023-02-09 20:54:38,676 | DEBUG | AdamW (
Parameter Group 0
    betas: (0.9, 0.999)
    correct_bias: True
    eps: 1e-08
    lr: 1e-06
    weight_decay: 0.0
)
2023-02-09 20:54:38,677 | DEBUG | 
2023-02-09 20:54:38,677 | INFO | ======== Epoch 1 / 4 ========
2023-02-09 20:54:38,677 | INFO | Training...
2023-02-09 20:55:49,423 | DEBUG |   Batch   100  of    128.    Elapsed: 0:01:11.
2023-02-09 20:56:09,175 | INFO | Epoch 1 : 
            Train_acc : 0.8592635568474261
            Train_precision (macro, micro): [0.55249877 0.85926356]
            Train_recall  (macro, micro): [0.50619245 0.85926356]
            Train_F1 : [0.47807994 0.85926356]
2023-02-09 20:56:09,176 | DEBUG | 
2023-02-09 20:56:09,176 | INFO |   Average training loss: 0.47
2023-02-09 20:56:09,176 | INFO |   Training epoch took: 0:01:30
2023-02-09 20:56:09,183 | INFO | Classification report. TRAINING at epoch 1 
               precision    recall  f1-score   support

           0       0.87      1.00      0.93      3534
           1       0.27      0.01      0.01       549

    accuracy                           0.86      4083
   macro avg       0.57      0.50      0.47      4083
weighted avg       0.79      0.86      0.80      4083

2023-02-09 20:56:09,184 | DEBUG | 
2023-02-09 20:56:09,184 | INFO | Running Validation...
2023-02-09 20:56:12,337 | INFO | Epoch 1 : 
                Valid_acc : 0.877321533907437
                Valid_precision (macro, micro): [0.63323074 0.87732153]
                Valid_recall (macro, micro): [0.51478747 0.87732153]
                Valid_F1 (macro, micro): [0.49672653 0.87732153]
2023-02-09 20:56:12,337 | INFO |   Accuracy: 0.88
2023-02-09 20:56:12,338 | INFO |   Validation Loss: 0.32
2023-02-09 20:56:12,338 | INFO |   Validation took: 0:00:03
2023-02-09 20:56:12,341 | INFO | Classification report. VALIDATION at epoch 1 
               precision    recall  f1-score   support

           0       0.87      1.00      0.93       393
           1       0.80      0.07      0.12        61

    accuracy                           0.87       454
   macro avg       0.84      0.53      0.53       454
weighted avg       0.86      0.87      0.82       454

2023-02-09 20:56:12,342 | DEBUG | 
2023-02-09 20:56:12,342 | INFO | ======== Epoch 2 / 4 ========
2023-02-09 20:56:12,342 | INFO | Training...
2023-02-09 20:57:23,005 | DEBUG |   Batch   100  of    128.    Elapsed: 0:01:11.
2023-02-09 20:57:42,768 | INFO | Epoch 2 : 
            Train_acc : 0.8833982180741696
            Train_precision (macro, micro): [0.8065291  0.88339822]
            Train_recall  (macro, micro): [0.6058795  0.88339822]
            Train_F1 : [0.63838553 0.88339822]
2023-02-09 20:57:42,769 | DEBUG | 
2023-02-09 20:57:42,769 | INFO |   Average training loss: 0.37
2023-02-09 20:57:42,769 | INFO |   Training epoch took: 0:01:30
2023-02-09 20:57:42,777 | INFO | Classification report. TRAINING at epoch 2 
               precision    recall  f1-score   support

           0       0.90      0.98      0.94      3534
           1       0.73      0.28      0.41       549

    accuracy                           0.89      4083
   macro avg       0.81      0.63      0.67      4083
weighted avg       0.88      0.89      0.87      4083

2023-02-09 20:57:42,778 | DEBUG | 
2023-02-09 20:57:42,778 | INFO | Running Validation...
2023-02-09 20:57:45,928 | INFO | Epoch 2 : 
                Valid_acc : 0.9444248092114281
                Valid_precision (macro, micro): [0.93951159 0.94442481]
                Valid_recall (macro, micro): [0.79088776 0.94442481]
                Valid_F1 (macro, micro): [0.84287063 0.94442481]
2023-02-09 20:57:45,929 | INFO |   Accuracy: 0.92
2023-02-09 20:57:45,929 | INFO |   Validation Loss: 0.21
2023-02-09 20:57:45,929 | INFO |   Validation took: 0:00:03
2023-02-09 20:57:45,933 | INFO | Classification report. VALIDATION at epoch 2 
               precision    recall  f1-score   support

           0       0.93      0.99      0.96       393
           1       0.91      0.52      0.67        61

    accuracy                           0.93       454
   macro avg       0.92      0.76      0.81       454
weighted avg       0.93      0.93      0.92       454

2023-02-09 20:57:45,934 | DEBUG | 
2023-02-09 20:57:45,934 | INFO | ======== Epoch 3 / 4 ========
2023-02-09 20:57:45,934 | INFO | Training...
2023-02-09 20:58:56,624 | DEBUG |   Batch   100  of    128.    Elapsed: 0:01:11.
2023-02-09 20:59:16,400 | INFO | Epoch 3 : 
            Train_acc : 0.9245204935436567
            Train_precision (macro, micro): [0.86575153 0.92452049]
            Train_recall  (macro, micro): [0.80996003 0.92452049]
            Train_F1 : [0.83371037 0.92452049]
2023-02-09 20:59:16,400 | DEBUG | 
2023-02-09 20:59:16,400 | INFO |   Average training loss: 0.31
2023-02-09 20:59:16,401 | INFO |   Training epoch took: 0:01:30
2023-02-09 20:59:16,409 | INFO | Classification report. TRAINING at epoch 3 
               precision    recall  f1-score   support

           0       0.95      0.97      0.96      3534
           1       0.77      0.66      0.71       549

    accuracy                           0.93      4083
   macro avg       0.86      0.82      0.84      4083
weighted avg       0.92      0.93      0.93      4083

2023-02-09 20:59:16,409 | DEBUG | 
2023-02-09 20:59:16,409 | INFO | Running Validation...
2023-02-09 20:59:19,564 | INFO | Epoch 3 : 
                Valid_acc : 0.9413419243099861
                Valid_precision (macro, micro): [0.87019868 0.94134192]
                Valid_recall (macro, micro): [0.86791845 0.94134192]
                Valid_F1 (macro, micro): [0.86794908 0.94134192]
2023-02-09 20:59:19,564 | INFO |   Accuracy: 0.95
2023-02-09 20:59:19,564 | INFO |   Validation Loss: 0.17
2023-02-09 20:59:19,565 | INFO |   Validation took: 0:00:03
2023-02-09 20:59:19,568 | INFO | Classification report. VALIDATION at epoch 3 
               precision    recall  f1-score   support

           0       0.97      0.97      0.97       393
           1       0.80      0.79      0.79        61

    accuracy                           0.94       454
   macro avg       0.88      0.88      0.88       454
weighted avg       0.94      0.94      0.94       454

2023-02-09 20:59:19,569 | DEBUG | 
2023-02-09 20:59:19,569 | INFO | ======== Epoch 4 / 4 ========
2023-02-09 20:59:19,569 | INFO | Training...
2023-02-09 21:00:30,262 | DEBUG |   Batch   100  of    128.    Elapsed: 0:01:11.
2023-02-09 21:00:50,043 | INFO | Epoch 4 : 
            Train_acc : 0.9498093632169846
            Train_precision (macro, micro): [0.89927163 0.94980936]
            Train_recall  (macro, micro): [0.87976468 0.94980936]
            Train_F1 : [0.8883349  0.94980936]
2023-02-09 21:00:50,043 | DEBUG | 
2023-02-09 21:00:50,044 | INFO |   Average training loss: 0.29
2023-02-09 21:00:50,044 | INFO |   Training epoch took: 0:01:30
2023-02-09 21:00:50,052 | INFO | Classification report. TRAINING at epoch 4 
               precision    recall  f1-score   support

           0       0.97      0.97      0.97      3534
           1       0.81      0.79      0.80       549

    accuracy                           0.95      4083
   macro avg       0.89      0.88      0.88      4083
weighted avg       0.95      0.95      0.95      4083

2023-02-09 21:00:50,052 | DEBUG | 
2023-02-09 21:00:50,052 | INFO | Running Validation...
2023-02-09 21:00:53,206 | INFO | Epoch 4 : 
                Valid_acc : 0.9386911001840791
                Valid_precision (macro, micro): [0.89172821 0.9386911 ]
                Valid_recall (macro, micro): [0.83733321 0.9386911 ]
                Valid_F1 (macro, micro): [0.85935058 0.9386911 ]
2023-02-09 21:00:53,206 | INFO |   Accuracy: 0.93
2023-02-09 21:00:53,206 | INFO |   Validation Loss: 0.19
2023-02-09 21:00:53,206 | INFO |   Validation took: 0:00:03
2023-02-09 21:00:53,210 | INFO | Classification report. VALIDATION at epoch 4 
               precision    recall  f1-score   support

           0       0.95      0.98      0.96       393
           1       0.85      0.66      0.74        61

    accuracy                           0.94       454
   macro avg       0.90      0.82      0.85       454
weighted avg       0.94      0.94      0.93       454

2023-02-09 21:00:53,213 | DEBUG | 
2023-02-09 21:00:53,213 | INFO | Training complete!
2023-02-09 21:00:53,213 | INFO | Total training took 0:06:15 (h:mm:ss)
2023-02-09 21:00:53,227 | DEBUG | ====================================================================================================
2023-02-09 21:00:53,227 | DEBUG | ********************************************************************************
2023-02-09 21:00:53,228 | DEBUG | Iteration: 2/8
2023-02-09 21:00:53,228 | INFO | [{'epoch': 1, 'Training Loss': 0.4729687680955976, 'Training Accur.': 0.8592635568474261, 'Training Precision (macro)': 0.5524987658910546, 'Training Precision (micro)': 0.8592635568474261, 'Training Recall (macro)': 0.5061924503986246, 'Training Recall (micro)': 0.8592635568474261, 'Training F1 (macro)': 0.47807993568189155, 'Training F1 (micro)': 0.8592635568474261, 'Valid. Loss': 0.3245605707168579, 'Valid. Accur.': 0.8791666666666667, 'Valid. Precision (macro)': 0.6332307384353207, 'Valid. Precision (micro)': 0.877321533907437, 'Valid. Recall (macro)': 0.5147874716667655, 'Valid. Recall (micro)': 0.877321533907437, 'Valid. F1 (macro)': 0.4967265296932542, 'Valid. F1 (micro)': 0.877321533907437, 'Training Time': '0:01:30', 'Validation Time': '0:00:03'}, {'epoch': 2, 'Training Loss': 0.3703289129771292, 'Training Accur.': 0.8833982180741696, 'Training Precision (macro)': 0.8065291041289228, 'Training Precision (micro)': 0.8833982180741696, 'Training Recall (macro)': 0.6058794978941404, 'Training Recall (micro)': 0.8833982180741696, 'Training F1 (macro)': 0.6383855299761224, 'Training F1 (micro)': 0.8833982180741696, 'Valid. Loss': 0.21451832155386608, 'Valid. Accur.': 0.9243055555555556, 'Valid. Precision (macro)': 0.9395115895376317, 'Valid. Precision (micro)': 0.9444248092114281, 'Valid. Recall (macro)': 0.7908877563780493, 'Valid. Recall (micro)': 0.9444248092114281, 'Valid. F1 (macro)': 0.8428706259495303, 'Valid. F1 (micro)': 0.9444248092114281, 'Training Time': '0:01:30', 'Validation Time': '0:00:03'}, {'epoch': 3, 'Training Loss': 0.3143980134045705, 'Training Accur.': 0.9245204935436567, 'Training Precision (macro)': 0.865751526668831, 'Training Precision (micro)': 0.9245204935436567, 'Training Recall (macro)': 0.809960028752077, 'Training Recall (micro)': 0.9245204935436567, 'Training F1 (macro)': 0.833710370002213, 'Training F1 (micro)': 0.9245204935436567, 'Valid. Loss': 0.1720236082871755, 'Valid. Accur.': 0.9479166666666666, 'Valid. Precision (macro)': 0.8701986833285694, 'Valid. Precision (micro)': 0.9413419243099861, 'Valid. Recall (macro)': 0.867918449727875, 'Valid. Recall (micro)': 0.9413419243099861, 'Valid. F1 (macro)': 0.8679490843964561, 'Valid. F1 (micro)': 0.9413419243099861, 'Training Time': '0:01:30', 'Validation Time': '0:00:03'}, {'epoch': 4, 'Training Loss': 0.28796596522442997, 'Training Accur.': 0.9498093632169846, 'Training Precision (macro)': 0.8992716309840524, 'Training Precision (micro)': 0.9498093632169846, 'Training Recall (macro)': 0.879764682605021, 'Training Recall (micro)': 0.9498093632169846, 'Training F1 (macro)': 0.8883349024971017, 'Training F1 (micro)': 0.9498093632169846, 'Valid. Loss': 0.18844165901343027, 'Valid. Accur.': 0.9326388888888889, 'Valid. Precision (macro)': 0.8917282143750463, 'Valid. Precision (micro)': 0.9386911001840791, 'Valid. Recall (macro)': 0.8373332135623949, 'Valid. Recall (micro)': 0.9386911001840791, 'Valid. F1 (macro)': 0.8593505792189671, 'Valid. F1 (micro)': 0.9386911001840791, 'Training Time': '0:01:30', 'Validation Time': '0:00:03'}]
2023-02-09 21:00:53,228 | DEBUG | ********************************************************************************
2023-02-09 21:00:53,228 | DEBUG | ====================================================================================================
2023-02-09 21:00:53,229 | INFO | To execute testing of the model on test_data
2023-02-09 21:00:53,229 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-02-09 21:00:53,229 | INFO | 	 1 - NVIDIA A100-SXM4-40GB
2023-02-09 21:00:53,229 | DEBUG | Running Testing...
2023-02-09 21:00:54,885 | INFO | 
        Test_acc : 0.8772012057307231
        Test_precision (macro, micro): [0.74211895 0.87720121]
        Test_recall (macro, micro): [0.69364032 0.87720121]
        Test_F1 (macro, micro): [0.71161693 0.87720121]
2023-02-09 21:00:54,885 | INFO |   Accuracy: 0.89
2023-02-09 21:00:54,886 | INFO |   Test Loss: 0.24
2023-02-09 21:00:54,886 | INFO |   Test took: 0:00:02
2023-02-09 21:00:54,889 | INFO | Classification report. TEST 
               precision    recall  f1-score   support

           0       0.92      0.95      0.94       207
           1       0.59      0.50      0.54        32

    accuracy                           0.89       239
   macro avg       0.76      0.72      0.74       239
weighted avg       0.88      0.89      0.88       239

2023-02-09 21:00:54,899 | DEBUG | {'general_set_up': {'dataset_filename': '20230207_Dataset_GTC_FINAL_Witnesses.xlsx', 'input_dir_name': 'input', 'output_dir_name': 'output', 'dataset_dir_name': 'dataset', 'logs_dir_name': 'logs', 'models_dir_name': 'models', 'plots_dir_name': 'plots'}, 'dataset': {'index_columns_dataset': 1, 'list_columns_names': ['tribunal', 'id_transcript', 'case', 'accused', 'date', 'text', 'trauma', 'role', 'witnesses', 'n_witnesses', 'start', 'id_annotation', 'id_document'], 'col_of_interest_binary_classif': 'trauma', 'col_of_interest_multi_label_classif': 'role', 'col_of_reference_binary_classif': 'text', 'col_of_reference_multi_label_classif': 'text'}, 'models': {'bert': ['bert-base-uncased', 'nlpaueb/legal-bert-base-uncased'], 'other': ['snowood1/ConfliBERT-scr-uncased', 'GroNLP/hateBERT']}, 'training_model': {'model_name': 'bert-base-uncased', 'epochs': 4, 'batch_size': 32, 'embedding_size': 512, 'return_attention_mask': True, 'cross_validation': False, 'save_model': True, 'store_statistics': True, 'test_model': True, 'add_special_tokes': True, 'max_length': 512, 'pad_to_max_length': True, 'run_in_gpu': True, 'classification_task': 'binary', 'learning_rate': '1e-6', 'epsilon_optimizer': '1e-8', 'weight_decay': 0}, 'active_training': {'size_splits_dataset': 8, 'classification_task': 'binary'}}
2023-02-09 21:00:54,899 | DEBUG | Num of different classes in the dataset is 2 which are:
2023-02-09 21:00:54,900 | DEBUG | 	 1 - 0
2023-02-09 21:00:54,900 | DEBUG | 	 2 - 1
2023-02-09 21:00:54,900 | WARNING | 0    6201
1     963
Name: trauma, dtype: int64
2023-02-09 21:00:54,901 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-02-09 21:00:54,901 | INFO | 	 1 - NVIDIA A100-SXM4-40GB
2023-02-09 21:00:54,901 | DEBUG | 

==> Selected device is 'cuda' <==
2023-02-09 21:00:54,902 | DEBUG | Loading tokenizer... [ID:bert];[Name:bert-base-uncased]
2023-02-09 21:00:55,085 | INFO | bert tokenizer was loaded successfully (bert-base-uncased)
	do_lower_case=True
2023-02-09 21:00:59,932 | INFO | Max sentence length: 347 found at index 3164. Sentence is:


A.   It wasn't a short -- it was a short journey, two and a half kilometres approximately.  We climbed a hill.  We heard bursts of gunfire. When we reached the place where there was gunfire, the buses stopped and as soon as they stopped, the doors would open.  Serbian soldiers gathered round the buses.  Said -- and they were cursing our mothers and us, and Haris Silajdzic's mother as well.  They said, "They don't want you.  Get out of the bus."  And then death -- you could see death in their eyes. Until that point, you feel you never knew what was going, because they would say one thing, do another, and they started -- people started emerging from the buses and after the buses were half empty, they would stop people from disembarking. I was still on the bus and was looking at what was going on.  They took the people down a path in the field, there are dead people, bursts of gunfire would cut people down.  People fell dead to the ground.  When this was finished, they would come back.  I emerged from the bus.  There were cursing, "Fuck your mother and Alija and Haris."  "They don't want you."  "Get out of the bus." "Come here."  And you reckon there are still a couple of seconds of life left.  When everybody disembarked from the buses with their hands tied, including me, we formed a column and there were dead people in the column, there were dead people on the path, you could see them lying on the ground.  They didn't even reach the execution site.



2023-02-09 21:01:06,028 | INFO | 
CORPUS TRAINING AND VALIDATION: 
            
	 Length labels 6805
            
	 Length input_ids 6805
            
	 Length attention_masks 6805
            

2023-02-09 21:01:06,029 | INFO | 
	CORPUS TRAINING:  
            
		 Length labels 6124
            
		 Length input_ids 6124
            
		 Length attention_masks 6124
2023-02-09 21:01:06,029 | INFO | 
	CORPUS VALIDATION: 
            
		 Length labels 681
            
		 Length input_ids 681
            
		 Length attention_masks 681
2023-02-09 21:01:06,029 | INFO | 
2023-02-09 21:01:06,029 | INFO | 
CORPUS TEST: 
            
	 Length labels 359
            
	 Length input_ids 359
            
	 Length attention_masks 359
            

2023-02-09 21:01:07,530 | DEBUG | Optimizer
2023-02-09 21:01:07,530 | DEBUG | AdamW (
Parameter Group 0
    betas: (0.9, 0.999)
    correct_bias: True
    eps: 1e-08
    lr: 1e-06
    weight_decay: 0.0
)
2023-02-09 21:01:07,531 | DEBUG | 
2023-02-09 21:01:07,531 | INFO | ======== Epoch 1 / 4 ========
2023-02-09 21:01:07,531 | INFO | Training...
2023-02-09 21:02:18,467 | DEBUG |   Batch   100  of    192.    Elapsed: 0:01:11.
2023-02-09 21:03:24,335 | INFO | Epoch 1 : 
            Train_acc : 0.8639806070123751
            Train_precision (macro, micro): [0.58627306 0.86398061]
            Train_recall  (macro, micro): [0.50980138 0.86398061]
            Train_F1 : [0.48693754 0.86398061]
2023-02-09 21:03:24,336 | DEBUG | 
2023-02-09 21:03:24,336 | INFO |   Average training loss: 0.44
2023-02-09 21:03:24,336 | INFO |   Training epoch took: 0:02:17
2023-02-09 21:03:24,346 | INFO | Classification report. TRAINING at epoch 1 
               precision    recall  f1-score   support

           0       0.88      0.99      0.93      5301
           1       0.64      0.10      0.17       823

    accuracy                           0.87      6124
   macro avg       0.76      0.54      0.55      6124
weighted avg       0.84      0.87      0.83      6124

2023-02-09 21:03:24,346 | DEBUG | 
2023-02-09 21:03:24,346 | INFO | Running Validation...
2023-02-09 21:03:29,078 | INFO | Epoch 1 : 
                Valid_acc : 0.8969074469568462
                Valid_precision (macro, micro): [0.7986     0.89690745]
                Valid_recall (macro, micro): [0.71904272 0.89690745]
                Valid_F1 (macro, micro): [0.748781   0.89690745]
2023-02-09 21:03:29,079 | INFO |   Accuracy: 0.90
2023-02-09 21:03:29,079 | INFO |   Validation Loss: 0.27
2023-02-09 21:03:29,079 | INFO |   Validation took: 0:00:05
2023-02-09 21:03:29,083 | INFO | Classification report. VALIDATION at epoch 1 
               precision    recall  f1-score   support

           0       0.92      0.97      0.94       589
           1       0.71      0.43      0.54        92

    accuracy                           0.90       681
   macro avg       0.82      0.70      0.74       681
weighted avg       0.89      0.90      0.89       681

2023-02-09 21:03:29,084 | DEBUG | 
2023-02-09 21:03:29,084 | INFO | ======== Epoch 2 / 4 ========
2023-02-09 21:03:29,084 | INFO | Training...
2023-02-09 21:04:39,832 | DEBUG |   Batch   100  of    192.    Elapsed: 0:01:11.
2023-02-09 21:05:45,814 | INFO | Epoch 2 : 
            Train_acc : 0.9069688224773317
            Train_precision (macro, micro): [0.81634491 0.90696882]
            Train_recall  (macro, micro): [0.74187091 0.90696882]
            Train_F1 : [0.77147256 0.90696882]
2023-02-09 21:05:45,814 | DEBUG | 
2023-02-09 21:05:45,814 | INFO |   Average training loss: 0.34
2023-02-09 21:05:45,814 | INFO |   Training epoch took: 0:02:17
2023-02-09 21:05:45,825 | INFO | Classification report. TRAINING at epoch 2 
               precision    recall  f1-score   support

           0       0.93      0.97      0.95      5301
           1       0.72      0.55      0.62       823

    accuracy                           0.91      6124
   macro avg       0.83      0.76      0.79      6124
weighted avg       0.90      0.91      0.91      6124

2023-02-09 21:05:45,826 | DEBUG | 
2023-02-09 21:05:45,826 | INFO | Running Validation...
2023-02-09 21:05:50,558 | INFO | Epoch 2 : 
                Valid_acc : 0.9468242676627194
                Valid_precision (macro, micro): [0.86452698 0.94682427]
                Valid_recall (macro, micro): [0.89806115 0.94682427]
                Valid_F1 (macro, micro): [0.88006646 0.94682427]
2023-02-09 21:05:50,558 | INFO |   Accuracy: 0.93
2023-02-09 21:05:50,559 | INFO |   Validation Loss: 0.19
2023-02-09 21:05:50,559 | INFO |   Validation took: 0:00:05
2023-02-09 21:05:50,563 | INFO | Classification report. VALIDATION at epoch 2 
               precision    recall  f1-score   support

           0       0.97      0.95      0.96       589
           1       0.73      0.78      0.75        92

    accuracy                           0.93       681
   macro avg       0.85      0.87      0.86       681
weighted avg       0.93      0.93      0.93       681

2023-02-09 21:05:50,563 | DEBUG | 
2023-02-09 21:05:50,563 | INFO | ======== Epoch 3 / 4 ========
2023-02-09 21:05:50,564 | INFO | Training...
2023-02-09 21:07:01,297 | DEBUG |   Batch   100  of    192.    Elapsed: 0:01:11.
2023-02-09 21:08:07,267 | INFO | Epoch 3 : 
            Train_acc : 0.9337247834528566
            Train_precision (macro, micro): [0.86602032 0.93372478]
            Train_recall  (macro, micro): [0.8456092  0.93372478]
            Train_F1 : [0.85521204 0.93372478]
2023-02-09 21:08:07,268 | DEBUG | 
2023-02-09 21:08:07,268 | INFO |   Average training loss: 0.30
2023-02-09 21:08:07,268 | INFO |   Training epoch took: 0:02:17
2023-02-09 21:08:07,279 | INFO | Classification report. TRAINING at epoch 3 
               precision    recall  f1-score   support

           0       0.96      0.97      0.96      5301
           1       0.77      0.73      0.75       823

    accuracy                           0.93      6124
   macro avg       0.86      0.85      0.86      6124
weighted avg       0.93      0.93      0.93      6124

2023-02-09 21:08:07,279 | DEBUG | 
2023-02-09 21:08:07,279 | INFO | Running Validation...
2023-02-09 21:08:12,013 | INFO | Epoch 3 : 
                Valid_acc : 0.9342129604723376
                Valid_precision (macro, micro): [0.89872123 0.93421296]
                Valid_recall (macro, micro): [0.79914165 0.93421296]
                Valid_F1 (macro, micro): [0.83841244 0.93421296]
2023-02-09 21:08:12,013 | INFO |   Accuracy: 0.93
2023-02-09 21:08:12,014 | INFO |   Validation Loss: 0.19
2023-02-09 21:08:12,014 | INFO |   Validation took: 0:00:05
2023-02-09 21:08:12,018 | INFO | Classification report. VALIDATION at epoch 3 
               precision    recall  f1-score   support

           0       0.94      0.98      0.96       589
           1       0.85      0.60      0.70        92

    accuracy                           0.93       681
   macro avg       0.89      0.79      0.83       681
weighted avg       0.93      0.93      0.93       681

2023-02-09 21:08:12,019 | DEBUG | 
2023-02-09 21:08:12,019 | INFO | ======== Epoch 4 / 4 ========
2023-02-09 21:08:12,019 | INFO | Training...
2023-02-09 21:09:22,778 | DEBUG |   Batch   100  of    192.    Elapsed: 0:01:11.
2023-02-09 21:10:28,731 | INFO | Epoch 4 : 
            Train_acc : 0.9607193786949272
            Train_precision (macro, micro): [0.91886603 0.96071938]
            Train_recall  (macro, micro): [0.90713691 0.96071938]
            Train_F1 : [0.91265911 0.96071938]
2023-02-09 21:10:28,731 | DEBUG | 
2023-02-09 21:10:28,731 | INFO |   Average training loss: 0.27
2023-02-09 21:10:28,731 | INFO |   Training epoch took: 0:02:17
2023-02-09 21:10:28,742 | INFO | Classification report. TRAINING at epoch 4 
               precision    recall  f1-score   support

           0       0.97      0.98      0.98      5301
           1       0.86      0.84      0.85       823

    accuracy                           0.96      6124
   macro avg       0.92      0.91      0.91      6124
weighted avg       0.96      0.96      0.96      6124

2023-02-09 21:10:28,743 | DEBUG | 
2023-02-09 21:10:28,743 | INFO | Running Validation...
2023-02-09 21:10:33,477 | INFO | Epoch 4 : 
                Valid_acc : 0.9379789702805529
                Valid_precision (macro, micro): [0.88832601 0.93797897]
                Valid_recall (macro, micro): [0.8546185  0.93797897]
                Valid_F1 (macro, micro): [0.87000707 0.93797897]
2023-02-09 21:10:33,478 | INFO |   Accuracy: 0.94
2023-02-09 21:10:33,482 | INFO |   Validation Loss: 0.18
2023-02-09 21:10:33,482 | INFO |   Validation took: 0:00:05
2023-02-09 21:10:33,486 | INFO | Classification report. VALIDATION at epoch 4 
               precision    recall  f1-score   support

           0       0.96      0.97      0.96       589
           1       0.80      0.72      0.76        92

    accuracy                           0.94       681
   macro avg       0.88      0.85      0.86       681
weighted avg       0.94      0.94      0.94       681

2023-02-09 21:10:33,487 | DEBUG | 
2023-02-09 21:10:33,487 | INFO | Training complete!
2023-02-09 21:10:33,487 | INFO | Total training took 0:09:26 (h:mm:ss)
2023-02-09 21:10:33,506 | DEBUG | ====================================================================================================
2023-02-09 21:10:33,506 | DEBUG | ********************************************************************************
2023-02-09 21:10:33,507 | DEBUG | Iteration: 3/8
2023-02-09 21:10:33,507 | INFO | [{'epoch': 1, 'Training Loss': 0.4420966718656321, 'Training Accur.': 0.8639806070123751, 'Training Precision (macro)': 0.5862730552006795, 'Training Precision (micro)': 0.8639806070123751, 'Training Recall (macro)': 0.5098013821741215, 'Training Recall (micro)': 0.8639806070123751, 'Training F1 (macro)': 0.4869375381085441, 'Training F1 (micro)': 0.8639806070123751, 'Valid. Loss': 0.2743515067479827, 'Valid. Accur.': 0.89614898989899, 'Valid. Precision (macro)': 0.7985999971757838, 'Valid. Precision (micro)': 0.8969074469568462, 'Valid. Recall (macro)': 0.7190427213055967, 'Valid. Recall (micro)': 0.8969074469568462, 'Valid. F1 (macro)': 0.7487810020159145, 'Valid. F1 (micro)': 0.8969074469568462, 'Training Time': '0:02:17', 'Validation Time': '0:00:05'}, {'epoch': 2, 'Training Loss': 0.3375282483951499, 'Training Accur.': 0.9069688224773317, 'Training Precision (macro)': 0.81634490676221, 'Training Precision (micro)': 0.9069688224773317, 'Training Recall (macro)': 0.7418709060610668, 'Training Recall (micro)': 0.9069688224773317, 'Training F1 (macro)': 0.7714725621356672, 'Training F1 (micro)': 0.9069688224773317, 'Valid. Loss': 0.1882812360470945, 'Valid. Accur.': 0.9332386363636364, 'Valid. Precision (macro)': 0.864526982190061, 'Valid. Precision (micro)': 0.9468242676627194, 'Valid. Recall (macro)': 0.8980611498151091, 'Valid. Recall (micro)': 0.9468242676627194, 'Valid. F1 (macro)': 0.8800664641760061, 'Valid. F1 (micro)': 0.9468242676627194, 'Training Time': '0:02:17', 'Validation Time': '0:00:05'}, {'epoch': 3, 'Training Loss': 0.30311647973333794, 'Training Accur.': 0.9337247834528566, 'Training Precision (macro)': 0.8660203221121834, 'Training Precision (micro)': 0.9337247834528566, 'Training Recall (macro)': 0.8456091956531528, 'Training Recall (micro)': 0.9337247834528566, 'Training F1 (macro)': 0.8552120360741952, 'Training F1 (micro)': 0.9337247834528566, 'Valid. Loss': 0.19078109176321464, 'Valid. Accur.': 0.9296085858585859, 'Valid. Precision (macro)': 0.8987212307716347, 'Valid. Precision (micro)': 0.9342129604723376, 'Valid. Recall (macro)': 0.7991416460327315, 'Valid. Recall (micro)': 0.9342129604723376, 'Valid. F1 (macro)': 0.8384124410844263, 'Valid. F1 (micro)': 0.9342129604723376, 'Training Time': '0:02:17', 'Validation Time': '0:00:05'}, {'epoch': 4, 'Training Loss': 0.2698495520744473, 'Training Accur.': 0.9607193786949272, 'Training Precision (macro)': 0.9188660277138042, 'Training Precision (micro)': 0.9607193786949272, 'Training Recall (macro)': 0.9071369121135358, 'Training Recall (micro)': 0.9607193786949272, 'Training F1 (macro)': 0.9126591072453952, 'Training F1 (micro)': 0.9607193786949272, 'Valid. Loss': 0.17678066715598106, 'Valid. Accur.': 0.9403409090909091, 'Valid. Precision (macro)': 0.888326009670312, 'Valid. Precision (micro)': 0.9379789702805529, 'Valid. Recall (macro)': 0.8546185008136369, 'Valid. Recall (micro)': 0.9379789702805529, 'Valid. F1 (macro)': 0.8700070747504248, 'Valid. F1 (micro)': 0.9379789702805529, 'Training Time': '0:02:17', 'Validation Time': '0:00:05'}]
2023-02-09 21:10:33,507 | DEBUG | ********************************************************************************
2023-02-09 21:10:33,508 | DEBUG | ====================================================================================================
2023-02-09 21:10:33,508 | INFO | To execute testing of the model on test_data
2023-02-09 21:10:33,508 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-02-09 21:10:33,508 | INFO | 	 1 - NVIDIA A100-SXM4-40GB
2023-02-09 21:10:33,508 | DEBUG | Running Testing...
2023-02-09 21:10:36,001 | INFO | 
        Test_acc : 0.9209814813140023
        Test_precision (macro, micro): [0.86675416 0.92098148]
        Test_recall (macro, micro): [0.82766151 0.92098148]
        Test_F1 (macro, micro): [0.84278798 0.92098148]
2023-02-09 21:10:36,001 | INFO |   Accuracy: 0.92
2023-02-09 21:10:36,001 | INFO |   Test Loss: 0.22
2023-02-09 21:10:36,001 | INFO |   Test took: 0:00:02
2023-02-09 21:10:36,005 | INFO | Classification report. TEST 
               precision    recall  f1-score   support

           0       0.96      0.95      0.95       311
           1       0.69      0.73      0.71        48

    accuracy                           0.92       359
   macro avg       0.82      0.84      0.83       359
weighted avg       0.92      0.92      0.92       359

2023-02-09 21:10:36,015 | DEBUG | {'general_set_up': {'dataset_filename': '20230207_Dataset_GTC_FINAL_Witnesses.xlsx', 'input_dir_name': 'input', 'output_dir_name': 'output', 'dataset_dir_name': 'dataset', 'logs_dir_name': 'logs', 'models_dir_name': 'models', 'plots_dir_name': 'plots'}, 'dataset': {'index_columns_dataset': 1, 'list_columns_names': ['tribunal', 'id_transcript', 'case', 'accused', 'date', 'text', 'trauma', 'role', 'witnesses', 'n_witnesses', 'start', 'id_annotation', 'id_document'], 'col_of_interest_binary_classif': 'trauma', 'col_of_interest_multi_label_classif': 'role', 'col_of_reference_binary_classif': 'text', 'col_of_reference_multi_label_classif': 'text'}, 'models': {'bert': ['bert-base-uncased', 'nlpaueb/legal-bert-base-uncased'], 'other': ['snowood1/ConfliBERT-scr-uncased', 'GroNLP/hateBERT']}, 'training_model': {'model_name': 'bert-base-uncased', 'epochs': 4, 'batch_size': 32, 'embedding_size': 512, 'return_attention_mask': True, 'cross_validation': False, 'save_model': True, 'store_statistics': True, 'test_model': True, 'add_special_tokes': True, 'max_length': 512, 'pad_to_max_length': True, 'run_in_gpu': True, 'classification_task': 'binary', 'learning_rate': '1e-6', 'epsilon_optimizer': '1e-8', 'weight_decay': 0}, 'active_training': {'size_splits_dataset': 8, 'classification_task': 'binary'}}
2023-02-09 21:10:36,016 | DEBUG | Num of different classes in the dataset is 2 which are:
2023-02-09 21:10:36,016 | DEBUG | 	 1 - 0
2023-02-09 21:10:36,016 | DEBUG | 	 2 - 1
2023-02-09 21:10:36,016 | WARNING | 0    8268
1    1284
Name: trauma, dtype: int64
2023-02-09 21:10:36,017 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-02-09 21:10:36,017 | INFO | 	 1 - NVIDIA A100-SXM4-40GB
2023-02-09 21:10:36,017 | DEBUG | 

==> Selected device is 'cuda' <==
2023-02-09 21:10:36,018 | DEBUG | Loading tokenizer... [ID:bert];[Name:bert-base-uncased]
2023-02-09 21:10:36,215 | INFO | bert tokenizer was loaded successfully (bert-base-uncased)
	do_lower_case=True
2023-02-09 21:10:43,084 | INFO | Max sentence length: 347 found at index 3164. Sentence is:


A.   It wasn't a short -- it was a short journey, two and a half kilometres approximately.  We climbed a hill.  We heard bursts of gunfire. When we reached the place where there was gunfire, the buses stopped and as soon as they stopped, the doors would open.  Serbian soldiers gathered round the buses.  Said -- and they were cursing our mothers and us, and Haris Silajdzic's mother as well.  They said, "They don't want you.  Get out of the bus."  And then death -- you could see death in their eyes. Until that point, you feel you never knew what was going, because they would say one thing, do another, and they started -- people started emerging from the buses and after the buses were half empty, they would stop people from disembarking. I was still on the bus and was looking at what was going on.  They took the people down a path in the field, there are dead people, bursts of gunfire would cut people down.  People fell dead to the ground.  When this was finished, they would come back.  I emerged from the bus.  There were cursing, "Fuck your mother and Alija and Haris."  "They don't want you."  "Get out of the bus." "Come here."  And you reckon there are still a couple of seconds of life left.  When everybody disembarked from the buses with their hands tied, including me, we formed a column and there were dead people in the column, there were dead people on the path, you could see them lying on the ground.  They didn't even reach the execution site.



2023-02-09 21:10:51,663 | INFO | 
CORPUS TRAINING AND VALIDATION: 
            
	 Length labels 9074
            
	 Length input_ids 9074
            
	 Length attention_masks 9074
            

2023-02-09 21:10:51,664 | INFO | 
	CORPUS TRAINING:  
            
		 Length labels 8166
            
		 Length input_ids 8166
            
		 Length attention_masks 8166
2023-02-09 21:10:51,664 | INFO | 
	CORPUS VALIDATION: 
            
		 Length labels 908
            
		 Length input_ids 908
            
		 Length attention_masks 908
2023-02-09 21:10:51,664 | INFO | 
2023-02-09 21:10:51,664 | INFO | 
CORPUS TEST: 
            
	 Length labels 478
            
	 Length input_ids 478
            
	 Length attention_masks 478
            

2023-02-09 21:10:53,089 | DEBUG | Optimizer
2023-02-09 21:10:53,090 | DEBUG | AdamW (
Parameter Group 0
    betas: (0.9, 0.999)
    correct_bias: True
    eps: 1e-08
    lr: 1e-06
    weight_decay: 0.0
)
2023-02-09 21:10:53,091 | DEBUG | 
2023-02-09 21:10:53,091 | INFO | ======== Epoch 1 / 4 ========
2023-02-09 21:10:53,091 | INFO | Training...
2023-02-09 21:12:03,808 | DEBUG |   Batch   100  of    256.    Elapsed: 0:01:11.
2023-02-09 21:13:16,009 | DEBUG |   Batch   200  of    256.    Elapsed: 0:02:23.
2023-02-09 21:13:56,488 | INFO | Epoch 1 : 
            Train_acc : 0.8707082563224089
            Train_precision (macro, micro): [0.72260008 0.87070826]
            Train_recall  (macro, micro): [0.52565923 0.87070826]
            Train_F1 : [0.51439074 0.87070826]
2023-02-09 21:13:56,488 | DEBUG | 
2023-02-09 21:13:56,488 | INFO |   Average training loss: 0.43
2023-02-09 21:13:56,488 | INFO |   Training epoch took: 0:03:03
2023-02-09 21:13:56,501 | INFO | Classification report. TRAINING at epoch 1 
               precision    recall  f1-score   support

           0       0.88      0.99      0.93      7068
           1       0.65      0.16      0.26      1098

    accuracy                           0.88      8166
   macro avg       0.77      0.58      0.60      8166
weighted avg       0.85      0.88      0.84      8166

2023-02-09 21:13:56,502 | DEBUG | 
2023-02-09 21:13:56,502 | INFO | Running Validation...
2023-02-09 21:14:02,828 | INFO | Epoch 1 : 
                Valid_acc : 0.8866648193670071
                Valid_precision (macro, micro): [0.77333252 0.88666482]
                Valid_recall (macro, micro): [0.67327016 0.88666482]
                Valid_F1 (macro, micro): [0.70533632 0.88666482]
2023-02-09 21:14:02,828 | INFO |   Accuracy: 0.90
2023-02-09 21:14:02,828 | INFO |   Validation Loss: 0.26
2023-02-09 21:14:02,828 | INFO |   Validation took: 0:00:06
2023-02-09 21:14:02,832 | INFO | Classification report. VALIDATION at epoch 1 
               precision    recall  f1-score   support

           0       0.91      0.97      0.94       786
           1       0.70      0.40      0.51       122

    accuracy                           0.90       908
   macro avg       0.81      0.69      0.73       908
weighted avg       0.88      0.90      0.88       908

2023-02-09 21:14:02,833 | DEBUG | 
2023-02-09 21:14:02,833 | INFO | ======== Epoch 2 / 4 ========
2023-02-09 21:14:02,833 | INFO | Training...
2023-02-09 21:15:13,636 | DEBUG |   Batch   100  of    256.    Elapsed: 0:01:11.
2023-02-09 21:16:25,785 | DEBUG |   Batch   200  of    256.    Elapsed: 0:02:23.
2023-02-09 21:17:06,245 | INFO | Epoch 2 : 
            Train_acc : 0.9221298998793236
            Train_precision (macro, micro): [0.84622316 0.9221299 ]
            Train_recall  (macro, micro): [0.76068267 0.9221299 ]
            Train_F1 : [0.79288517 0.9221299 ]
2023-02-09 21:17:06,246 | DEBUG | 
2023-02-09 21:17:06,246 | INFO |   Average training loss: 0.32
2023-02-09 21:17:06,246 | INFO |   Training epoch took: 0:03:03
2023-02-09 21:17:06,260 | INFO | Classification report. TRAINING at epoch 2 
               precision    recall  f1-score   support

           0       0.94      0.97      0.96      7068
           1       0.76      0.63      0.69      1098

    accuracy                           0.92      8166
   macro avg       0.85      0.80      0.82      8166
weighted avg       0.92      0.92      0.92      8166

2023-02-09 21:17:06,260 | DEBUG | 
2023-02-09 21:17:06,261 | INFO | Running Validation...
2023-02-09 21:17:12,577 | INFO | Epoch 2 : 
                Valid_acc : 0.915101590599523
                Valid_precision (macro, micro): [0.82629032 0.91510159]
                Valid_recall (macro, micro): [0.8729749  0.91510159]
                Valid_F1 (macro, micro): [0.84597934 0.91510159]
2023-02-09 21:17:12,577 | INFO |   Accuracy: 0.92
2023-02-09 21:17:12,577 | INFO |   Validation Loss: 0.21
2023-02-09 21:17:12,577 | INFO |   Validation took: 0:00:06
2023-02-09 21:17:12,581 | INFO | Classification report. VALIDATION at epoch 2 
               precision    recall  f1-score   support

           0       0.97      0.93      0.95       786
           1       0.66      0.84      0.74       122

    accuracy                           0.92       908
   macro avg       0.82      0.88      0.85       908
weighted avg       0.93      0.92      0.92       908

2023-02-09 21:17:12,582 | DEBUG | 
2023-02-09 21:17:12,582 | INFO | ======== Epoch 3 / 4 ========
2023-02-09 21:17:12,583 | INFO | Training...
2023-02-09 21:18:23,223 | DEBUG |   Batch   100  of    256.    Elapsed: 0:01:11.
2023-02-09 21:19:35,441 | DEBUG |   Batch   200  of    256.    Elapsed: 0:02:23.
2023-02-09 21:20:15,949 | INFO | Epoch 3 : 
            Train_acc : 0.9443857470750903
            Train_precision (macro, micro): [0.88949518 0.94438575]
            Train_recall  (macro, micro): [0.87337486 0.94438575]
            Train_F1 : [0.88101158 0.94438575]
2023-02-09 21:20:15,949 | DEBUG | 
2023-02-09 21:20:15,949 | INFO |   Average training loss: 0.29
2023-02-09 21:20:15,950 | INFO |   Training epoch took: 0:03:03
2023-02-09 21:20:15,963 | INFO | Classification report. TRAINING at epoch 3 
               precision    recall  f1-score   support

           0       0.96      0.97      0.97      7068
           1       0.81      0.76      0.78      1098

    accuracy                           0.94      8166
   macro avg       0.89      0.87      0.88      8166
weighted avg       0.94      0.94      0.94      8166

2023-02-09 21:20:15,963 | DEBUG | 
2023-02-09 21:20:15,963 | INFO | Running Validation...
2023-02-09 21:20:22,278 | INFO | Epoch 3 : 
                Valid_acc : 0.9309717881204485
                Valid_precision (macro, micro): [0.84361433 0.93097179]
                Valid_recall (macro, micro): [0.90699046 0.93097179]
                Valid_F1 (macro, micro): [0.86968161 0.93097179]
2023-02-09 21:20:22,279 | INFO |   Accuracy: 0.93
2023-02-09 21:20:22,279 | INFO |   Validation Loss: 0.19
2023-02-09 21:20:22,279 | INFO |   Validation took: 0:00:06
2023-02-09 21:20:22,283 | INFO | Classification report. VALIDATION at epoch 3 
               precision    recall  f1-score   support

           0       0.98      0.94      0.96       786
           1       0.69      0.87      0.77       122

    accuracy                           0.93       908
   macro avg       0.83      0.90      0.86       908
weighted avg       0.94      0.93      0.93       908

2023-02-09 21:20:22,284 | DEBUG | 
2023-02-09 21:20:22,284 | INFO | ======== Epoch 4 / 4 ========
2023-02-09 21:20:22,284 | INFO | Training...
2023-02-09 21:21:32,969 | DEBUG |   Batch   100  of    256.    Elapsed: 0:01:11.
2023-02-09 21:22:45,241 | DEBUG |   Batch   200  of    256.    Elapsed: 0:02:23.
2023-02-09 21:23:25,776 | INFO | Epoch 4 : 
            Train_acc : 0.9711733724031002
            Train_precision (macro, micro): [0.934747   0.97117337]
            Train_recall  (macro, micro): [0.94253399 0.97117337]
            Train_F1 : [0.9383334  0.97117337]
2023-02-09 21:23:25,776 | DEBUG | 
2023-02-09 21:23:25,777 | INFO |   Average training loss: 0.25
2023-02-09 21:23:25,777 | INFO |   Training epoch took: 0:03:03
2023-02-09 21:23:25,790 | INFO | Classification report. TRAINING at epoch 4 
               precision    recall  f1-score   support

           0       0.98      0.98      0.98      7068
           1       0.89      0.89      0.89      1098

    accuracy                           0.97      8166
   macro avg       0.94      0.94      0.94      8166
weighted avg       0.97      0.97      0.97      8166

2023-02-09 21:23:25,791 | DEBUG | 
2023-02-09 21:23:25,791 | INFO | Running Validation...
2023-02-09 21:23:32,107 | INFO | Epoch 4 : 
                Valid_acc : 0.9387371817499681
                Valid_precision (macro, micro): [0.86190396 0.93873718]
                Valid_recall (macro, micro): [0.86150332 0.93873718]
                Valid_F1 (macro, micro): [0.8598725  0.93873718]
2023-02-09 21:23:32,108 | INFO |   Accuracy: 0.94
2023-02-09 21:23:32,108 | INFO |   Validation Loss: 0.18
2023-02-09 21:23:32,108 | INFO |   Validation took: 0:00:06
2023-02-09 21:23:32,112 | INFO | Classification report. VALIDATION at epoch 4 
               precision    recall  f1-score   support

           0       0.96      0.96      0.96       786
           1       0.76      0.74      0.75       122

    accuracy                           0.93       908
   macro avg       0.86      0.85      0.86       908
weighted avg       0.93      0.93      0.93       908

2023-02-09 21:23:32,113 | DEBUG | 
2023-02-09 21:23:32,113 | INFO | Training complete!
2023-02-09 21:23:32,113 | INFO | Total training took 0:12:39 (h:mm:ss)
2023-02-09 21:23:32,138 | DEBUG | ====================================================================================================
2023-02-09 21:23:32,138 | DEBUG | ********************************************************************************
2023-02-09 21:23:32,139 | DEBUG | Iteration: 4/8
2023-02-09 21:23:32,139 | INFO | [{'epoch': 1, 'Training Loss': 0.4261552373645827, 'Training Accur.': 0.8707082563224089, 'Training Precision (macro)': 0.722600078496955, 'Training Precision (micro)': 0.8707082563224089, 'Training Recall (macro)': 0.5256592346222302, 'Training Recall (micro)': 0.8707082563224089, 'Training F1 (macro)': 0.5143907440131226, 'Training F1 (micro)': 0.870708256322409, 'Valid. Loss': 0.2625667925538688, 'Valid. Accur.': 0.8951149425287356, 'Valid. Precision (macro)': 0.7733325189074091, 'Valid. Precision (micro)': 0.8866648193670071, 'Valid. Recall (macro)': 0.6732701588338595, 'Valid. Recall (micro)': 0.8866648193670071, 'Valid. F1 (macro)': 0.7053363179699011, 'Valid. F1 (micro)': 0.8866648193670071, 'Training Time': '0:03:03', 'Validation Time': '0:00:06'}, {'epoch': 2, 'Training Loss': 0.32278569316258654, 'Training Accur.': 0.9221298998793236, 'Training Precision (macro)': 0.8462231631406405, 'Training Precision (micro)': 0.9221298998793236, 'Training Recall (macro)': 0.7606826723753927, 'Training Recall (micro)': 0.9221298998793236, 'Training F1 (macro)': 0.7928851666501167, 'Training F1 (micro)': 0.9221298998793236, 'Valid. Loss': 0.21064260884605604, 'Valid. Accur.': 0.9224137931034483, 'Valid. Precision (macro)': 0.8262903220310724, 'Valid. Precision (micro)': 0.915101590599523, 'Valid. Recall (macro)': 0.8729748976114006, 'Valid. Recall (micro)': 0.915101590599523, 'Valid. F1 (macro)': 0.845979341174032, 'Valid. F1 (micro)': 0.915101590599523, 'Training Time': '0:03:03', 'Validation Time': '0:00:06'}, {'epoch': 3, 'Training Loss': 0.2876547754276544, 'Training Accur.': 0.9443857470750903, 'Training Precision (macro)': 0.8894951771474799, 'Training Precision (micro)': 0.9443857470750903, 'Training Recall (macro)': 0.8733748603636243, 'Training Recall (micro)': 0.9443857470750903, 'Training F1 (macro)': 0.8810115793616256, 'Training F1 (micro)': 0.9443857470750903, 'Valid. Loss': 0.18819792851291853, 'Valid. Accur.': 0.9310344827586207, 'Valid. Precision (macro)': 0.8436143343931835, 'Valid. Precision (micro)': 0.9309717881204485, 'Valid. Recall (macro)': 0.90699046289244, 'Valid. Recall (micro)': 0.9309717881204485, 'Valid. F1 (macro)': 0.8696816129296782, 'Valid. F1 (micro)': 0.9309717881204485, 'Training Time': '0:03:03', 'Validation Time': '0:00:06'}, {'epoch': 4, 'Training Loss': 0.2512209912529215, 'Training Accur.': 0.9711733724031002, 'Training Precision (macro)': 0.9347469981478954, 'Training Precision (micro)': 0.9711733724031002, 'Training Recall (macro)': 0.9425339946627977, 'Training Recall (micro)': 0.9711733724031002, 'Training F1 (macro)': 0.9383334019916393, 'Training F1 (micro)': 0.9711733724031002, 'Valid. Loss': 0.17947612702846527, 'Valid. Accur.': 0.9353448275862069, 'Valid. Precision (macro)': 0.8619039644187413, 'Valid. Precision (micro)': 0.9387371817499681, 'Valid. Recall (macro)': 0.8615033208128989, 'Valid. Recall (micro)': 0.9387371817499681, 'Valid. F1 (macro)': 0.8598725043417388, 'Valid. F1 (micro)': 0.9387371817499681, 'Training Time': '0:03:03', 'Validation Time': '0:00:06'}]
2023-02-09 21:23:32,139 | DEBUG | ********************************************************************************
2023-02-09 21:23:32,140 | DEBUG | ====================================================================================================
2023-02-09 21:23:32,140 | INFO | To execute testing of the model on test_data
2023-02-09 21:23:32,140 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-02-09 21:23:32,140 | INFO | 	 1 - NVIDIA A100-SXM4-40GB
2023-02-09 21:23:32,140 | DEBUG | Running Testing...
2023-02-09 21:23:35,443 | INFO | 
        Test_acc : 0.9515259714135238
        Test_precision (macro, micro): [0.90970218 0.95152597]
        Test_recall (macro, micro): [0.87237284 0.95152597]
        Test_F1 (macro, micro): [0.88910547 0.95152597]
2023-02-09 21:23:35,444 | INFO |   Accuracy: 0.95
2023-02-09 21:23:35,444 | INFO |   Test Loss: 0.17
2023-02-09 21:23:35,444 | INFO |   Test took: 0:00:03
2023-02-09 21:23:35,448 | INFO | Classification report. TEST 
               precision    recall  f1-score   support

           0       0.97      0.97      0.97       414
           1       0.82      0.80      0.81        64

    accuracy                           0.95       478
   macro avg       0.90      0.89      0.89       478
weighted avg       0.95      0.95      0.95       478

2023-02-09 21:23:35,458 | DEBUG | {'general_set_up': {'dataset_filename': '20230207_Dataset_GTC_FINAL_Witnesses.xlsx', 'input_dir_name': 'input', 'output_dir_name': 'output', 'dataset_dir_name': 'dataset', 'logs_dir_name': 'logs', 'models_dir_name': 'models', 'plots_dir_name': 'plots'}, 'dataset': {'index_columns_dataset': 1, 'list_columns_names': ['tribunal', 'id_transcript', 'case', 'accused', 'date', 'text', 'trauma', 'role', 'witnesses', 'n_witnesses', 'start', 'id_annotation', 'id_document'], 'col_of_interest_binary_classif': 'trauma', 'col_of_interest_multi_label_classif': 'role', 'col_of_reference_binary_classif': 'text', 'col_of_reference_multi_label_classif': 'text'}, 'models': {'bert': ['bert-base-uncased', 'nlpaueb/legal-bert-base-uncased'], 'other': ['snowood1/ConfliBERT-scr-uncased', 'GroNLP/hateBERT']}, 'training_model': {'model_name': 'bert-base-uncased', 'epochs': 4, 'batch_size': 32, 'embedding_size': 512, 'return_attention_mask': True, 'cross_validation': False, 'save_model': True, 'store_statistics': True, 'test_model': True, 'add_special_tokes': True, 'max_length': 512, 'pad_to_max_length': True, 'run_in_gpu': True, 'classification_task': 'binary', 'learning_rate': '1e-6', 'epsilon_optimizer': '1e-8', 'weight_decay': 0}, 'active_training': {'size_splits_dataset': 8, 'classification_task': 'binary'}}
2023-02-09 21:23:35,459 | DEBUG | Num of different classes in the dataset is 2 which are:
2023-02-09 21:23:35,460 | DEBUG | 	 1 - 0
2023-02-09 21:23:35,460 | DEBUG | 	 2 - 1
2023-02-09 21:23:35,461 | WARNING | 0    10335
1     1605
Name: trauma, dtype: int64
2023-02-09 21:23:35,461 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-02-09 21:23:35,462 | INFO | 	 1 - NVIDIA A100-SXM4-40GB
2023-02-09 21:23:35,462 | DEBUG | 

==> Selected device is 'cuda' <==
2023-02-09 21:23:35,462 | DEBUG | Loading tokenizer... [ID:bert];[Name:bert-base-uncased]
2023-02-09 21:23:35,646 | INFO | bert tokenizer was loaded successfully (bert-base-uncased)
	do_lower_case=True
2023-02-09 21:23:44,509 | INFO | Max sentence length: 347 found at index 3164. Sentence is:


A.   It wasn't a short -- it was a short journey, two and a half kilometres approximately.  We climbed a hill.  We heard bursts of gunfire. When we reached the place where there was gunfire, the buses stopped and as soon as they stopped, the doors would open.  Serbian soldiers gathered round the buses.  Said -- and they were cursing our mothers and us, and Haris Silajdzic's mother as well.  They said, "They don't want you.  Get out of the bus."  And then death -- you could see death in their eyes. Until that point, you feel you never knew what was going, because they would say one thing, do another, and they started -- people started emerging from the buses and after the buses were half empty, they would stop people from disembarking. I was still on the bus and was looking at what was going on.  They took the people down a path in the field, there are dead people, bursts of gunfire would cut people down.  People fell dead to the ground.  When this was finished, they would come back.  I emerged from the bus.  There were cursing, "Fuck your mother and Alija and Haris."  "They don't want you."  "Get out of the bus." "Come here."  And you reckon there are still a couple of seconds of life left.  When everybody disembarked from the buses with their hands tied, including me, we formed a column and there were dead people in the column, there were dead people on the path, you could see them lying on the ground.  They didn't even reach the execution site.



2023-02-09 21:23:55,535 | INFO | 
CORPUS TRAINING AND VALIDATION: 
            
	 Length labels 11343
            
	 Length input_ids 11343
            
	 Length attention_masks 11343
            

2023-02-09 21:23:55,536 | INFO | 
	CORPUS TRAINING:  
            
		 Length labels 10208
            
		 Length input_ids 10208
            
		 Length attention_masks 10208
2023-02-09 21:23:55,536 | INFO | 
	CORPUS VALIDATION: 
            
		 Length labels 1135
            
		 Length input_ids 1135
            
		 Length attention_masks 1135
2023-02-09 21:23:55,536 | INFO | 
2023-02-09 21:23:55,536 | INFO | 
CORPUS TEST: 
            
	 Length labels 597
            
	 Length input_ids 597
            
	 Length attention_masks 597
            

2023-02-09 21:23:56,969 | DEBUG | Optimizer
2023-02-09 21:23:56,969 | DEBUG | AdamW (
Parameter Group 0
    betas: (0.9, 0.999)
    correct_bias: True
    eps: 1e-08
    lr: 1e-06
    weight_decay: 0.0
)
2023-02-09 21:23:56,970 | DEBUG | 
2023-02-09 21:23:56,970 | INFO | ======== Epoch 1 / 4 ========
2023-02-09 21:23:56,970 | INFO | Training...
2023-02-09 21:25:07,731 | DEBUG |   Batch   100  of    319.    Elapsed: 0:01:11.
2023-02-09 21:26:19,762 | DEBUG |   Batch   200  of    319.    Elapsed: 0:02:23.
2023-02-09 21:27:33,113 | DEBUG |   Batch   300  of    319.    Elapsed: 0:03:36.
2023-02-09 21:27:47,218 | INFO | Epoch 1 : 
            Train_acc : 0.8684619092761255
            Train_precision (macro, micro): [0.68263343 0.86846191]
            Train_recall  (macro, micro): [0.5285572  0.86846191]
            Train_F1 : [0.51791272 0.86846191]
2023-02-09 21:27:47,219 | DEBUG | 
2023-02-09 21:27:47,219 | INFO |   Average training loss: 0.41
2023-02-09 21:27:47,219 | INFO |   Training epoch took: 0:03:50
2023-02-09 21:27:47,235 | INFO | Classification report. TRAINING at epoch 1 
               precision    recall  f1-score   support

           0       0.89      0.98      0.93      8836
           1       0.66      0.20      0.31      1372

    accuracy                           0.88     10208
   macro avg       0.78      0.59      0.62     10208
weighted avg       0.86      0.88      0.85     10208

2023-02-09 21:27:47,235 | DEBUG | 
2023-02-09 21:27:47,235 | INFO | Running Validation...
2023-02-09 21:27:55,137 | INFO | Epoch 1 : 
                Valid_acc : 0.9082213294090368
                Valid_precision (macro, micro): [0.78736097 0.90822133]
                Valid_recall (macro, micro): [0.80491559 0.90822133]
                Valid_F1 (macro, micro): [0.7948261  0.90822133]
2023-02-09 21:27:55,137 | INFO |   Accuracy: 0.91
2023-02-09 21:27:55,137 | INFO |   Validation Loss: 0.23
2023-02-09 21:27:55,138 | INFO |   Validation took: 0:00:08
2023-02-09 21:27:55,142 | INFO | Classification report. VALIDATION at epoch 1 
               precision    recall  f1-score   support

           0       0.95      0.94      0.95       982
           1       0.64      0.69      0.66       153

    accuracy                           0.91      1135
   macro avg       0.80      0.81      0.80      1135
weighted avg       0.91      0.91      0.91      1135

2023-02-09 21:27:55,143 | DEBUG | 
2023-02-09 21:27:55,143 | INFO | ======== Epoch 2 / 4 ========
2023-02-09 21:27:55,143 | INFO | Training...
2023-02-09 21:29:05,907 | DEBUG |   Batch   100  of    319.    Elapsed: 0:01:11.
2023-02-09 21:30:18,079 | DEBUG |   Batch   200  of    319.    Elapsed: 0:02:23.
2023-02-09 21:31:31,712 | DEBUG |   Batch   300  of    319.    Elapsed: 0:03:37.
2023-02-09 21:31:45,891 | INFO | Epoch 2 : 
            Train_acc : 0.9172715941411288
            Train_precision (macro, micro): [0.8279053  0.91727159]
            Train_recall  (macro, micro): [0.78219411 0.91727159]
            Train_F1 : [0.802256   0.91727159]
2023-02-09 21:31:45,891 | DEBUG | 
2023-02-09 21:31:45,891 | INFO |   Average training loss: 0.32
2023-02-09 21:31:45,892 | INFO |   Training epoch took: 0:03:51
2023-02-09 21:31:45,909 | INFO | Classification report. TRAINING at epoch 2 
               precision    recall  f1-score   support

           0       0.95      0.96      0.96      8836
           1       0.74      0.65      0.69      1372

    accuracy                           0.92     10208
   macro avg       0.84      0.81      0.82     10208
weighted avg       0.92      0.92      0.92     10208

2023-02-09 21:31:45,909 | DEBUG | 
2023-02-09 21:31:45,909 | INFO | Running Validation...
2023-02-09 21:31:53,822 | INFO | Epoch 2 : 
                Valid_acc : 0.9301069000435026
                Valid_precision (macro, micro): [0.86765179 0.9301069 ]
                Valid_recall (macro, micro): [0.82784752 0.9301069 ]
                Valid_F1 (macro, micro): [0.84473197 0.9301069 ]
2023-02-09 21:31:53,823 | INFO |   Accuracy: 0.93
2023-02-09 21:31:53,823 | INFO |   Validation Loss: 0.20
2023-02-09 21:31:53,823 | INFO |   Validation took: 0:00:08
2023-02-09 21:31:53,827 | INFO | Classification report. VALIDATION at epoch 2 
               precision    recall  f1-score   support

           0       0.95      0.97      0.96       982
           1       0.77      0.69      0.73       153

    accuracy                           0.93      1135
   macro avg       0.86      0.83      0.85      1135
weighted avg       0.93      0.93      0.93      1135

2023-02-09 21:31:53,828 | DEBUG | 
2023-02-09 21:31:53,828 | INFO | ======== Epoch 3 / 4 ========
2023-02-09 21:31:53,829 | INFO | Training...
2023-02-09 21:33:04,559 | DEBUG |   Batch   100  of    319.    Elapsed: 0:01:11.
2023-02-09 21:34:16,663 | DEBUG |   Batch   200  of    319.    Elapsed: 0:02:23.
2023-02-09 21:35:30,358 | DEBUG |   Batch   300  of    319.    Elapsed: 0:03:37.
2023-02-09 21:35:44,503 | INFO | Epoch 3 : 
            Train_acc : 0.9483273127002603
            Train_precision (macro, micro): [0.89865368 0.94832731]
            Train_recall  (macro, micro): [0.87746234 0.94832731]
            Train_F1 : [0.88753072 0.94832731]
2023-02-09 21:35:44,503 | DEBUG | 
2023-02-09 21:35:44,503 | INFO |   Average training loss: 0.28
2023-02-09 21:35:44,504 | INFO |   Training epoch took: 0:03:51
2023-02-09 21:35:44,520 | INFO | Classification report. TRAINING at epoch 3 
               precision    recall  f1-score   support

           0       0.97      0.98      0.97      8836
           1       0.83      0.78      0.81      1372

    accuracy                           0.95     10208
   macro avg       0.90      0.88      0.89     10208
weighted avg       0.95      0.95      0.95     10208

2023-02-09 21:35:44,520 | DEBUG | 
2023-02-09 21:35:44,521 | INFO | Running Validation...
2023-02-09 21:35:52,426 | INFO | Epoch 3 : 
                Valid_acc : 0.9411051929830241
                Valid_precision (macro, micro): [0.87031453 0.94110519]
                Valid_recall (macro, micro): [0.87869728 0.94110519]
                Valid_F1 (macro, micro): [0.87355069 0.94110519]
2023-02-09 21:35:52,427 | INFO |   Accuracy: 0.93
2023-02-09 21:35:52,427 | INFO |   Validation Loss: 0.20
2023-02-09 21:35:52,427 | INFO |   Validation took: 0:00:08
2023-02-09 21:35:52,432 | INFO | Classification report. VALIDATION at epoch 3 
               precision    recall  f1-score   support

           0       0.96      0.96      0.96       982
           1       0.76      0.74      0.75       153

    accuracy                           0.93      1135
   macro avg       0.86      0.85      0.85      1135
weighted avg       0.93      0.93      0.93      1135

2023-02-09 21:35:52,433 | DEBUG | 
2023-02-09 21:35:52,433 | INFO | ======== Epoch 4 / 4 ========
2023-02-09 21:35:52,433 | INFO | Training...
2023-02-09 21:37:03,143 | DEBUG |   Batch   100  of    319.    Elapsed: 0:01:11.
2023-02-09 21:38:15,274 | DEBUG |   Batch   200  of    319.    Elapsed: 0:02:23.
2023-02-09 21:39:28,893 | DEBUG |   Batch   300  of    319.    Elapsed: 0:03:36.
2023-02-09 21:39:43,025 | INFO | Epoch 4 : 
            Train_acc : 0.9731394584562955
            Train_precision (macro, micro): [0.94705849 0.97313946]
            Train_recall  (macro, micro): [0.9368907  0.97313946]
            Train_F1 : [0.9417951  0.97313946]
2023-02-09 21:39:43,026 | DEBUG | 
2023-02-09 21:39:43,026 | INFO |   Average training loss: 0.25
2023-02-09 21:39:43,026 | INFO |   Training epoch took: 0:03:51
2023-02-09 21:39:43,043 | INFO | Classification report. TRAINING at epoch 4 
               precision    recall  f1-score   support

           0       0.98      0.99      0.98      8836
           1       0.91      0.89      0.90      1372

    accuracy                           0.97     10208
   macro avg       0.94      0.94      0.94     10208
weighted avg       0.97      0.97      0.97     10208

2023-02-09 21:39:43,043 | DEBUG | 
2023-02-09 21:39:43,043 | INFO | Running Validation...
2023-02-09 21:39:50,939 | INFO | Epoch 4 : 
                Valid_acc : 0.9324396884314949
                Valid_precision (macro, micro): [0.84859314 0.93243969]
                Valid_recall (macro, micro): [0.83098702 0.93243969]
                Valid_F1 (macro, micro): [0.83922849 0.93243969]
2023-02-09 21:39:50,939 | INFO |   Accuracy: 0.93
2023-02-09 21:39:50,939 | INFO |   Validation Loss: 0.21
2023-02-09 21:39:50,939 | INFO |   Validation took: 0:00:08
2023-02-09 21:39:50,944 | INFO | Classification report. VALIDATION at epoch 4 
               precision    recall  f1-score   support

           0       0.95      0.97      0.96       982
           1       0.76      0.69      0.72       153

    accuracy                           0.93      1135
   macro avg       0.85      0.83      0.84      1135
weighted avg       0.93      0.93      0.93      1135

2023-02-09 21:39:50,944 | DEBUG | 
2023-02-09 21:39:50,945 | INFO | Training complete!
2023-02-09 21:39:50,945 | INFO | Total training took 0:15:54 (h:mm:ss)
2023-02-09 21:39:50,976 | DEBUG | ====================================================================================================
2023-02-09 21:39:50,977 | DEBUG | ********************************************************************************
2023-02-09 21:39:50,977 | DEBUG | Iteration: 5/8
2023-02-09 21:39:50,977 | INFO | [{'epoch': 1, 'Training Loss': 0.4122342991884973, 'Training Accur.': 0.8684619092761255, 'Training Precision (macro)': 0.6826334290300464, 'Training Precision (micro)': 0.8684619092761255, 'Training Recall (macro)': 0.5285572049740369, 'Training Recall (micro)': 0.8684619092761255, 'Training F1 (macro)': 0.5179127194568053, 'Training F1 (micro)': 0.8684619092761255, 'Valid. Loss': 0.23100008629262447, 'Valid. Accur.': 0.905150462962963, 'Valid. Precision (macro)': 0.7873609713613579, 'Valid. Precision (micro)': 0.9082213294090368, 'Valid. Recall (macro)': 0.8049155906404748, 'Valid. Recall (micro)': 0.9082213294090368, 'Valid. F1 (macro)': 0.7948261046777619, 'Valid. F1 (micro)': 0.9082213294090368, 'Training Time': '0:03:50', 'Validation Time': '0:00:08'}, {'epoch': 2, 'Training Loss': 0.32003046717015926, 'Training Accur.': 0.9172715941411288, 'Training Precision (macro)': 0.8279052957978164, 'Training Precision (micro)': 0.9172715941411288, 'Training Recall (macro)': 0.7821941104684383, 'Training Recall (micro)': 0.9172715941411288, 'Training F1 (macro)': 0.802256004240298, 'Training F1 (micro)': 0.9172715941411288, 'Valid. Loss': 0.19888462560872236, 'Valid. Accur.': 0.9322916666666666, 'Valid. Precision (macro)': 0.8676517923886999, 'Valid. Precision (micro)': 0.9301069000435026, 'Valid. Recall (macro)': 0.8278475239442254, 'Valid. Recall (micro)': 0.9301069000435026, 'Valid. F1 (macro)': 0.8447319666632324, 'Valid. F1 (micro)': 0.9301069000435026, 'Training Time': '0:03:51', 'Validation Time': '0:00:08'}, {'epoch': 3, 'Training Loss': 0.28086769580841064, 'Training Accur.': 0.9483273127002603, 'Training Precision (macro)': 0.8986536800449052, 'Training Precision (micro)': 0.9483273127002603, 'Training Recall (macro)': 0.8774623433944109, 'Training Recall (micro)': 0.9483273127002603, 'Training F1 (macro)': 0.8875307248061566, 'Training F1 (micro)': 0.9483273127002603, 'Valid. Loss': 0.1967412723849217, 'Valid. Accur.': 0.9330439814814814, 'Valid. Precision (macro)': 0.8703145345652412, 'Valid. Precision (micro)': 0.9411051929830241, 'Valid. Recall (macro)': 0.8786972812159042, 'Valid. Recall (micro)': 0.9411051929830241, 'Valid. F1 (macro)': 0.8735506948101448, 'Valid. F1 (micro)': 0.9411051929830241, 'Training Time': '0:03:51', 'Validation Time': '0:00:08'}, {'epoch': 4, 'Training Loss': 0.24790631220632212, 'Training Accur.': 0.9731394584562955, 'Training Precision (macro)': 0.9470584902795167, 'Training Precision (micro)': 0.9731394584562955, 'Training Recall (macro)': 0.9368907017240975, 'Training Recall (micro)': 0.9731394584562955, 'Training F1 (macro)': 0.9417950955103875, 'Training F1 (micro)': 0.9731394584562955, 'Valid. Loss': 0.2050193753093481, 'Valid. Accur.': 0.9287037037037036, 'Valid. Precision (macro)': 0.8485931419670071, 'Valid. Precision (micro)': 0.9324396884314949, 'Valid. Recall (macro)': 0.8309870233639404, 'Valid. Recall (micro)': 0.9324396884314949, 'Valid. F1 (macro)': 0.8392284896069283, 'Valid. F1 (micro)': 0.9324396884314949, 'Training Time': '0:03:51', 'Validation Time': '0:00:08'}]
2023-02-09 21:39:50,978 | DEBUG | ********************************************************************************
2023-02-09 21:39:50,978 | DEBUG | ====================================================================================================
2023-02-09 21:39:50,978 | INFO | To execute testing of the model on test_data
2023-02-09 21:39:50,978 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-02-09 21:39:50,978 | INFO | 	 1 - NVIDIA A100-SXM4-40GB
2023-02-09 21:39:50,978 | DEBUG | Running Testing...
2023-02-09 21:39:55,106 | INFO | 
        Test_acc : 0.9474364175607123
        Test_precision (macro, micro): [0.89042719 0.94743642]
        Test_recall (macro, micro): [0.87229255 0.94743642]
        Test_F1 (macro, micro): [0.88042361 0.94743642]
2023-02-09 21:39:55,106 | INFO |   Accuracy: 0.94
2023-02-09 21:39:55,107 | INFO |   Test Loss: 0.17
2023-02-09 21:39:55,107 | INFO |   Test took: 0:00:04
2023-02-09 21:39:55,110 | INFO | Classification report. TEST 
               precision    recall  f1-score   support

           0       0.96      0.97      0.97       517
           1       0.82      0.74      0.78        80

    accuracy                           0.94       597
   macro avg       0.89      0.86      0.87       597
weighted avg       0.94      0.94      0.94       597

2023-02-09 21:39:55,121 | DEBUG | {'general_set_up': {'dataset_filename': '20230207_Dataset_GTC_FINAL_Witnesses.xlsx', 'input_dir_name': 'input', 'output_dir_name': 'output', 'dataset_dir_name': 'dataset', 'logs_dir_name': 'logs', 'models_dir_name': 'models', 'plots_dir_name': 'plots'}, 'dataset': {'index_columns_dataset': 1, 'list_columns_names': ['tribunal', 'id_transcript', 'case', 'accused', 'date', 'text', 'trauma', 'role', 'witnesses', 'n_witnesses', 'start', 'id_annotation', 'id_document'], 'col_of_interest_binary_classif': 'trauma', 'col_of_interest_multi_label_classif': 'role', 'col_of_reference_binary_classif': 'text', 'col_of_reference_multi_label_classif': 'text'}, 'models': {'bert': ['bert-base-uncased', 'nlpaueb/legal-bert-base-uncased'], 'other': ['snowood1/ConfliBERT-scr-uncased', 'GroNLP/hateBERT']}, 'training_model': {'model_name': 'bert-base-uncased', 'epochs': 4, 'batch_size': 32, 'embedding_size': 512, 'return_attention_mask': True, 'cross_validation': False, 'save_model': True, 'store_statistics': True, 'test_model': True, 'add_special_tokes': True, 'max_length': 512, 'pad_to_max_length': True, 'run_in_gpu': True, 'classification_task': 'binary', 'learning_rate': '1e-6', 'epsilon_optimizer': '1e-8', 'weight_decay': 0}, 'active_training': {'size_splits_dataset': 8, 'classification_task': 'binary'}}
2023-02-09 21:39:55,122 | DEBUG | Num of different classes in the dataset is 2 which are:
2023-02-09 21:39:55,122 | DEBUG | 	 1 - 0
2023-02-09 21:39:55,123 | DEBUG | 	 2 - 1
2023-02-09 21:39:55,123 | WARNING | 0    12402
1     1926
Name: trauma, dtype: int64
2023-02-09 21:39:55,124 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-02-09 21:39:55,124 | INFO | 	 1 - NVIDIA A100-SXM4-40GB
2023-02-09 21:39:55,124 | DEBUG | 

==> Selected device is 'cuda' <==
2023-02-09 21:39:55,124 | DEBUG | Loading tokenizer... [ID:bert];[Name:bert-base-uncased]
2023-02-09 21:39:55,309 | INFO | bert tokenizer was loaded successfully (bert-base-uncased)
	do_lower_case=True
2023-02-09 21:40:05,728 | INFO | Max sentence length: 347 found at index 3164. Sentence is:


A.   It wasn't a short -- it was a short journey, two and a half kilometres approximately.  We climbed a hill.  We heard bursts of gunfire. When we reached the place where there was gunfire, the buses stopped and as soon as they stopped, the doors would open.  Serbian soldiers gathered round the buses.  Said -- and they were cursing our mothers and us, and Haris Silajdzic's mother as well.  They said, "They don't want you.  Get out of the bus."  And then death -- you could see death in their eyes. Until that point, you feel you never knew what was going, because they would say one thing, do another, and they started -- people started emerging from the buses and after the buses were half empty, they would stop people from disembarking. I was still on the bus and was looking at what was going on.  They took the people down a path in the field, there are dead people, bursts of gunfire would cut people down.  People fell dead to the ground.  When this was finished, they would come back.  I emerged from the bus.  There were cursing, "Fuck your mother and Alija and Haris."  "They don't want you."  "Get out of the bus." "Come here."  And you reckon there are still a couple of seconds of life left.  When everybody disembarked from the buses with their hands tied, including me, we formed a column and there were dead people in the column, there were dead people on the path, you could see them lying on the ground.  They didn't even reach the execution site.



2023-02-09 21:40:18,764 | INFO | 
CORPUS TRAINING AND VALIDATION: 
            
	 Length labels 13611
            
	 Length input_ids 13611
            
	 Length attention_masks 13611
            

2023-02-09 21:40:18,765 | INFO | 
	CORPUS TRAINING:  
            
		 Length labels 12249
            
		 Length input_ids 12249
            
		 Length attention_masks 12249
2023-02-09 21:40:18,765 | INFO | 
	CORPUS VALIDATION: 
            
		 Length labels 1362
            
		 Length input_ids 1362
            
		 Length attention_masks 1362
2023-02-09 21:40:18,765 | INFO | 
2023-02-09 21:40:18,765 | INFO | 
CORPUS TEST: 
            
	 Length labels 717
            
	 Length input_ids 717
            
	 Length attention_masks 717
            

2023-02-09 21:40:20,174 | DEBUG | Optimizer
2023-02-09 21:40:20,174 | DEBUG | AdamW (
Parameter Group 0
    betas: (0.9, 0.999)
    correct_bias: True
    eps: 1e-08
    lr: 1e-06
    weight_decay: 0.0
)
2023-02-09 21:40:20,175 | DEBUG | 
2023-02-09 21:40:20,175 | INFO | ======== Epoch 1 / 4 ========
2023-02-09 21:40:20,176 | INFO | Training...
2023-02-09 21:41:30,887 | DEBUG |   Batch   100  of    383.    Elapsed: 0:01:11.
2023-02-09 21:42:42,901 | DEBUG |   Batch   200  of    383.    Elapsed: 0:02:23.
2023-02-09 21:43:56,413 | DEBUG |   Batch   300  of    383.    Elapsed: 0:03:36.
2023-02-09 21:44:58,435 | INFO | Epoch 1 : 
            Train_acc : 0.8673256944518788
            Train_precision (macro, micro): [0.64110552 0.86732569]
            Train_recall  (macro, micro): [0.53900084 0.86732569]
            Train_F1 : [0.53386072 0.86732569]
2023-02-09 21:44:58,435 | DEBUG | 
2023-02-09 21:44:58,436 | INFO |   Average training loss: 0.40
2023-02-09 21:44:58,436 | INFO |   Training epoch took: 0:04:38
2023-02-09 21:44:58,453 | INFO | Classification report. TRAINING at epoch 1 
               precision    recall  f1-score   support

           0       0.90      0.98      0.94     10602
           1       0.71      0.27      0.39      1647

    accuracy                           0.89     12249
   macro avg       0.80      0.63      0.66     12249
weighted avg       0.87      0.89      0.86     12249

2023-02-09 21:44:58,453 | DEBUG | 
2023-02-09 21:44:58,454 | INFO | Running Validation...
2023-02-09 21:45:07,970 | INFO | Epoch 1 : 
                Valid_acc : 0.9194298745829991
                Valid_precision (macro, micro): [0.82048957 0.91942987]
                Valid_recall (macro, micro): [0.84395948 0.91942987]
                Valid_F1 (macro, micro): [0.83142186 0.91942987]
2023-02-09 21:45:07,971 | INFO |   Accuracy: 0.92
2023-02-09 21:45:07,971 | INFO |   Validation Loss: 0.22
2023-02-09 21:45:07,971 | INFO |   Validation took: 0:00:10
2023-02-09 21:45:07,976 | INFO | Classification report. VALIDATION at epoch 1 
               precision    recall  f1-score   support

           0       0.96      0.95      0.96      1179
           1       0.70      0.74      0.72       183

    accuracy                           0.92      1362
   macro avg       0.83      0.85      0.84      1362
weighted avg       0.92      0.92      0.92      1362

2023-02-09 21:45:07,977 | DEBUG | 
2023-02-09 21:45:07,977 | INFO | ======== Epoch 2 / 4 ========
2023-02-09 21:45:07,977 | INFO | Training...
2023-02-09 21:46:18,666 | DEBUG |   Batch   100  of    383.    Elapsed: 0:01:11.
2023-02-09 21:47:30,839 | DEBUG |   Batch   200  of    383.    Elapsed: 0:02:23.
2023-02-09 21:48:44,549 | DEBUG |   Batch   300  of    383.    Elapsed: 0:03:37.
2023-02-09 21:49:46,757 | INFO | Epoch 2 : 
            Train_acc : 0.9232114616862614
            Train_precision (macro, micro): [0.84828772 0.92321146]
            Train_recall  (macro, micro): [0.8212684  0.92321146]
            Train_F1 : [0.83385832 0.92321146]
2023-02-09 21:49:46,757 | DEBUG | 
2023-02-09 21:49:46,757 | INFO |   Average training loss: 0.31
2023-02-09 21:49:46,758 | INFO |   Training epoch took: 0:04:39
2023-02-09 21:49:46,777 | INFO | Classification report. TRAINING at epoch 2 
               precision    recall  f1-score   support

           0       0.95      0.96      0.96     10602
           1       0.74      0.68      0.71      1647

    accuracy                           0.92     12249
   macro avg       0.84      0.82      0.83     12249
weighted avg       0.92      0.92      0.92     12249

2023-02-09 21:49:46,777 | DEBUG | 
2023-02-09 21:49:46,777 | INFO | Running Validation...
2023-02-09 21:49:56,294 | INFO | Epoch 2 : 
                Valid_acc : 0.9209562170440182
                Valid_precision (macro, micro): [0.86316812 0.92095622]
                Valid_recall (macro, micro): [0.78641106 0.92095622]
                Valid_F1 (macro, micro): [0.81766943 0.92095622]
2023-02-09 21:49:56,295 | INFO |   Accuracy: 0.93
2023-02-09 21:49:56,295 | INFO |   Validation Loss: 0.19
2023-02-09 21:49:56,295 | INFO |   Validation took: 0:00:10
2023-02-09 21:49:56,300 | INFO | Classification report. VALIDATION at epoch 2 
               precision    recall  f1-score   support

           0       0.95      0.97      0.96      1179
           1       0.79      0.64      0.71       183

    accuracy                           0.93      1362
   macro avg       0.87      0.81      0.83      1362
weighted avg       0.92      0.93      0.93      1362

2023-02-09 21:49:56,301 | DEBUG | 
2023-02-09 21:49:56,301 | INFO | ======== Epoch 3 / 4 ========
2023-02-09 21:49:56,301 | INFO | Training...
2023-02-09 21:51:07,040 | DEBUG |   Batch   100  of    383.    Elapsed: 0:01:11.
2023-02-09 21:52:19,135 | DEBUG |   Batch   200  of    383.    Elapsed: 0:02:23.
2023-02-09 21:53:32,699 | DEBUG |   Batch   300  of    383.    Elapsed: 0:03:36.
2023-02-09 21:54:34,874 | INFO | Epoch 3 : 
            Train_acc : 0.955769440405509
            Train_precision (macro, micro): [0.90980361 0.95576944]
            Train_recall  (macro, micro): [0.89539748 0.95576944]
            Train_F1 : [0.9022677  0.95576944]
2023-02-09 21:54:34,878 | DEBUG | 
2023-02-09 21:54:34,878 | INFO |   Average training loss: 0.28
2023-02-09 21:54:34,878 | INFO |   Training epoch took: 0:04:39
2023-02-09 21:54:34,897 | INFO | Classification report. TRAINING at epoch 3 
               precision    recall  f1-score   support

           0       0.97      0.98      0.97     10602
           1       0.84      0.82      0.83      1647

    accuracy                           0.95     12249
   macro avg       0.91      0.90      0.90     12249
weighted avg       0.95      0.95      0.95     12249

2023-02-09 21:54:34,898 | DEBUG | 
2023-02-09 21:54:34,898 | INFO | Running Validation...
2023-02-09 21:54:44,416 | INFO | Epoch 3 : 
                Valid_acc : 0.9347932439528456
                Valid_precision (macro, micro): [0.88208582 0.93479324]
                Valid_recall (macro, micro): [0.83542805 0.93479324]
                Valid_F1 (macro, micro): [0.8560587  0.93479324]
2023-02-09 21:54:44,416 | INFO |   Accuracy: 0.93
2023-02-09 21:54:44,417 | INFO |   Validation Loss: 0.18
2023-02-09 21:54:44,417 | INFO |   Validation took: 0:00:10
2023-02-09 21:54:44,422 | INFO | Classification report. VALIDATION at epoch 3 
               precision    recall  f1-score   support

           0       0.95      0.97      0.96      1179
           1       0.76      0.70      0.73       183

    accuracy                           0.93      1362
   macro avg       0.86      0.84      0.85      1362
weighted avg       0.93      0.93      0.93      1362

2023-02-09 21:54:44,422 | DEBUG | 
2023-02-09 21:54:44,423 | INFO | ======== Epoch 4 / 4 ========
2023-02-09 21:54:44,423 | INFO | Training...
2023-02-09 21:55:55,213 | DEBUG |   Batch   100  of    383.    Elapsed: 0:01:11.
2023-02-09 21:57:07,373 | DEBUG |   Batch   200  of    383.    Elapsed: 0:02:23.
2023-02-09 21:58:21,106 | DEBUG |   Batch   300  of    383.    Elapsed: 0:03:37.
2023-02-09 21:59:23,321 | INFO | Epoch 4 : 
            Train_acc : 0.9696111438474878
            Train_precision (macro, micro): [0.9427913  0.96961114]
            Train_recall  (macro, micro): [0.9270079  0.96961114]
            Train_F1 : [0.93467613 0.96961114]
2023-02-09 21:59:23,322 | DEBUG | 
2023-02-09 21:59:23,322 | INFO |   Average training loss: 0.25
2023-02-09 21:59:23,322 | INFO |   Training epoch took: 0:04:39
2023-02-09 21:59:23,342 | INFO | Classification report. TRAINING at epoch 4 
               precision    recall  f1-score   support

           0       0.98      0.99      0.98     10602
           1       0.90      0.86      0.88      1647

    accuracy                           0.97     12249
   macro avg       0.94      0.92      0.93     12249
weighted avg       0.97      0.97      0.97     12249

2023-02-09 21:59:23,342 | DEBUG | 
2023-02-09 21:59:23,342 | INFO | Running Validation...
2023-02-09 21:59:32,857 | INFO | Epoch 4 : 
                Valid_acc : 0.9354743228944311
                Valid_precision (macro, micro): [0.88049211 0.93547432]
                Valid_recall (macro, micro): [0.84511449 0.93547432]
                Valid_F1 (macro, micro): [0.85831674 0.93547432]
2023-02-09 21:59:32,858 | INFO |   Accuracy: 0.93
2023-02-09 21:59:32,858 | INFO |   Validation Loss: 0.18
2023-02-09 21:59:32,858 | INFO |   Validation took: 0:00:10
2023-02-09 21:59:32,863 | INFO | Classification report. VALIDATION at epoch 4 
               precision    recall  f1-score   support

           0       0.96      0.96      0.96      1179
           1       0.76      0.76      0.76       183

    accuracy                           0.93      1362
   macro avg       0.86      0.86      0.86      1362
weighted avg       0.93      0.93      0.93      1362

2023-02-09 21:59:32,864 | DEBUG | 
2023-02-09 21:59:32,864 | INFO | Training complete!
2023-02-09 21:59:32,864 | INFO | Total training took 0:19:13 (h:mm:ss)
2023-02-09 21:59:32,902 | DEBUG | ====================================================================================================
2023-02-09 21:59:32,903 | DEBUG | ********************************************************************************
2023-02-09 21:59:32,903 | DEBUG | Iteration: 6/8
2023-02-09 21:59:32,903 | INFO | [{'epoch': 1, 'Training Loss': 0.4007193451217198, 'Training Accur.': 0.8673256944518788, 'Training Precision (macro)': 0.6411055238093191, 'Training Precision (micro)': 0.8673256944518788, 'Training Recall (macro)': 0.5390008359797785, 'Training Recall (micro)': 0.8673256944518788, 'Training F1 (macro)': 0.5338607220193624, 'Training F1 (micro)': 0.8673256944518788, 'Valid. Loss': 0.21955351756755695, 'Valid. Accur.': 0.9219961240310078, 'Valid. Precision (macro)': 0.820489571319816, 'Valid. Precision (micro)': 0.9194298745829991, 'Valid. Recall (macro)': 0.8439594842617707, 'Valid. Recall (micro)': 0.9194298745829991, 'Valid. F1 (macro)': 0.8314218644693822, 'Valid. F1 (micro)': 0.9194298745829991, 'Training Time': '0:04:38', 'Validation Time': '0:00:10'}, {'epoch': 2, 'Training Loss': 0.3136022583856284, 'Training Accur.': 0.9232114616862614, 'Training Precision (macro)': 0.8482877208044766, 'Training Precision (micro)': 0.9232114616862614, 'Training Recall (macro)': 0.8212683952783647, 'Training Recall (micro)': 0.9232114616862614, 'Training F1 (macro)': 0.8338583248361152, 'Training F1 (micro)': 0.9232114616862614, 'Valid. Loss': 0.191273998035941, 'Valid. Accur.': 0.9289405684754521, 'Valid. Precision (macro)': 0.8631681170292295, 'Valid. Precision (micro)': 0.9209562170440182, 'Valid. Recall (macro)': 0.7864110616628723, 'Valid. Recall (micro)': 0.9209562170440182, 'Valid. F1 (macro)': 0.8176694335147698, 'Valid. F1 (micro)': 0.9209562170440182, 'Training Time': '0:04:39', 'Validation Time': '0:00:10'}, {'epoch': 3, 'Training Loss': 0.27524258071853347, 'Training Accur.': 0.955769440405509, 'Training Precision (macro)': 0.9098036095854214, 'Training Precision (micro)': 0.955769440405509, 'Training Recall (macro)': 0.8953974822315199, 'Training Recall (micro)': 0.955769440405509, 'Training F1 (macro)': 0.9022676974825591, 'Training F1 (micro)': 0.955769440405509, 'Valid. Loss': 0.18431142804234527, 'Valid. Accur.': 0.9311208010335917, 'Valid. Precision (macro)': 0.8820858169143349, 'Valid. Precision (micro)': 0.9347932439528456, 'Valid. Recall (macro)': 0.8354280504357803, 'Valid. Recall (micro)': 0.9347932439528456, 'Valid. F1 (macro)': 0.8560587010499978, 'Valid. F1 (micro)': 0.9347932439528456, 'Training Time': '0:04:39', 'Validation Time': '0:00:10'}, {'epoch': 4, 'Training Loss': 0.25485681028496815, 'Training Accur.': 0.9696111438474878, 'Training Precision (macro)': 0.9427913008776687, 'Training Precision (micro)': 0.9696111438474878, 'Training Recall (macro)': 0.9270079045563872, 'Training Recall (micro)': 0.9696111438474878, 'Training F1 (macro)': 0.9346761311205813, 'Training F1 (micro)': 0.9696111438474878, 'Valid. Loss': 0.1830446143136468, 'Valid. Accur.': 0.9341892764857881, 'Valid. Precision (macro)': 0.8804921123005687, 'Valid. Precision (micro)': 0.9354743228944311, 'Valid. Recall (macro)': 0.8451144886263412, 'Valid. Recall (micro)': 0.9354743228944311, 'Valid. F1 (macro)': 0.858316737693271, 'Valid. F1 (micro)': 0.9354743228944311, 'Training Time': '0:04:39', 'Validation Time': '0:00:10'}]
2023-02-09 21:59:32,904 | DEBUG | ********************************************************************************
2023-02-09 21:59:32,904 | DEBUG | ====================================================================================================
2023-02-09 21:59:32,904 | INFO | To execute testing of the model on test_data
2023-02-09 21:59:32,904 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-02-09 21:59:32,904 | INFO | 	 1 - NVIDIA A100-SXM4-40GB
2023-02-09 21:59:32,905 | DEBUG | Running Testing...
2023-02-09 21:59:37,879 | INFO | 
        Test_acc : 0.9359886935380165
        Test_precision (macro, micro): [0.85582116 0.93598869]
        Test_recall (macro, micro): [0.82941445 0.93598869]
        Test_F1 (macro, micro): [0.84162186 0.93598869]
2023-02-09 21:59:37,879 | INFO |   Accuracy: 0.94
2023-02-09 21:59:37,879 | INFO |   Test Loss: 0.18
2023-02-09 21:59:37,880 | INFO |   Test took: 0:00:05
2023-02-09 21:59:37,883 | INFO | Classification report. TEST 
               precision    recall  f1-score   support

           0       0.96      0.97      0.97       621
           1       0.79      0.77      0.78        96

    accuracy                           0.94       717
   macro avg       0.88      0.87      0.87       717
weighted avg       0.94      0.94      0.94       717

2023-02-09 21:59:37,897 | DEBUG | {'general_set_up': {'dataset_filename': '20230207_Dataset_GTC_FINAL_Witnesses.xlsx', 'input_dir_name': 'input', 'output_dir_name': 'output', 'dataset_dir_name': 'dataset', 'logs_dir_name': 'logs', 'models_dir_name': 'models', 'plots_dir_name': 'plots'}, 'dataset': {'index_columns_dataset': 1, 'list_columns_names': ['tribunal', 'id_transcript', 'case', 'accused', 'date', 'text', 'trauma', 'role', 'witnesses', 'n_witnesses', 'start', 'id_annotation', 'id_document'], 'col_of_interest_binary_classif': 'trauma', 'col_of_interest_multi_label_classif': 'role', 'col_of_reference_binary_classif': 'text', 'col_of_reference_multi_label_classif': 'text'}, 'models': {'bert': ['bert-base-uncased', 'nlpaueb/legal-bert-base-uncased'], 'other': ['snowood1/ConfliBERT-scr-uncased', 'GroNLP/hateBERT']}, 'training_model': {'model_name': 'bert-base-uncased', 'epochs': 4, 'batch_size': 32, 'embedding_size': 512, 'return_attention_mask': True, 'cross_validation': False, 'save_model': True, 'store_statistics': True, 'test_model': True, 'add_special_tokes': True, 'max_length': 512, 'pad_to_max_length': True, 'run_in_gpu': True, 'classification_task': 'binary', 'learning_rate': '1e-6', 'epsilon_optimizer': '1e-8', 'weight_decay': 0}, 'active_training': {'size_splits_dataset': 8, 'classification_task': 'binary'}}
2023-02-09 21:59:37,898 | DEBUG | Num of different classes in the dataset is 2 which are:
2023-02-09 21:59:37,898 | DEBUG | 	 1 - 0
2023-02-09 21:59:37,898 | DEBUG | 	 2 - 1
2023-02-09 21:59:37,898 | WARNING | 0    14469
1     2247
Name: trauma, dtype: int64
2023-02-09 21:59:37,899 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-02-09 21:59:37,899 | INFO | 	 1 - NVIDIA A100-SXM4-40GB
2023-02-09 21:59:37,900 | DEBUG | 

==> Selected device is 'cuda' <==
2023-02-09 21:59:37,900 | DEBUG | Loading tokenizer... [ID:bert];[Name:bert-base-uncased]
2023-02-09 21:59:38,081 | INFO | bert tokenizer was loaded successfully (bert-base-uncased)
	do_lower_case=True
2023-02-09 21:59:50,165 | INFO | Max sentence length: 467 found at index 16466. Sentence is:


So we thought we would have been spared because Father Munyeshyaka had forcefully kissed Hyacinthe, and Hyacinthe had come back crying.  And I told her that maybe the priest felt guilty and wanted to help her.  So *********************** and I told her that probably, on the next day, we would finally be saved. ************************************************************************ ********************** ************************************************************************ ********************************************* And the following day, in the morning, it is that list that they used to put people to death -- that list we ********************************.  But when they went out, I saw Father Munyeshyaka with that list in his hand and I recognised the sheet of paper, **************************************************************, and it is with that list that the Interahamwe killed people.



2023-02-09 22:00:05,461 | INFO | 
CORPUS TRAINING AND VALIDATION: 
            
	 Length labels 15880
            
	 Length input_ids 15880
            
	 Length attention_masks 15880
            

2023-02-09 22:00:05,462 | INFO | 
	CORPUS TRAINING:  
            
		 Length labels 14292
            
		 Length input_ids 14292
            
		 Length attention_masks 14292
2023-02-09 22:00:05,462 | INFO | 
	CORPUS VALIDATION: 
            
		 Length labels 1588
            
		 Length input_ids 1588
            
		 Length attention_masks 1588
2023-02-09 22:00:05,462 | INFO | 
2023-02-09 22:00:05,462 | INFO | 
CORPUS TEST: 
            
	 Length labels 836
            
	 Length input_ids 836
            
	 Length attention_masks 836
            

2023-02-09 22:00:06,864 | DEBUG | Optimizer
2023-02-09 22:00:06,865 | DEBUG | AdamW (
Parameter Group 0
    betas: (0.9, 0.999)
    correct_bias: True
    eps: 1e-08
    lr: 1e-06
    weight_decay: 0.0
)
2023-02-09 22:00:06,865 | DEBUG | 
2023-02-09 22:00:06,866 | INFO | ======== Epoch 1 / 4 ========
2023-02-09 22:00:06,866 | INFO | Training...
2023-02-09 22:01:17,644 | DEBUG |   Batch   100  of    447.    Elapsed: 0:01:11.
2023-02-09 22:02:29,774 | DEBUG |   Batch   200  of    447.    Elapsed: 0:02:23.
2023-02-09 22:03:43,359 | DEBUG |   Batch   300  of    447.    Elapsed: 0:03:36.
2023-02-09 22:04:58,448 | DEBUG |   Batch   400  of    447.    Elapsed: 0:04:52.
2023-02-09 22:05:33,986 | INFO | Epoch 1 : 
            Train_acc : 0.8711450279224107
            Train_precision (macro, micro): [0.70209776 0.87114503]
            Train_recall  (macro, micro): [0.55808334 0.87114503]
            Train_F1 : [0.56149211 0.87114503]
2023-02-09 22:05:33,986 | DEBUG | 
2023-02-09 22:05:33,987 | INFO |   Average training loss: 0.39
2023-02-09 22:05:33,987 | INFO |   Training epoch took: 0:05:27
2023-02-09 22:05:34,008 | INFO | Classification report. TRAINING at epoch 1 
               precision    recall  f1-score   support

           0       0.90      0.98      0.94     12371
           1       0.69      0.34      0.45      1921

    accuracy                           0.89     14292
   macro avg       0.80      0.66      0.70     14292
weighted avg       0.88      0.89      0.87     14292

2023-02-09 22:05:34,008 | DEBUG | 
2023-02-09 22:05:34,008 | INFO | Running Validation...
2023-02-09 22:05:45,117 | INFO | Epoch 1 : 
                Valid_acc : 0.9181840075035125
                Valid_precision (macro, micro): [0.84039065 0.91818401]
                Valid_recall (macro, micro): [0.80074468 0.91818401]
                Valid_F1 (macro, micro): [0.81794122 0.91818401]
2023-02-09 22:05:45,117 | INFO |   Accuracy: 0.92
2023-02-09 22:05:45,118 | INFO |   Validation Loss: 0.21
2023-02-09 22:05:45,118 | INFO |   Validation took: 0:00:11
2023-02-09 22:05:45,123 | INFO | Classification report. VALIDATION at epoch 1 
               precision    recall  f1-score   support

           0       0.95      0.96      0.96      1374
           1       0.74      0.68      0.71       214

    accuracy                           0.93      1588
   macro avg       0.85      0.82      0.83      1588
weighted avg       0.92      0.93      0.92      1588

2023-02-09 22:05:45,124 | DEBUG | 
2023-02-09 22:05:45,124 | INFO | ======== Epoch 2 / 4 ========
2023-02-09 22:05:45,124 | INFO | Training...
2023-02-09 22:06:55,852 | DEBUG |   Batch   100  of    447.    Elapsed: 0:01:11.
2023-02-09 22:08:08,140 | DEBUG |   Batch   200  of    447.    Elapsed: 0:02:23.
2023-02-09 22:09:21,875 | DEBUG |   Batch   300  of    447.    Elapsed: 0:03:37.
2023-02-09 22:10:37,151 | DEBUG |   Batch   400  of    447.    Elapsed: 0:04:52.
2023-02-09 22:11:12,807 | INFO | Epoch 2 : 
            Train_acc : 0.9303633839017103
            Train_precision (macro, micro): [0.85891069 0.93036338]
            Train_recall  (macro, micro): [0.83169629 0.93036338]
            Train_F1 : [0.84447227 0.93036338]
2023-02-09 22:11:12,808 | DEBUG | 
2023-02-09 22:11:12,808 | INFO |   Average training loss: 0.31
2023-02-09 22:11:12,808 | INFO |   Training epoch took: 0:05:28
2023-02-09 22:11:12,830 | INFO | Classification report. TRAINING at epoch 2 
               precision    recall  f1-score   support

           0       0.95      0.97      0.96     12371
           1       0.76      0.70      0.73      1921

    accuracy                           0.93     14292
   macro avg       0.86      0.83      0.84     14292
weighted avg       0.93      0.93      0.93     14292

2023-02-09 22:11:12,830 | DEBUG | 
2023-02-09 22:11:12,831 | INFO | Running Validation...
2023-02-09 22:11:23,963 | INFO | Epoch 2 : 
                Valid_acc : 0.9319493130742529
                Valid_precision (macro, micro): [0.90863444 0.93194931]
                Valid_recall (macro, micro): [0.79416368 0.93194931]
                Valid_F1 (macro, micro): [0.83750697 0.93194931]
2023-02-09 22:11:23,964 | INFO |   Accuracy: 0.94
2023-02-09 22:11:23,964 | INFO |   Validation Loss: 0.19
2023-02-09 22:11:23,965 | INFO |   Validation took: 0:00:11
2023-02-09 22:11:23,970 | INFO | Classification report. VALIDATION at epoch 2 
               precision    recall  f1-score   support

           0       0.94      0.99      0.96      1374
           1       0.87      0.62      0.72       214

    accuracy                           0.94      1588
   macro avg       0.91      0.80      0.84      1588
weighted avg       0.93      0.94      0.93      1588

2023-02-09 22:11:23,971 | DEBUG | 
2023-02-09 22:11:23,971 | INFO | ======== Epoch 3 / 4 ========
2023-02-09 22:11:23,971 | INFO | Training...
2023-02-09 22:12:34,793 | DEBUG |   Batch   100  of    447.    Elapsed: 0:01:11.
2023-02-09 22:13:47,078 | DEBUG |   Batch   200  of    447.    Elapsed: 0:02:23.
2023-02-09 22:15:00,804 | DEBUG |   Batch   300  of    447.    Elapsed: 0:03:37.
2023-02-09 22:16:15,969 | DEBUG |   Batch   400  of    447.    Elapsed: 0:04:52.
2023-02-09 22:16:51,611 | INFO | Epoch 3 : 
            Train_acc : 0.9594031078304194
            Train_precision (macro, micro): [0.91800033 0.95940311]
            Train_recall  (macro, micro): [0.90288363 0.95940311]
            Train_F1 : [0.90983831 0.95940311]
2023-02-09 22:16:51,612 | DEBUG | 
2023-02-09 22:16:51,612 | INFO |   Average training loss: 0.27
2023-02-09 22:16:51,612 | INFO |   Training epoch took: 0:05:28
2023-02-09 22:16:51,634 | INFO | Classification report. TRAINING at epoch 3 
               precision    recall  f1-score   support

           0       0.97      0.98      0.98     12371
           1       0.86      0.83      0.84      1921

    accuracy                           0.96     14292
   macro avg       0.92      0.91      0.91     14292
weighted avg       0.96      0.96      0.96     14292

2023-02-09 22:16:51,634 | DEBUG | 
2023-02-09 22:16:51,634 | INFO | Running Validation...
2023-02-09 22:17:02,761 | INFO | Epoch 3 : 
                Valid_acc : 0.9206392201596979
                Valid_precision (macro, micro): [0.82206876 0.92063922]
                Valid_recall (macro, micro): [0.84944976 0.92063922]
                Valid_F1 (macro, micro): [0.83462452 0.92063922]
2023-02-09 22:17:02,761 | INFO |   Accuracy: 0.93
2023-02-09 22:17:02,762 | INFO |   Validation Loss: 0.19
2023-02-09 22:17:02,762 | INFO |   Validation took: 0:00:11
2023-02-09 22:17:02,767 | INFO | Classification report. VALIDATION at epoch 3 
               precision    recall  f1-score   support

           0       0.97      0.95      0.96      1374
           1       0.72      0.79      0.75       214

    accuracy                           0.93      1588
   macro avg       0.84      0.87      0.85      1588
weighted avg       0.93      0.93      0.93      1588

2023-02-09 22:17:02,768 | DEBUG | 
2023-02-09 22:17:02,768 | INFO | ======== Epoch 4 / 4 ========
2023-02-09 22:17:02,768 | INFO | Training...
2023-02-09 22:18:13,554 | DEBUG |   Batch   100  of    447.    Elapsed: 0:01:11.
2023-02-09 22:19:25,808 | DEBUG |   Batch   200  of    447.    Elapsed: 0:02:23.
2023-02-09 22:20:39,522 | DEBUG |   Batch   300  of    447.    Elapsed: 0:03:37.
2023-02-09 22:21:54,740 | DEBUG |   Batch   400  of    447.    Elapsed: 0:04:52.
2023-02-09 22:22:30,312 | INFO | Epoch 4 : 
            Train_acc : 0.9636075267225966
            Train_precision (macro, micro): [0.9226355  0.96360753]
            Train_recall  (macro, micro): [0.92137596 0.96360753]
            Train_F1 : [0.92187971 0.96360753]
2023-02-09 22:22:30,312 | DEBUG | 
2023-02-09 22:22:30,312 | INFO |   Average training loss: 0.26
2023-02-09 22:22:30,313 | INFO |   Training epoch took: 0:05:28
2023-02-09 22:22:30,335 | INFO | Classification report. TRAINING at epoch 4 
               precision    recall  f1-score   support

           0       0.98      0.98      0.98     12371
           1       0.87      0.87      0.87      1921

    accuracy                           0.97     14292
   macro avg       0.93      0.92      0.92     14292
weighted avg       0.96      0.97      0.97     14292

2023-02-09 22:22:30,335 | DEBUG | 
2023-02-09 22:22:30,335 | INFO | Running Validation...
2023-02-09 22:22:41,446 | INFO | Epoch 4 : 
                Valid_acc : 0.9313825969666897
                Valid_precision (macro, micro): [0.86704531 0.9313826 ]
                Valid_recall (macro, micro): [0.83135011 0.9313826 ]
                Valid_F1 (macro, micro): [0.84775105 0.9313826 ]
2023-02-09 22:22:41,446 | INFO |   Accuracy: 0.93
2023-02-09 22:22:41,446 | INFO |   Validation Loss: 0.19
2023-02-09 22:22:41,446 | INFO |   Validation took: 0:00:11
2023-02-09 22:22:41,452 | INFO | Classification report. VALIDATION at epoch 4 
               precision    recall  f1-score   support

           0       0.95      0.97      0.96      1374
           1       0.77      0.69      0.73       214

    accuracy                           0.93      1588
   macro avg       0.86      0.83      0.84      1588
weighted avg       0.93      0.93      0.93      1588

2023-02-09 22:22:41,452 | DEBUG | 
2023-02-09 22:22:41,452 | INFO | Training complete!
2023-02-09 22:22:41,453 | INFO | Total training took 0:22:35 (h:mm:ss)
2023-02-09 22:22:41,499 | DEBUG | ====================================================================================================
2023-02-09 22:22:41,499 | DEBUG | ********************************************************************************
2023-02-09 22:22:41,499 | DEBUG | Iteration: 7/8
2023-02-09 22:22:41,499 | INFO | [{'epoch': 1, 'Training Loss': 0.38750550960934405, 'Training Accur.': 0.8711450279224107, 'Training Precision (macro)': 0.7020977609659328, 'Training Precision (micro)': 0.8711450279224107, 'Training Recall (macro)': 0.5580833418693446, 'Training Recall (micro)': 0.8711450279224107, 'Training F1 (macro)': 0.56149210849251, 'Training F1 (micro)': 0.8711450279224107, 'Valid. Loss': 0.2082287910580635, 'Valid. Accur.': 0.924875, 'Valid. Precision (macro)': 0.8403906481561414, 'Valid. Precision (micro)': 0.9181840075035125, 'Valid. Recall (macro)': 0.800744680521789, 'Valid. Recall (micro)': 0.9181840075035125, 'Valid. F1 (macro)': 0.8179412192467875, 'Valid. F1 (micro)': 0.9181840075035125, 'Training Time': '0:05:27', 'Validation Time': '0:00:11'}, {'epoch': 2, 'Training Loss': 0.30863023417641383, 'Training Accur.': 0.9303633839017103, 'Training Precision (macro)': 0.8589106853548424, 'Training Precision (micro)': 0.9303633839017103, 'Training Recall (macro)': 0.8316962915382914, 'Training Recall (micro)': 0.9303633839017103, 'Training F1 (macro)': 0.8444722664214991, 'Training F1 (micro)': 0.9303633839017103, 'Valid. Loss': 0.18867896303534507, 'Valid. Accur.': 0.93625, 'Valid. Precision (macro)': 0.908634436698573, 'Valid. Precision (micro)': 0.9319493130742529, 'Valid. Recall (macro)': 0.7941636806386747, 'Valid. Recall (micro)': 0.9319493130742529, 'Valid. F1 (macro)': 0.8375069675370852, 'Valid. F1 (micro)': 0.9319493130742529, 'Training Time': '0:05:28', 'Validation Time': '0:00:11'}, {'epoch': 3, 'Training Loss': 0.2679134481638603, 'Training Accur.': 0.9594031078304194, 'Training Precision (macro)': 0.9180003253961035, 'Training Precision (micro)': 0.9594031078304194, 'Training Recall (macro)': 0.902883629648393, 'Training Recall (micro)': 0.9594031078304194, 'Training F1 (macro)': 0.9098383082709226, 'Training F1 (micro)': 0.9594031078304194, 'Valid. Loss': 0.19071841850876808, 'Valid. Accur.': 0.92925, 'Valid. Precision (macro)': 0.822068760278613, 'Valid. Precision (micro)': 0.9206392201596979, 'Valid. Recall (macro)': 0.8494497629397207, 'Valid. Recall (micro)': 0.9206392201596979, 'Valid. F1 (macro)': 0.834624521180708, 'Valid. F1 (micro)': 0.9206392201596979, 'Training Time': '0:05:28', 'Validation Time': '0:00:11'}, {'epoch': 4, 'Training Loss': 0.2609702102356576, 'Training Accur.': 0.9636075267225966, 'Training Precision (macro)': 0.9226354956346849, 'Training Precision (micro)': 0.9636075267225966, 'Training Recall (macro)': 0.9213759562071366, 'Training Recall (micro)': 0.9636075267225966, 'Training F1 (macro)': 0.9218797094134595, 'Training F1 (micro)': 0.9636075267225966, 'Valid. Loss': 0.19284287109971046, 'Valid. Accur.': 0.930125, 'Valid. Precision (macro)': 0.8670453111090894, 'Valid. Precision (micro)': 0.9313825969666897, 'Valid. Recall (macro)': 0.8313501141491451, 'Valid. Recall (micro)': 0.9313825969666897, 'Valid. F1 (macro)': 0.8477510476894498, 'Valid. F1 (micro)': 0.9313825969666897, 'Training Time': '0:05:28', 'Validation Time': '0:00:11'}]
2023-02-09 22:22:41,500 | DEBUG | ********************************************************************************
2023-02-09 22:22:41,500 | DEBUG | ====================================================================================================
2023-02-09 22:22:41,501 | INFO | To execute testing of the model on test_data
2023-02-09 22:22:41,501 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-02-09 22:22:41,501 | INFO | 	 1 - NVIDIA A100-SXM4-40GB
2023-02-09 22:22:41,501 | DEBUG | Running Testing...
2023-02-09 22:22:47,317 | INFO | 
        Test_acc : 0.9309416003779497
        Test_precision (macro, micro): [0.87019913 0.9309416 ]
        Test_recall (macro, micro): [0.7991641 0.9309416]
        Test_F1 (macro, micro): [0.82827874 0.9309416 ]
2023-02-09 22:22:47,318 | INFO |   Accuracy: 0.93
2023-02-09 22:22:47,318 | INFO |   Test Loss: 0.18
2023-02-09 22:22:47,318 | INFO |   Test took: 0:00:06
2023-02-09 22:22:47,322 | INFO | Classification report. TEST 
               precision    recall  f1-score   support

           0       0.95      0.98      0.96       724
           1       0.80      0.63      0.71       112

    accuracy                           0.93       836
   macro avg       0.87      0.80      0.83       836
weighted avg       0.93      0.93      0.93       836

2023-02-09 22:22:47,334 | DEBUG | {'general_set_up': {'dataset_filename': '20230207_Dataset_GTC_FINAL_Witnesses.xlsx', 'input_dir_name': 'input', 'output_dir_name': 'output', 'dataset_dir_name': 'dataset', 'logs_dir_name': 'logs', 'models_dir_name': 'models', 'plots_dir_name': 'plots'}, 'dataset': {'index_columns_dataset': 1, 'list_columns_names': ['tribunal', 'id_transcript', 'case', 'accused', 'date', 'text', 'trauma', 'role', 'witnesses', 'n_witnesses', 'start', 'id_annotation', 'id_document'], 'col_of_interest_binary_classif': 'trauma', 'col_of_interest_multi_label_classif': 'role', 'col_of_reference_binary_classif': 'text', 'col_of_reference_multi_label_classif': 'text'}, 'models': {'bert': ['bert-base-uncased', 'nlpaueb/legal-bert-base-uncased'], 'other': ['snowood1/ConfliBERT-scr-uncased', 'GroNLP/hateBERT']}, 'training_model': {'model_name': 'bert-base-uncased', 'epochs': 4, 'batch_size': 32, 'embedding_size': 512, 'return_attention_mask': True, 'cross_validation': False, 'save_model': True, 'store_statistics': True, 'test_model': True, 'add_special_tokes': True, 'max_length': 512, 'pad_to_max_length': True, 'run_in_gpu': True, 'classification_task': 'binary', 'learning_rate': '1e-6', 'epsilon_optimizer': '1e-8', 'weight_decay': 0}, 'active_training': {'size_splits_dataset': 8, 'classification_task': 'binary'}}
2023-02-09 22:22:47,335 | DEBUG | Num of different classes in the dataset is 2 which are:
2023-02-09 22:22:47,335 | DEBUG | 	 1 - 0
2023-02-09 22:22:47,335 | DEBUG | 	 2 - 1
2023-02-09 22:22:47,336 | WARNING | 0    16536
1     2568
Name: trauma, dtype: int64
2023-02-09 22:22:47,336 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-02-09 22:22:47,337 | INFO | 	 1 - NVIDIA A100-SXM4-40GB
2023-02-09 22:22:47,337 | DEBUG | 

==> Selected device is 'cuda' <==
2023-02-09 22:22:47,337 | DEBUG | Loading tokenizer... [ID:bert];[Name:bert-base-uncased]
2023-02-09 22:22:47,516 | INFO | bert tokenizer was loaded successfully (bert-base-uncased)
	do_lower_case=True
2023-02-09 22:23:01,562 | INFO | Max sentence length: 467 found at index 16466. Sentence is:


So we thought we would have been spared because Father Munyeshyaka had forcefully kissed Hyacinthe, and Hyacinthe had come back crying.  And I told her that maybe the priest felt guilty and wanted to help her.  So *********************** and I told her that probably, on the next day, we would finally be saved. ************************************************************************ ********************** ************************************************************************ ********************************************* And the following day, in the morning, it is that list that they used to put people to death -- that list we ********************************.  But when they went out, I saw Father Munyeshyaka with that list in his hand and I recognised the sheet of paper, **************************************************************, and it is with that list that the Interahamwe killed people.



2023-02-09 22:23:19,148 | INFO | 
CORPUS TRAINING AND VALIDATION: 
            
	 Length labels 18148
            
	 Length input_ids 18148
            
	 Length attention_masks 18148
            

2023-02-09 22:23:19,149 | INFO | 
	CORPUS TRAINING:  
            
		 Length labels 16333
            
		 Length input_ids 16333
            
		 Length attention_masks 16333
2023-02-09 22:23:19,149 | INFO | 
	CORPUS VALIDATION: 
            
		 Length labels 1815
            
		 Length input_ids 1815
            
		 Length attention_masks 1815
2023-02-09 22:23:19,149 | INFO | 
2023-02-09 22:23:19,149 | INFO | 
CORPUS TEST: 
            
	 Length labels 956
            
	 Length input_ids 956
            
	 Length attention_masks 956
            

2023-02-09 22:23:20,570 | DEBUG | Optimizer
2023-02-09 22:23:20,570 | DEBUG | AdamW (
Parameter Group 0
    betas: (0.9, 0.999)
    correct_bias: True
    eps: 1e-08
    lr: 1e-06
    weight_decay: 0.0
)
2023-02-09 22:23:20,571 | DEBUG | 
2023-02-09 22:23:20,571 | INFO | ======== Epoch 1 / 4 ========
2023-02-09 22:23:20,571 | INFO | Training...
2023-02-09 22:24:31,341 | DEBUG |   Batch   100  of    511.    Elapsed: 0:01:11.
2023-02-09 22:25:43,514 | DEBUG |   Batch   200  of    511.    Elapsed: 0:02:23.
2023-02-09 22:26:57,049 | DEBUG |   Batch   300  of    511.    Elapsed: 0:03:36.
2023-02-09 22:28:12,186 | DEBUG |   Batch   400  of    511.    Elapsed: 0:04:52.
2023-02-09 22:29:28,816 | DEBUG |   Batch   500  of    511.    Elapsed: 0:06:08.
2023-02-09 22:29:36,942 | INFO | Epoch 1 : 
            Train_acc : 0.8792899257498858
            Train_precision (macro, micro): [0.71882891 0.87928993]
            Train_recall  (macro, micro): [0.5707596  0.87928993]
            Train_F1 : [0.57932427 0.87928993]
2023-02-09 22:29:36,942 | DEBUG | 
2023-02-09 22:29:36,942 | INFO |   Average training loss: 0.38
2023-02-09 22:29:36,942 | INFO |   Training epoch took: 0:06:16
2023-02-09 22:29:36,966 | INFO | Classification report. TRAINING at epoch 1 
               precision    recall  f1-score   support

           0       0.91      0.97      0.94     14138
           1       0.69      0.37      0.48      2195

    accuracy                           0.89     16333
   macro avg       0.80      0.67      0.71     16333
weighted avg       0.88      0.89      0.88     16333

2023-02-09 22:29:36,967 | DEBUG | 
2023-02-09 22:29:36,967 | INFO | Running Validation...
2023-02-09 22:29:49,712 | INFO | Epoch 1 : 
                Valid_acc : 0.936200882843215
                Valid_precision (macro, micro): [0.86510994 0.93620088]
                Valid_recall (macro, micro): [0.8486186  0.93620088]
                Valid_F1 (macro, micro): [0.85564975 0.93620088]
2023-02-09 22:29:49,712 | INFO |   Accuracy: 0.93
2023-02-09 22:29:49,713 | INFO |   Validation Loss: 0.19
2023-02-09 22:29:49,713 | INFO |   Validation took: 0:00:13
2023-02-09 22:29:49,718 | INFO | Classification report. VALIDATION at epoch 1 
               precision    recall  f1-score   support

           0       0.95      0.96      0.96      1571
           1       0.75      0.68      0.71       244

    accuracy                           0.93      1815
   macro avg       0.85      0.82      0.83      1815
weighted avg       0.92      0.93      0.92      1815

2023-02-09 22:29:49,719 | DEBUG | 
2023-02-09 22:29:49,719 | INFO | ======== Epoch 2 / 4 ========
2023-02-09 22:29:49,719 | INFO | Training...
2023-02-09 22:31:00,538 | DEBUG |   Batch   100  of    511.    Elapsed: 0:01:11.
2023-02-09 22:32:12,756 | DEBUG |   Batch   200  of    511.    Elapsed: 0:02:23.
2023-02-09 22:33:26,577 | DEBUG |   Batch   300  of    511.    Elapsed: 0:03:37.
2023-02-09 22:34:41,877 | DEBUG |   Batch   400  of    511.    Elapsed: 0:04:52.
2023-02-09 22:35:58,588 | DEBUG |   Batch   500  of    511.    Elapsed: 0:06:09.
2023-02-09 22:36:06,738 | INFO | Epoch 2 : 
            Train_acc : 0.9286775674976052
            Train_precision (macro, micro): [0.8538127  0.92867757]
            Train_recall  (macro, micro): [0.82985421 0.92867757]
            Train_F1 : [0.84061109 0.92867757]
2023-02-09 22:36:06,739 | DEBUG | 
2023-02-09 22:36:06,739 | INFO |   Average training loss: 0.30
2023-02-09 22:36:06,739 | INFO |   Training epoch took: 0:06:17
2023-02-09 22:36:06,764 | INFO | Classification report. TRAINING at epoch 2 
               precision    recall  f1-score   support

           0       0.96      0.97      0.96     14138
           1       0.76      0.72      0.74      2195

    accuracy                           0.93     16333
   macro avg       0.86      0.84      0.85     16333
weighted avg       0.93      0.93      0.93     16333

2023-02-09 22:36:06,764 | DEBUG | 
2023-02-09 22:36:06,765 | INFO | Running Validation...
2023-02-09 22:36:19,515 | INFO | Epoch 2 : 
                Valid_acc : 0.9355677805724063
                Valid_precision (macro, micro): [0.85190654 0.93556778]
                Valid_recall (macro, micro): [0.86096722 0.93556778]
                Valid_F1 (macro, micro): [0.85599624 0.93556778]
2023-02-09 22:36:19,516 | INFO |   Accuracy: 0.93
2023-02-09 22:36:19,516 | INFO |   Validation Loss: 0.19
2023-02-09 22:36:19,516 | INFO |   Validation took: 0:00:13
2023-02-09 22:36:19,521 | INFO | Classification report. VALIDATION at epoch 2 
               precision    recall  f1-score   support

           0       0.96      0.96      0.96      1571
           1       0.74      0.76      0.75       244

    accuracy                           0.93      1815
   macro avg       0.85      0.86      0.85      1815
weighted avg       0.93      0.93      0.93      1815

2023-02-09 22:36:19,522 | DEBUG | 
2023-02-09 22:36:19,523 | INFO | ======== Epoch 3 / 4 ========
2023-02-09 22:36:19,523 | INFO | Training...
2023-02-09 22:37:30,321 | DEBUG |   Batch   100  of    511.    Elapsed: 0:01:11.
2023-02-09 22:38:42,516 | DEBUG |   Batch   200  of    511.    Elapsed: 0:02:23.
2023-02-09 22:39:56,249 | DEBUG |   Batch   300  of    511.    Elapsed: 0:03:37.
2023-02-09 22:41:11,417 | DEBUG |   Batch   400  of    511.    Elapsed: 0:04:52.
2023-02-09 22:42:28,125 | DEBUG |   Batch   500  of    511.    Elapsed: 0:06:09.
2023-02-09 22:42:36,275 | INFO | Epoch 3 : 
            Train_acc : 0.9568380266004322
            Train_precision (macro, micro): [0.91191108 0.95683803]
            Train_recall  (macro, micro): [0.89764249 0.95683803]
            Train_F1 : [0.90454139 0.95683803]
2023-02-09 22:42:36,275 | DEBUG | 
2023-02-09 22:42:36,275 | INFO |   Average training loss: 0.27
2023-02-09 22:42:36,276 | INFO |   Training epoch took: 0:06:17
2023-02-09 22:42:36,300 | INFO | Classification report. TRAINING at epoch 3 
               precision    recall  f1-score   support

           0       0.97      0.98      0.98     14138
           1       0.86      0.82      0.84      2195

    accuracy                           0.96     16333
   macro avg       0.91      0.90      0.91     16333
weighted avg       0.96      0.96      0.96     16333

2023-02-09 22:42:36,300 | DEBUG | 
2023-02-09 22:42:36,300 | INFO | Running Validation...
2023-02-09 22:42:49,035 | INFO | Epoch 3 : 
                Valid_acc : 0.9148105230623969
                Valid_precision (macro, micro): [0.80590679 0.91481052]
                Valid_recall (macro, micro): [0.81907061 0.91481052]
                Valid_F1 (macro, micro): [0.81123441 0.91481052]
2023-02-09 22:42:49,036 | INFO |   Accuracy: 0.93
2023-02-09 22:42:49,036 | INFO |   Validation Loss: 0.19
2023-02-09 22:42:49,036 | INFO |   Validation took: 0:00:13
2023-02-09 22:42:49,041 | INFO | Classification report. VALIDATION at epoch 3 
               precision    recall  f1-score   support

           0       0.96      0.96      0.96      1571
           1       0.72      0.75      0.74       244

    accuracy                           0.93      1815
   macro avg       0.84      0.85      0.85      1815
weighted avg       0.93      0.93      0.93      1815

2023-02-09 22:42:49,042 | DEBUG | 
2023-02-09 22:42:49,042 | INFO | ======== Epoch 4 / 4 ========
2023-02-09 22:42:49,042 | INFO | Training...
2023-02-09 22:43:59,788 | DEBUG |   Batch   100  of    511.    Elapsed: 0:01:11.
2023-02-09 22:45:12,014 | DEBUG |   Batch   200  of    511.    Elapsed: 0:02:23.
2023-02-09 22:46:25,783 | DEBUG |   Batch   300  of    511.    Elapsed: 0:03:37.
2023-02-09 22:47:40,915 | DEBUG |   Batch   400  of    511.    Elapsed: 0:04:52.
2023-02-09 22:48:57,602 | DEBUG |   Batch   500  of    511.    Elapsed: 0:06:09.
2023-02-09 22:49:05,776 | INFO | Epoch 4 : 
            Train_acc : 0.960891297896978
            Train_precision (macro, micro): [0.92376622 0.9608913 ]
            Train_recall  (macro, micro): [0.91036682 0.9608913 ]
            Train_F1 : [0.9168568 0.9608913]
2023-02-09 22:49:05,777 | DEBUG | 
2023-02-09 22:49:05,777 | INFO |   Average training loss: 0.27
2023-02-09 22:49:05,777 | INFO |   Training epoch took: 0:06:17
2023-02-09 22:49:05,801 | INFO | Classification report. TRAINING at epoch 4 
               precision    recall  f1-score   support

           0       0.97      0.98      0.98     14138
           1       0.86      0.82      0.84      2195

    accuracy                           0.96     16333
   macro avg       0.92      0.90      0.91     16333
weighted avg       0.96      0.96      0.96     16333

2023-02-09 22:49:05,801 | DEBUG | 
2023-02-09 22:49:05,801 | INFO | Running Validation...
2023-02-09 22:49:18,563 | INFO | Epoch 4 : 
                Valid_acc : 0.9255290074049668
                Valid_precision (macro, micro): [0.84580786 0.92552901]
                Valid_recall (macro, micro): [0.84368613 0.92552901]
                Valid_F1 (macro, micro): [0.84437393 0.92552901]
2023-02-09 22:49:18,564 | INFO |   Accuracy: 0.93
2023-02-09 22:49:18,564 | INFO |   Validation Loss: 0.20
2023-02-09 22:49:18,565 | INFO |   Validation took: 0:00:13
2023-02-09 22:49:18,570 | INFO | Classification report. VALIDATION at epoch 4 
               precision    recall  f1-score   support

           0       0.96      0.96      0.96      1571
           1       0.73      0.74      0.73       244

    accuracy                           0.93      1815
   macro avg       0.85      0.85      0.85      1815
weighted avg       0.93      0.93      0.93      1815

2023-02-09 22:49:18,571 | DEBUG | 
2023-02-09 22:49:18,571 | INFO | Training complete!
2023-02-09 22:49:18,571 | INFO | Total training took 0:25:58 (h:mm:ss)
2023-02-09 22:49:18,628 | DEBUG | ====================================================================================================
2023-02-09 22:49:18,628 | DEBUG | ********************************************************************************
2023-02-09 22:49:18,629 | DEBUG | Iteration: 8/8
2023-02-09 22:49:18,629 | INFO | [{'epoch': 1, 'Training Loss': 0.3814985062744753, 'Training Accur.': 0.8792899257498858, 'Training Precision (macro)': 0.7188289126630035, 'Training Precision (micro)': 0.8792899257498858, 'Training Recall (macro)': 0.5707596047614237, 'Training Recall (micro)': 0.8792899257498858, 'Training F1 (macro)': 0.5793242726058362, 'Training F1 (micro)': 0.8792899257498858, 'Valid. Loss': 0.19225229414408668, 'Valid. Accur.': 0.9251287185354692, 'Valid. Precision (macro)': 0.8651099404759757, 'Valid. Precision (micro)': 0.936200882843215, 'Valid. Recall (macro)': 0.8486185970171174, 'Valid. Recall (micro)': 0.936200882843215, 'Valid. F1 (macro)': 0.8556497540176026, 'Valid. F1 (micro)': 0.936200882843215, 'Training Time': '0:06:16', 'Validation Time': '0:00:13'}, {'epoch': 2, 'Training Loss': 0.30425086506658805, 'Training Accur.': 0.9286775674976052, 'Training Precision (macro)': 0.8538126952965012, 'Training Precision (micro)': 0.9286775674976052, 'Training Recall (macro)': 0.8298542111410527, 'Training Recall (micro)': 0.9286775674976052, 'Training F1 (macro)': 0.8406110874554289, 'Training F1 (micro)': 0.9286775674976052, 'Valid. Loss': 0.1859917341355692, 'Valid. Accur.': 0.931040236460717, 'Valid. Precision (macro)': 0.851906538008346, 'Valid. Precision (micro)': 0.9355677805724063, 'Valid. Recall (macro)': 0.8609672219559052, 'Valid. Recall (micro)': 0.9355677805724063, 'Valid. F1 (macro)': 0.8559962367620884, 'Valid. F1 (micro)': 0.9355677805724063, 'Training Time': '0:06:17', 'Validation Time': '0:00:13'}, {'epoch': 3, 'Training Loss': 0.27121686384285965, 'Training Accur.': 0.9568380266004322, 'Training Precision (macro)': 0.9119110833386996, 'Training Precision (micro)': 0.9568380266004322, 'Training Recall (macro)': 0.8976424894844812, 'Training Recall (micro)': 0.9568380266004322, 'Training F1 (macro)': 0.9045413876897073, 'Training F1 (micro)': 0.9568380266004322, 'Valid. Loss': 0.1873018231831099, 'Valid. Accur.': 0.9285135392829901, 'Valid. Precision (macro)': 0.8059067899949074, 'Valid. Precision (micro)': 0.9148105230623969, 'Valid. Recall (macro)': 0.8190706091137244, 'Valid. Recall (micro)': 0.9148105230623969, 'Valid. F1 (macro)': 0.811234414206968, 'Valid. F1 (micro)': 0.9148105230623969, 'Training Time': '0:06:17', 'Validation Time': '0:00:13'}, {'epoch': 4, 'Training Loss': 0.26825655145304544, 'Training Accur.': 0.960891297896978, 'Training Precision (macro)': 0.9237662217169033, 'Training Precision (micro)': 0.960891297896978, 'Training Recall (macro)': 0.9103668178499295, 'Training Recall (micro)': 0.960891297896978, 'Training F1 (macro)': 0.916856795049286, 'Training F1 (micro)': 0.960891297896978, 'Valid. Loss': 0.19535032097707716, 'Valid. Accur.': 0.9280844774980931, 'Valid. Precision (macro)': 0.84580785540936, 'Valid. Precision (micro)': 0.9255290074049668, 'Valid. Recall (macro)': 0.8436861327644697, 'Valid. Recall (micro)': 0.9255290074049668, 'Valid. F1 (macro)': 0.8443739314518154, 'Valid. F1 (micro)': 0.9255290074049668, 'Training Time': '0:06:17', 'Validation Time': '0:00:13'}]
2023-02-09 22:49:18,630 | DEBUG | ********************************************************************************
2023-02-09 22:49:18,630 | DEBUG | ====================================================================================================
2023-02-09 22:49:18,630 | INFO | To execute testing of the model on test_data
2023-02-09 22:49:18,630 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-02-09 22:49:18,630 | INFO | 	 1 - NVIDIA A100-SXM4-40GB
2023-02-09 22:49:18,630 | DEBUG | Running Testing...
2023-02-09 22:49:25,278 | INFO | 
        Test_acc : 0.9465658120901558
        Test_precision (macro, micro): [0.86706581 0.94656581]
        Test_recall (macro, micro): [0.87391674 0.94656581]
        Test_F1 (macro, micro): [0.87027352 0.94656581]
2023-02-09 22:49:25,278 | INFO |   Accuracy: 0.94
2023-02-09 22:49:25,279 | INFO |   Test Loss: 0.18
2023-02-09 22:49:25,279 | INFO |   Test took: 0:00:07
2023-02-09 22:49:25,283 | INFO | Classification report. TEST 
               precision    recall  f1-score   support

           0       0.97      0.96      0.97       827
           1       0.76      0.81      0.79       129

    accuracy                           0.94       956
   macro avg       0.87      0.89      0.88       956
weighted avg       0.94      0.94      0.94       956

2023-02-09 22:49:25,284 | INFO | From active learning we present the following statistics: [{'epoch': 1, 'Training Loss': 0.3814985062744753, 'Training Accur.': 0.8792899257498858, 'Training Precision (macro)': 0.7188289126630035, 'Training Precision (micro)': 0.8792899257498858, 'Training Recall (macro)': 0.5707596047614237, 'Training Recall (micro)': 0.8792899257498858, 'Training F1 (macro)': 0.5793242726058362, 'Training F1 (micro)': 0.8792899257498858, 'Valid. Loss': 0.19225229414408668, 'Valid. Accur.': 0.9251287185354692, 'Valid. Precision (macro)': 0.8651099404759757, 'Valid. Precision (micro)': 0.936200882843215, 'Valid. Recall (macro)': 0.8486185970171174, 'Valid. Recall (micro)': 0.936200882843215, 'Valid. F1 (macro)': 0.8556497540176026, 'Valid. F1 (micro)': 0.936200882843215, 'Training Time': '0:06:16', 'Validation Time': '0:00:13'}, {'epoch': 2, 'Training Loss': 0.30425086506658805, 'Training Accur.': 0.9286775674976052, 'Training Precision (macro)': 0.8538126952965012, 'Training Precision (micro)': 0.9286775674976052, 'Training Recall (macro)': 0.8298542111410527, 'Training Recall (micro)': 0.9286775674976052, 'Training F1 (macro)': 0.8406110874554289, 'Training F1 (micro)': 0.9286775674976052, 'Valid. Loss': 0.1859917341355692, 'Valid. Accur.': 0.931040236460717, 'Valid. Precision (macro)': 0.851906538008346, 'Valid. Precision (micro)': 0.9355677805724063, 'Valid. Recall (macro)': 0.8609672219559052, 'Valid. Recall (micro)': 0.9355677805724063, 'Valid. F1 (macro)': 0.8559962367620884, 'Valid. F1 (micro)': 0.9355677805724063, 'Training Time': '0:06:17', 'Validation Time': '0:00:13'}, {'epoch': 3, 'Training Loss': 0.27121686384285965, 'Training Accur.': 0.9568380266004322, 'Training Precision (macro)': 0.9119110833386996, 'Training Precision (micro)': 0.9568380266004322, 'Training Recall (macro)': 0.8976424894844812, 'Training Recall (micro)': 0.9568380266004322, 'Training F1 (macro)': 0.9045413876897073, 'Training F1 (micro)': 0.9568380266004322, 'Valid. Loss': 0.1873018231831099, 'Valid. Accur.': 0.9285135392829901, 'Valid. Precision (macro)': 0.8059067899949074, 'Valid. Precision (micro)': 0.9148105230623969, 'Valid. Recall (macro)': 0.8190706091137244, 'Valid. Recall (micro)': 0.9148105230623969, 'Valid. F1 (macro)': 0.811234414206968, 'Valid. F1 (micro)': 0.9148105230623969, 'Training Time': '0:06:17', 'Validation Time': '0:00:13'}, {'epoch': 4, 'Training Loss': 0.26825655145304544, 'Training Accur.': 0.960891297896978, 'Training Precision (macro)': 0.9237662217169033, 'Training Precision (micro)': 0.960891297896978, 'Training Recall (macro)': 0.9103668178499295, 'Training Recall (micro)': 0.960891297896978, 'Training F1 (macro)': 0.916856795049286, 'Training F1 (micro)': 0.960891297896978, 'Valid. Loss': 0.19535032097707716, 'Valid. Accur.': 0.9280844774980931, 'Valid. Precision (macro)': 0.84580785540936, 'Valid. Precision (micro)': 0.9255290074049668, 'Valid. Recall (macro)': 0.8436861327644697, 'Valid. Recall (micro)': 0.9255290074049668, 'Valid. F1 (macro)': 0.8443739314518154, 'Valid. F1 (micro)': 0.9255290074049668, 'Training Time': '0:06:17', 'Validation Time': '0:00:13'}]
