2023-02-11 00:26:15,370 | DEBUG | Reading directory path
2023-02-11 00:26:16,248 | DEBUG | {'general_set_up': {'dataset_filename': '20230207_Dataset_GTC_FINAL_Witnesses.xlsx', 'input_dir_name': 'input', 'output_dir_name': 'output', 'dataset_dir_name': 'dataset', 'logs_dir_name': 'logs', 'models_dir_name': 'models', 'plots_dir_name': 'plots'}, 'dataset': {'index_columns_dataset': 1, 'list_columns_names': ['tribunal', 'id_transcript', 'case', 'accused', 'date', 'text', 'trauma', 'role', 'witnesses', 'n_witnesses', 'start', 'id_annotation', 'id_document'], 'col_of_interest_binary_classif': 'trauma', 'col_of_interest_multi_label_classif': 'role', 'col_of_reference_binary_classif': 'text', 'col_of_reference_multi_label_classif': 'text'}, 'models': {'bert': ['bert-base-uncased', 'nlpaueb/legal-bert-base-uncased'], 'other': ['snowood1/ConfliBERT-scr-uncased', 'GroNLP/hateBERT']}, 'training_model': {'model_name': 'GroNLP/hateBERT', 'epochs': 3, 'batch_size': 32, 'embedding_size': 512, 'return_attention_mask': True, 'cross_validation': False, 'save_model': True, 'store_statistics': True, 'test_model': True, 'add_special_tokes': True, 'max_length': 512, 'pad_to_max_length': True, 'run_in_gpu': True, 'classification_task': 'binary', 'learning_rate': '1e-6', 'epsilon_optimizer': '1e-8', 'weight_decay': 0, 'size_dataset': 9552, 'mode_select_elems_dataset': 'random'}, 'active_training': {'size_splits_dataset': 8, 'classification_task': 'binary'}}
2023-02-11 00:26:21,296 | DEBUG | Col of interest <<trauma>>
2023-02-11 00:26:21,297 | DEBUG | classes_dataset <<[0, 1]>>
2023-02-11 00:26:21,297 | INFO | To extract specific size of the dataset. Value in the config file 9552
2023-02-11 00:26:21,297 | INFO | Parameters at get_df_with_specific_size are [random, trauma, text, 9552]
2023-02-11 00:26:21,321 | INFO | Distribution of classes [0, 1] is [0.87, 0.13]
2023-02-11 00:26:21,321 | INFO | New number of elements per class [0, 1] is [8310, 1241]
2023-02-11 00:26:21,344 | INFO | Size of final dataset is 9551 (may differ from -1 due to factor control)
2023-02-11 00:26:21,345 | INFO | Number of elements per class
0    8310
1    1241
Name: trauma, dtype: int64
2023-02-11 00:26:21,355 | INFO | Final distribution of the new dataset [0.87, 0.13]
2023-02-11 00:26:21,356 | DEBUG | Num of different classes in the dataset is 2 which are:
2023-02-11 00:26:21,357 | DEBUG | 	 1 - 0
2023-02-11 00:26:21,357 | DEBUG | 	 2 - 1
2023-02-11 00:26:21,357 | WARNING | 0    8310
1    1241
Name: trauma, dtype: int64
2023-02-11 00:26:22,127 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-02-11 00:26:22,129 | INFO | 	 1 - NVIDIA A100-SXM4-40GB
2023-02-11 00:26:22,129 | DEBUG | 

==> Selected device is 'cuda' <==
2023-02-11 00:26:22,129 | DEBUG | Loading tokenizer... [ID:other];[Name:GroNLP/hateBERT]
2023-02-11 00:26:32,194 | INFO | other tokenizer was loaded successfully (GroNLP/hateBERT)
	do_lower_case=True
2023-02-11 00:26:33,853 | INFO | Max sentence length: 467 found at index 8417. Sentence is:


So we thought we would have been spared because Father Munyeshyaka had forcefully kissed Hyacinthe, and Hyacinthe had come back crying.  And I told her that maybe the priest felt guilty and wanted to help her.  So *********************** and I told her that probably, on the next day, we would finally be saved. ************************************************************************ ********************** ************************************************************************ ********************************************* And the following day, in the morning, it is that list that they used to put people to death -- that list we ********************************.  But when they went out, I saw Father Munyeshyaka with that list in his hand and I recognised the sheet of paper, **************************************************************, and it is with that list that the Interahamwe killed people.



2023-02-11 00:26:37,982 | INFO | 
CORPUS TRAINING AND VALIDATION: 
            
	 Length labels 9073
            
	 Length input_ids 9073
            
	 Length attention_masks 9073
            

2023-02-11 00:26:37,983 | INFO | 
	CORPUS TRAINING:  
            
		 Length labels 8165
            
		 Length input_ids 8165
            
		 Length attention_masks 8165
2023-02-11 00:26:37,983 | INFO | 
	CORPUS VALIDATION: 
            
		 Length labels 908
            
		 Length input_ids 908
            
		 Length attention_masks 908
2023-02-11 00:26:37,983 | INFO | 
2023-02-11 00:26:37,983 | INFO | 
CORPUS TEST: 
            
	 Length labels 478
            
	 Length input_ids 478
            
	 Length attention_masks 478
            

2023-02-11 00:26:45,623 | DEBUG | Optimizer
2023-02-11 00:26:45,624 | DEBUG | AdamW (
Parameter Group 0
    betas: (0.9, 0.999)
    correct_bias: True
    eps: 1e-08
    lr: 1e-06
    weight_decay: 0.0
)
2023-02-11 00:26:45,624 | DEBUG | 
2023-02-11 00:26:45,625 | INFO | ======== Epoch 1 / 3 ========
2023-02-11 00:26:45,625 | INFO | Training...
2023-02-11 00:27:57,087 | DEBUG |   Batch   100  of    256.    Elapsed: 0:01:11.
2023-02-11 00:29:08,709 | DEBUG |   Batch   200  of    256.    Elapsed: 0:02:23.
2023-02-11 00:29:48,871 | INFO | Epoch 1 : 
            Train_acc : 0.8648777035313523
            Train_precision (macro, micro): [0.54194003 0.8648777 ]
            Train_recall  (macro, micro): [0.5025631 0.8648777]
            Train_F1 : [0.47661708 0.8648777 ]
2023-02-11 00:29:48,871 | DEBUG | 
2023-02-11 00:29:48,871 | INFO |   Average training loss: 0.45
2023-02-11 00:29:48,872 | INFO |   Training epoch took: 0:03:03
2023-02-11 00:29:48,884 | INFO | Classification report. TRAINING at epoch 1 
               precision    recall  f1-score   support

           0       0.87      1.00      0.93      7104
           1       0.43      0.02      0.04      1061

    accuracy                           0.87      8165
   macro avg       0.65      0.51      0.48      8165
weighted avg       0.81      0.87      0.81      8165

2023-02-11 00:29:48,884 | DEBUG | 
2023-02-11 00:29:48,884 | INFO | Running Validation...
2023-02-11 00:29:55,186 | INFO | Epoch 1 : 
                Valid_acc : 0.8896734443412743
                Valid_precision (macro, micro): [0.82554167 0.88967344]
                Valid_recall (macro, micro): [0.60560225 0.88967344]
                Valid_F1 (macro, micro): [0.64095396 0.88967344]
2023-02-11 00:29:55,187 | INFO |   Accuracy: 0.89
2023-02-11 00:29:55,187 | INFO |   Validation Loss: 0.27
2023-02-11 00:29:55,187 | INFO |   Validation took: 0:00:06
2023-02-11 00:29:55,191 | INFO | Classification report. VALIDATION at epoch 1 
               precision    recall  f1-score   support

           0       0.89      0.99      0.94       790
           1       0.69      0.21      0.32       118

    accuracy                           0.89       908
   macro avg       0.79      0.60      0.63       908
weighted avg       0.87      0.89      0.86       908

2023-02-11 00:29:55,192 | DEBUG | 
2023-02-11 00:29:55,192 | INFO | ======== Epoch 2 / 3 ========
2023-02-11 00:29:55,192 | INFO | Training...
2023-02-11 00:31:05,431 | DEBUG |   Batch   100  of    256.    Elapsed: 0:01:10.
2023-02-11 00:32:17,101 | DEBUG |   Batch   200  of    256.    Elapsed: 0:02:22.
2023-02-11 00:32:57,317 | INFO | Epoch 2 : 
            Train_acc : 0.9145116939983567
            Train_precision (macro, micro): [0.83959829 0.91451169]
            Train_recall  (macro, micro): [0.69647866 0.91451169]
            Train_F1 : [0.73841483 0.91451169]
2023-02-11 00:32:57,318 | DEBUG | 
2023-02-11 00:32:57,318 | INFO |   Average training loss: 0.33
2023-02-11 00:32:57,318 | INFO |   Training epoch took: 0:03:02
2023-02-11 00:32:57,331 | INFO | Classification report. TRAINING at epoch 2 
               precision    recall  f1-score   support

           0       0.93      0.97      0.95      7104
           1       0.73      0.55      0.63      1061

    accuracy                           0.92      8165
   macro avg       0.83      0.76      0.79      8165
weighted avg       0.91      0.92      0.91      8165

2023-02-11 00:32:57,331 | DEBUG | 
2023-02-11 00:32:57,331 | INFO | Running Validation...
2023-02-11 00:33:03,636 | INFO | Epoch 2 : 
                Valid_acc : 0.9250911566080454
                Valid_precision (macro, micro): [0.84441472 0.92509116]
                Valid_recall (macro, micro): [0.83466109 0.92509116]
                Valid_F1 (macro, micro): [0.83799446 0.92509116]
2023-02-11 00:33:03,636 | INFO |   Accuracy: 0.93
2023-02-11 00:33:03,636 | INFO |   Validation Loss: 0.20
2023-02-11 00:33:03,636 | INFO |   Validation took: 0:00:06
2023-02-11 00:33:03,641 | INFO | Classification report. VALIDATION at epoch 2 
               precision    recall  f1-score   support

           0       0.96      0.96      0.96       790
           1       0.71      0.74      0.72       118

    accuracy                           0.93       908
   macro avg       0.84      0.85      0.84       908
weighted avg       0.93      0.93      0.93       908

2023-02-11 00:33:03,641 | DEBUG | 
2023-02-11 00:33:03,641 | INFO | ======== Epoch 3 / 3 ========
2023-02-11 00:33:03,642 | INFO | Training...
2023-02-11 00:34:13,904 | DEBUG |   Batch   100  of    256.    Elapsed: 0:01:10.
2023-02-11 00:35:25,679 | DEBUG |   Batch   200  of    256.    Elapsed: 0:02:22.
2023-02-11 00:36:05,933 | INFO | Epoch 3 : 
            Train_acc : 0.9383808453614438
            Train_precision (macro, micro): [0.88576171 0.93838085]
            Train_recall  (macro, micro): [0.83776864 0.93838085]
            Train_F1 : [0.85874427 0.93838085]
2023-02-11 00:36:05,933 | DEBUG | 
2023-02-11 00:36:05,933 | INFO |   Average training loss: 0.29
2023-02-11 00:36:05,933 | INFO |   Training epoch took: 0:03:02
2023-02-11 00:36:05,947 | INFO | Classification report. TRAINING at epoch 3 
               precision    recall  f1-score   support

           0       0.96      0.97      0.96      7104
           1       0.79      0.72      0.75      1061

    accuracy                           0.94      8165
   macro avg       0.87      0.85      0.86      8165
weighted avg       0.94      0.94      0.94      8165

2023-02-11 00:36:05,947 | DEBUG | 
2023-02-11 00:36:05,947 | INFO | Running Validation...
2023-02-11 00:36:12,249 | INFO | Epoch 3 : 
                Valid_acc : 0.9285362228598225
                Valid_precision (macro, micro): [0.83329546 0.92853622]
                Valid_recall (macro, micro): [0.8450015  0.92853622]
                Valid_F1 (macro, micro): [0.83886441 0.92853622]
2023-02-11 00:36:12,249 | INFO |   Accuracy: 0.92
2023-02-11 00:36:12,250 | INFO |   Validation Loss: 0.19
2023-02-11 00:36:12,250 | INFO |   Validation took: 0:00:06
2023-02-11 00:36:12,254 | INFO | Classification report. VALIDATION at epoch 3 
               precision    recall  f1-score   support

           0       0.96      0.95      0.96       790
           1       0.70      0.73      0.71       118

    accuracy                           0.92       908
   macro avg       0.83      0.84      0.83       908
weighted avg       0.93      0.92      0.92       908

2023-02-11 00:36:12,254 | DEBUG | 
2023-02-11 00:36:12,254 | INFO | Training complete!
2023-02-11 00:36:12,255 | INFO | Total training took 0:09:27 (h:mm:ss)
2023-02-11 00:36:12,288 | INFO | To execute testing of the model on test_data
2023-02-11 00:36:12,289 | INFO | There are 1 GPU(s) available.

These are the available devices:
2023-02-11 00:36:12,289 | INFO | 	 1 - NVIDIA A100-SXM4-40GB
2023-02-11 00:36:12,289 | DEBUG | Running Testing...
2023-02-11 00:36:15,598 | INFO | 
        Test_acc : 0.9455469412183586
        Test_precision (macro, micro): [0.90525858 0.94554694]
        Test_recall (macro, micro): [0.8585896  0.94554694]
        Test_F1 (macro, micro): [0.87826357 0.94554694]
2023-02-11 00:36:15,598 | INFO |   Accuracy: 0.94
2023-02-11 00:36:15,598 | INFO |   Test Loss: 0.18
2023-02-11 00:36:15,599 | INFO |   Test took: 0:00:03
2023-02-11 00:36:15,602 | INFO | Classification report. TEST 
               precision    recall  f1-score   support

           0       0.96      0.97      0.97       416
           1       0.79      0.73      0.76        62

    accuracy                           0.94       478
   macro avg       0.87      0.85      0.86       478
weighted avg       0.94      0.94      0.94       478

2023-02-11 00:36:15,603 | INFO | From binary classification we present the following statistics: [{'epoch': 1, 'Training Loss': 0.45135234342888, 'Training Accur.': 0.8648777035313523, 'Training Precision (macro)': 0.541940028626424, 'Training Precision (micro)': 0.8648777035313523, 'Training Recall (macro)': 0.5025631035138853, 'Training Recall (micro)': 0.8648777035313523, 'Training F1 (macro)': 0.47661708474815284, 'Training F1 (micro)': 0.8648777035313523, 'Valid. Loss': 0.2677013858638961, 'Valid. Accur.': 0.8861350574712644, 'Valid. Precision (macro)': 0.8255416655520305, 'Valid. Precision (micro)': 0.8896734443412743, 'Valid. Recall (macro)': 0.6056022522818851, 'Valid. Recall (micro)': 0.8896734443412743, 'Valid. F1 (macro)': 0.640953958026057, 'Valid. F1 (micro)': 0.8896734443412743, 'Training Time': '0:03:03', 'Validation Time': '0:00:06'}, {'epoch': 2, 'Training Loss': 0.32919543189927936, 'Training Accur.': 0.9145116939983567, 'Training Precision (macro)': 0.839598288886806, 'Training Precision (micro)': 0.9145116939983567, 'Training Recall (macro)': 0.6964786559930505, 'Training Recall (micro)': 0.9145116939983567, 'Training F1 (macro)': 0.7384148326347589, 'Training F1 (micro)': 0.9145116939983567, 'Valid. Loss': 0.197971956483249, 'Valid. Accur.': 0.9288793103448276, 'Valid. Precision (macro)': 0.8444147176218711, 'Valid. Precision (micro)': 0.9250911566080454, 'Valid. Recall (macro)': 0.834661091223869, 'Valid. Recall (micro)': 0.9250911566080454, 'Valid. F1 (macro)': 0.8379944640753464, 'Valid. F1 (micro)': 0.9250911566080454, 'Training Time': '0:03:02', 'Validation Time': '0:00:06'}, {'epoch': 3, 'Training Loss': 0.2924693590612151, 'Training Accur.': 0.9383808453614438, 'Training Precision (macro)': 0.8857617146464614, 'Training Precision (micro)': 0.9383808453614438, 'Training Recall (macro)': 0.8377686408888055, 'Training Recall (micro)': 0.9383808453614438, 'Training F1 (macro)': 0.8587442731520663, 'Training F1 (micro)': 0.9383808453614438, 'Valid. Loss': 0.1934182967605262, 'Valid. Accur.': 0.9238505747126438, 'Valid. Precision (macro)': 0.8332954587274792, 'Valid. Precision (micro)': 0.9285362228598225, 'Valid. Recall (macro)': 0.8450015008708841, 'Valid. Recall (micro)': 0.9285362228598225, 'Valid. F1 (macro)': 0.8388644097987332, 'Valid. F1 (micro)': 0.9285362228598225, 'Training Time': '0:03:02', 'Validation Time': '0:00:06'}]
